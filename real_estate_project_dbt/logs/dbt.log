[0m00:59:20.786161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF5B478770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF5B47B4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF5B47ACC0>]}


============================== 00:59:20.788961 | 813a3907-a531-4b69-b150-5fd0126ecd6b ==============================
[0m00:59:20.788961 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:59:20.788961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:59:20.813136 [info ] [MainThread]: dbt version: 1.10.1
[0m00:59:20.814110 [info ] [MainThread]: python version: 3.12.2
[0m00:59:20.814110 [info ] [MainThread]: python path: C:\Users\nikhi\AppData\Local\Programs\Python\Python312\python.exe
[0m00:59:20.815112 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m00:59:21.784775 [info ] [MainThread]: Using profiles dir at C:\Users\nikhi\.dbt
[0m00:59:21.785630 [info ] [MainThread]: Using profiles.yml file at C:\Users\nikhi\.dbt\profiles.yml
[0m00:59:21.785630 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\dbt_project.yml
[0m00:59:21.787638 [info ] [MainThread]: adapter type: snowflake
[0m00:59:21.788639 [info ] [MainThread]: adapter version: 1.9.4
[0m00:59:21.946120 [info ] [MainThread]: Configuration:
[0m00:59:21.946120 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:59:21.947083 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:59:21.947083 [info ] [MainThread]: Required dependencies:
[0m00:59:21.948118 [debug] [MainThread]: Executing "git --help"
[0m00:59:21.986855 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:59:21.986855 [debug] [MainThread]: STDERR: "b''"
[0m00:59:21.986855 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:59:21.986855 [info ] [MainThread]: Connection:
[0m00:59:21.986855 [info ] [MainThread]:   account: HVUGDJG-NM17550
[0m00:59:21.986855 [info ] [MainThread]:   user: RISHABH16RAWAT
[0m00:59:21.986855 [info ] [MainThread]:   database: REAL_ESTATE
[0m00:59:21.986855 [info ] [MainThread]:   warehouse: real_estate_wh
[0m00:59:21.986855 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m00:59:21.986855 [info ] [MainThread]:   schema: LISTINGS
[0m00:59:21.986855 [info ] [MainThread]:   authenticator: None
[0m00:59:21.986855 [info ] [MainThread]:   oauth_client_id: None
[0m00:59:21.986855 [info ] [MainThread]:   query_tag: None
[0m00:59:21.986855 [info ] [MainThread]:   client_session_keep_alive: False
[0m00:59:21.986855 [info ] [MainThread]:   host: None
[0m00:59:21.986855 [info ] [MainThread]:   port: None
[0m00:59:21.986855 [info ] [MainThread]:   proxy_host: None
[0m00:59:21.986855 [info ] [MainThread]:   proxy_port: None
[0m00:59:21.986855 [info ] [MainThread]:   protocol: None
[0m00:59:21.986855 [info ] [MainThread]:   connect_retries: 1
[0m00:59:21.986855 [info ] [MainThread]:   connect_timeout: None
[0m00:59:21.986855 [info ] [MainThread]:   retry_on_database_errors: False
[0m00:59:21.986855 [info ] [MainThread]:   retry_all: False
[0m00:59:21.986855 [info ] [MainThread]:   insecure_mode: False
[0m00:59:21.986855 [info ] [MainThread]:   reuse_connections: True
[0m00:59:21.986855 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:59:22.643151 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m00:59:25.129293 [debug] [MainThread]: Using snowflake connection "debug"
[0m00:59:25.129293 [debug] [MainThread]: On debug: select 1 as id
[0m00:59:25.129293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:59:26.939516 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.810 seconds
[0m00:59:26.941490 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:59:26.942452 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:59:26.943491 [debug] [MainThread]: Command `dbt debug` succeeded at 00:59:26.943491 after 6.31 seconds
[0m00:59:26.943491 [debug] [MainThread]: Connection 'debug' was left open.
[0m00:59:26.944489 [debug] [MainThread]: On debug: Close
[0m00:59:27.122200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF5B44E600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF6AD2ECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF6D5A5190>]}
[0m00:59:27.124200 [debug] [MainThread]: Flushing usage events
[0m00:59:28.323625 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:08:28.442302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF9F386A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFA2674EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFA2677D70>]}


============================== 01:08:28.442302 | e42b0095-0dcb-4fb8-92a5-c048e1d102c6 ==============================
[0m01:08:28.442302 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:08:28.442302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:08:29.587908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e42b0095-0dcb-4fb8-92a5-c048e1d102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFB31E9BB0>]}
[0m01:08:29.687123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e42b0095-0dcb-4fb8-92a5-c048e1d102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFB3F43590>]}
[0m01:08:29.688124 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:08:30.144540 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:08:30.145541 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:08:30.146544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e42b0095-0dcb-4fb8-92a5-c048e1d102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFB5367770>]}
[0m01:08:32.803524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e42b0095-0dcb-4fb8-92a5-c048e1d102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFB57B4FB0>]}
[0m01:08:32.893552 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m01:08:32.896521 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m01:08:32.930138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e42b0095-0dcb-4fb8-92a5-c048e1d102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFB58F9550>]}
[0m01:08:32.930138 [info ] [MainThread]: Found 3 models, 4 data tests, 476 macros
[0m01:08:32.930138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e42b0095-0dcb-4fb8-92a5-c048e1d102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFB57971A0>]}
[0m01:08:32.934344 [info ] [MainThread]: 
[0m01:08:32.934344 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:08:32.934344 [info ] [MainThread]: 
[0m01:08:32.934344 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:08:32.939890 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m01:08:33.015056 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m01:08:33.015056 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m01:08:33.015056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:34.214882 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.194 seconds
[0m01:08:34.221324 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m01:08:34.221324 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m01:08:34.333068 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.110 seconds
[0m01:08:34.334072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE, now create_REAL_ESTATE_LISTINGS_LISTINGS)
[0m01:08:34.335072 [debug] [ThreadPool]: Creating schema "database: "REAL_ESTATE"
schema: "LISTINGS_LISTINGS"
"
[0m01:08:34.340072 [debug] [ThreadPool]: Using snowflake connection "create_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:08:34.340072 [debug] [ThreadPool]: On create_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "create_REAL_ESTATE_LISTINGS_LISTINGS"} */
create schema if not exists REAL_ESTATE.LISTINGS_LISTINGS
[0m01:08:34.464974 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.138 seconds
[0m01:08:34.481510 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m01:08:34.496514 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:08:34.496514 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:08:34.496514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:35.448999 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.954 seconds
[0m01:08:35.453576 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:08:35.453576 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m01:08:35.572692 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.114 seconds
[0m01:08:35.579136 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:08:35.581139 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:08:35.702411 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m01:08:35.706375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTINGS)
[0m01:08:35.708374 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:08:35.708374 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:08:35.808557 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m01:08:35.824336 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:08:35.824336 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m01:08:35.956308 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.131 seconds
[0m01:08:35.961264 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:08:35.961264 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:08:36.073384 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.111 seconds
[0m01:08:36.074340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e42b0095-0dcb-4fb8-92a5-c048e1d102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFB52B1A00>]}
[0m01:08:36.074340 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m01:08:36.074340 [info ] [Thread-1 (]: 1 of 3 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m01:08:36.074340 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m01:08:36.074340 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m01:08:36.101106 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m01:08:36.103069 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m01:08:36.136234 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m01:08:36.139198 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m01:08:36.140231 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS(
    SELECT
    CITY_CLEAN_NAME AS CITY_NAME,
    AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CITY_NAME

)

SELECT * FROM avg_price;
[0m01:08:36.140231 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:08:37.183692 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd1e3a-3201-b504-0000-000e0472c461
[0m01:08:37.183692 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 23 unexpected ';'.
[0m01:08:37.199969 [debug] [Thread-1 (]: Database Error in model city_avaerage_price (models\example\city_avaerage_price.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 23 unexpected ';'.
  compiled code at target\run\real_estate_project_dbt\models\example\city_avaerage_price.sql
[0m01:08:37.202471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e42b0095-0dcb-4fb8-92a5-c048e1d102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFB58FA750>]}
[0m01:08:37.204477 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model LISTINGS_LISTINGS.city_avaerage_price ..... [[31mERROR[0m in 1.13s]
[0m01:08:37.205477 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m01:08:37.206483 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_first_dbt_model
[0m01:08:37.206483 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.city_avaerage_price' to be skipped because of status 'error'.  Reason: Database Error in model city_avaerage_price (models\example\city_avaerage_price.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 23 unexpected ';'.
  compiled code at target\run\real_estate_project_dbt\models\example\city_avaerage_price.sql.
[0m01:08:37.207480 [info ] [Thread-1 (]: 2 of 3 START sql table model LISTINGS.my_first_dbt_model ....................... [RUN]
[0m01:08:37.209480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.my_first_dbt_model)
[0m01:08:37.209480 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_first_dbt_model
[0m01:08:37.212477 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:08:37.214477 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_first_dbt_model
[0m01:08:37.238815 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:08:37.238815 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:08:37.238815 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_first_dbt_model"} */
create or replace transient table REAL_ESTATE.LISTINGS.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m01:08:38.367370 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.119 seconds
[0m01:08:38.386552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e42b0095-0dcb-4fb8-92a5-c048e1d102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFA018A150>]}
[0m01:08:38.386552 [info ] [Thread-1 (]: 2 of 3 OK created sql table model LISTINGS.my_first_dbt_model .................. [[32mSUCCESS 1[0m in 1.18s]
[0m01:08:38.386552 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_first_dbt_model
[0m01:08:38.386552 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_second_dbt_model
[0m01:08:38.386552 [info ] [Thread-1 (]: 3 of 3 START sql view model LISTINGS.my_second_dbt_model ....................... [RUN]
[0m01:08:38.386552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.my_first_dbt_model, now model.real_estate_project_dbt.my_second_dbt_model)
[0m01:08:38.386552 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_second_dbt_model
[0m01:08:38.386552 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:08:38.386552 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_second_dbt_model
[0m01:08:38.386552 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:08:38.404666 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:08:38.405732 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_second_dbt_model"} */
create or replace   view REAL_ESTATE.LISTINGS.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from REAL_ESTATE.LISTINGS.my_first_dbt_model
where id = 1
  );
[0m01:08:38.606015 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.201 seconds
[0m01:08:38.606015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e42b0095-0dcb-4fb8-92a5-c048e1d102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFB5ECC2C0>]}
[0m01:08:38.606015 [info ] [Thread-1 (]: 3 of 3 OK created sql view model LISTINGS.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.22s]
[0m01:08:38.606015 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_second_dbt_model
[0m01:08:38.622067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:08:38.626667 [debug] [MainThread]: Connection 'create_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m01:08:38.628689 [debug] [MainThread]: On create_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m01:08:38.810752 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS' was left open.
[0m01:08:38.810752 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS: Close
[0m01:08:38.980670 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.my_second_dbt_model' was left open.
[0m01:08:38.980670 [debug] [MainThread]: On model.real_estate_project_dbt.my_second_dbt_model: Close
[0m01:08:39.172593 [info ] [MainThread]: 
[0m01:08:39.174605 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 6.24 seconds (6.24s).
[0m01:08:39.175610 [debug] [MainThread]: Command end result
[0m01:08:39.198589 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m01:08:39.201756 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m01:08:39.206764 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m01:08:39.206764 [info ] [MainThread]: 
[0m01:08:39.206764 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:08:39.206764 [info ] [MainThread]: 
[0m01:08:39.206764 [error] [MainThread]: [31mFailure in model city_avaerage_price (models\example\city_avaerage_price.sql)[0m
[0m01:08:39.206764 [error] [MainThread]:   Database Error in model city_avaerage_price (models\example\city_avaerage_price.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 23 unexpected ';'.
  compiled code at target\run\real_estate_project_dbt\models\example\city_avaerage_price.sql
[0m01:08:39.206764 [info ] [MainThread]: 
[0m01:08:39.206764 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\city_avaerage_price.sql
[0m01:08:39.206764 [info ] [MainThread]: 
[0m01:08:39.206764 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m01:08:39.206764 [debug] [MainThread]: Command `dbt run` failed at 01:08:39.206764 after 10.93 seconds
[0m01:08:39.215580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFA2E035C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFB577F380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFA31D52E0>]}
[0m01:08:39.216588 [debug] [MainThread]: Flushing usage events
[0m01:08:40.430916 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:10:35.659901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013219495880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013219495670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013219495760>]}


============================== 01:10:35.662570 | 52b21732-e7a0-4e3a-90f0-8cceda23addc ==============================
[0m01:10:35.662570 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:10:35.665154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:10:36.799224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52b21732-e7a0-4e3a-90f0-8cceda23addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322B496B70>]}
[0m01:10:36.911925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52b21732-e7a0-4e3a-90f0-8cceda23addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001321824A5D0>]}
[0m01:10:36.911925 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:10:37.300492 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:10:37.467753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:10:37.467753 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\city_avaerage_price.sql
[0m01:10:37.801400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52b21732-e7a0-4e3a-90f0-8cceda23addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322BC491F0>]}
[0m01:10:37.928527 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m01:10:37.928527 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m01:10:37.960036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52b21732-e7a0-4e3a-90f0-8cceda23addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322B9782C0>]}
[0m01:10:37.960036 [info ] [MainThread]: Found 3 models, 4 data tests, 476 macros
[0m01:10:37.960036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52b21732-e7a0-4e3a-90f0-8cceda23addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322BA98DA0>]}
[0m01:10:37.960036 [info ] [MainThread]: 
[0m01:10:37.960036 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:10:37.975767 [info ] [MainThread]: 
[0m01:10:37.975767 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:10:37.975767 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m01:10:38.064805 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m01:10:38.064805 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m01:10:38.064805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:10:39.354075 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.292 seconds
[0m01:10:39.369857 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m01:10:39.369857 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m01:10:39.498854 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.127 seconds
[0m01:10:39.516016 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS'
[0m01:10:39.533984 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:10:39.533984 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:10:39.534987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:10:40.441904 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.916 seconds
[0m01:10:40.441904 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:10:40.441904 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m01:10:40.596340 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.146 seconds
[0m01:10:40.606697 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:10:40.606697 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:10:40.739495 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.131 seconds
[0m01:10:40.742450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS, now list_REAL_ESTATE_LISTINGS_LISTINGS)
[0m01:10:40.745451 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:10:40.746452 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:10:40.863231 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.124 seconds
[0m01:10:40.863231 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:10:40.878998 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m01:10:41.008894 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.130 seconds
[0m01:10:41.008894 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:10:41.008894 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:10:41.154315 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.137 seconds
[0m01:10:41.154315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52b21732-e7a0-4e3a-90f0-8cceda23addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322C022420>]}
[0m01:10:41.154315 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m01:10:41.154315 [info ] [Thread-1 (]: 1 of 3 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m01:10:41.154315 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m01:10:41.154315 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m01:10:41.174045 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m01:10:41.174045 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m01:10:41.199684 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m01:10:41.199684 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m01:10:41.199684 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT * FROM avg_price;
[0m01:10:41.199684 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:10:42.127663 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd1e3c-3201-b497-0000-000e0472bc49
[0m01:10:42.127663 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 23 unexpected ';'.
[0m01:10:42.131662 [debug] [Thread-1 (]: Database Error in model city_avaerage_price (models\example\city_avaerage_price.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 23 unexpected ';'.
  compiled code at target\run\real_estate_project_dbt\models\example\city_avaerage_price.sql
[0m01:10:42.134367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b21732-e7a0-4e3a-90f0-8cceda23addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322BE87410>]}
[0m01:10:42.134367 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model LISTINGS_LISTINGS.city_avaerage_price ..... [[31mERROR[0m in 0.98s]
[0m01:10:42.135368 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m01:10:42.136403 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_first_dbt_model
[0m01:10:42.137403 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.city_avaerage_price' to be skipped because of status 'error'.  Reason: Database Error in model city_avaerage_price (models\example\city_avaerage_price.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 23 unexpected ';'.
  compiled code at target\run\real_estate_project_dbt\models\example\city_avaerage_price.sql.
[0m01:10:42.137403 [info ] [Thread-1 (]: 2 of 3 START sql table model LISTINGS.my_first_dbt_model ....................... [RUN]
[0m01:10:42.138367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.my_first_dbt_model)
[0m01:10:42.139403 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_first_dbt_model
[0m01:10:42.142405 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:10:42.143403 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_first_dbt_model
[0m01:10:42.175852 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:10:42.176852 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:10:42.177853 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_first_dbt_model"} */
create or replace transient table REAL_ESTATE.LISTINGS.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m01:10:43.083837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.909 seconds
[0m01:10:43.108872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b21732-e7a0-4e3a-90f0-8cceda23addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001321644A000>]}
[0m01:10:43.108872 [info ] [Thread-1 (]: 2 of 3 OK created sql table model LISTINGS.my_first_dbt_model .................. [[32mSUCCESS 1[0m in 0.97s]
[0m01:10:43.108872 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_first_dbt_model
[0m01:10:43.108872 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_second_dbt_model
[0m01:10:43.108872 [info ] [Thread-1 (]: 3 of 3 START sql view model LISTINGS.my_second_dbt_model ....................... [RUN]
[0m01:10:43.108872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.my_first_dbt_model, now model.real_estate_project_dbt.my_second_dbt_model)
[0m01:10:43.108872 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_second_dbt_model
[0m01:10:43.108872 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:10:43.108872 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_second_dbt_model
[0m01:10:43.108872 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:10:43.108872 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:10:43.124597 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_second_dbt_model"} */
create or replace   view REAL_ESTATE.LISTINGS.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from REAL_ESTATE.LISTINGS.my_first_dbt_model
where id = 1
  );
[0m01:10:43.365245 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.246 seconds
[0m01:10:43.381001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b21732-e7a0-4e3a-90f0-8cceda23addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322C164140>]}
[0m01:10:43.384442 [info ] [Thread-1 (]: 3 of 3 OK created sql view model LISTINGS.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.27s]
[0m01:10:43.384752 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_second_dbt_model
[0m01:10:43.387450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:10:43.387450 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m01:10:43.387450 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m01:10:43.567273 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m01:10:43.569542 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m01:10:43.777894 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.my_second_dbt_model' was left open.
[0m01:10:43.777894 [debug] [MainThread]: On model.real_estate_project_dbt.my_second_dbt_model: Close
[0m01:10:43.966226 [info ] [MainThread]: 
[0m01:10:43.967267 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 5.99 seconds (5.99s).
[0m01:10:43.968398 [debug] [MainThread]: Command end result
[0m01:10:43.987889 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m01:10:43.987889 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m01:10:44.002695 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m01:10:44.003713 [info ] [MainThread]: 
[0m01:10:44.004713 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:10:44.005682 [info ] [MainThread]: 
[0m01:10:44.005682 [error] [MainThread]: [31mFailure in model city_avaerage_price (models\example\city_avaerage_price.sql)[0m
[0m01:10:44.007115 [error] [MainThread]:   Database Error in model city_avaerage_price (models\example\city_avaerage_price.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 23 unexpected ';'.
  compiled code at target\run\real_estate_project_dbt\models\example\city_avaerage_price.sql
[0m01:10:44.007115 [info ] [MainThread]: 
[0m01:10:44.007115 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\city_avaerage_price.sql
[0m01:10:44.010599 [info ] [MainThread]: 
[0m01:10:44.011608 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m01:10:44.012810 [debug] [MainThread]: Command `dbt run` failed at 01:10:44.012810 after 8.55 seconds
[0m01:10:44.012810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013228B6F440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001322BC48DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013217D1F0E0>]}
[0m01:10:44.013807 [debug] [MainThread]: Flushing usage events
[0m01:10:45.157841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:11:21.184941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133EDB312E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133EDB30290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133EDB310D0>]}


============================== 01:11:21.186628 | ba9cca8a-1644-4978-b803-3dd356ab8495 ==============================
[0m01:11:21.186628 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:11:21.186628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:11:22.349494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba9cca8a-1644-4978-b803-3dd356ab8495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133FF1C6B70>]}
[0m01:11:22.443908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba9cca8a-1644-4978-b803-3dd356ab8495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133FF056930>]}
[0m01:11:22.443908 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:11:22.850718 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:11:23.040719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:11:23.040719 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\city_avaerage_price.sql
[0m01:11:23.351825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba9cca8a-1644-4978-b803-3dd356ab8495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133FF057E60>]}
[0m01:11:23.494772 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m01:11:23.494772 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m01:11:23.528061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba9cca8a-1644-4978-b803-3dd356ab8495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133FF761550>]}
[0m01:11:23.528061 [info ] [MainThread]: Found 3 models, 4 data tests, 476 macros
[0m01:11:23.528061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba9cca8a-1644-4978-b803-3dd356ab8495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133FEE8DEB0>]}
[0m01:11:23.528061 [info ] [MainThread]: 
[0m01:11:23.528061 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:11:23.528061 [info ] [MainThread]: 
[0m01:11:23.528061 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:11:23.542105 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m01:11:23.619880 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m01:11:23.620881 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m01:11:23.620881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:24.753035 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.146 seconds
[0m01:11:24.768703 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m01:11:24.768703 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m01:11:24.872741 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.110 seconds
[0m01:11:24.888421 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m01:11:24.904104 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:11:24.904104 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:11:24.904104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:25.802868 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.899 seconds
[0m01:11:25.802868 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:11:25.802868 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m01:11:25.925836 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.122 seconds
[0m01:11:25.941895 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:11:25.941895 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:11:26.055681 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.114 seconds
[0m01:11:26.055681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTINGS)
[0m01:11:26.055681 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:11:26.055681 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:11:26.169017 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m01:11:26.169017 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:11:26.169017 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m01:11:26.307539 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.128 seconds
[0m01:11:26.314475 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:11:26.314475 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:11:26.425902 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.114 seconds
[0m01:11:26.425902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba9cca8a-1644-4978-b803-3dd356ab8495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133FF8E5850>]}
[0m01:11:26.425902 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m01:11:26.425902 [info ] [Thread-1 (]: 1 of 3 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m01:11:26.425902 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m01:11:26.425902 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m01:11:26.445732 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m01:11:26.445732 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m01:11:26.467703 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m01:11:26.477613 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m01:11:26.477613 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT * FROM avg_price
  );
[0m01:11:26.477613 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:11:27.492012 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.025 seconds
[0m01:11:27.523723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba9cca8a-1644-4978-b803-3dd356ab8495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133EB1AA360>]}
[0m01:11:27.523723 [info ] [Thread-1 (]: 1 of 3 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.10s]
[0m01:11:27.523723 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m01:11:27.523723 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_first_dbt_model
[0m01:11:27.523723 [info ] [Thread-1 (]: 2 of 3 START sql table model LISTINGS.my_first_dbt_model ....................... [RUN]
[0m01:11:27.523723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.my_first_dbt_model)
[0m01:11:27.523723 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_first_dbt_model
[0m01:11:27.532660 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:11:27.534666 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_first_dbt_model
[0m01:11:27.561185 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:11:27.561185 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:11:27.561185 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_first_dbt_model"} */
create or replace transient table REAL_ESTATE.LISTINGS.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m01:11:28.104796 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.537 seconds
[0m01:11:28.110816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba9cca8a-1644-4978-b803-3dd356ab8495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133FF769A00>]}
[0m01:11:28.110816 [info ] [Thread-1 (]: 2 of 3 OK created sql table model LISTINGS.my_first_dbt_model .................. [[32mSUCCESS 1[0m in 0.59s]
[0m01:11:28.110816 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_first_dbt_model
[0m01:11:28.113627 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_second_dbt_model
[0m01:11:28.115633 [info ] [Thread-1 (]: 3 of 3 START sql view model LISTINGS.my_second_dbt_model ....................... [RUN]
[0m01:11:28.115633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.my_first_dbt_model, now model.real_estate_project_dbt.my_second_dbt_model)
[0m01:11:28.115633 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_second_dbt_model
[0m01:11:28.119644 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:11:28.121651 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_second_dbt_model
[0m01:11:28.127781 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:11:28.129965 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:11:28.131330 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_second_dbt_model"} */
create or replace   view REAL_ESTATE.LISTINGS.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from REAL_ESTATE.LISTINGS.my_first_dbt_model
where id = 1
  );
[0m01:11:28.354931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.229 seconds
[0m01:11:28.354931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba9cca8a-1644-4978-b803-3dd356ab8495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133FFCC9F10>]}
[0m01:11:28.354931 [info ] [Thread-1 (]: 3 of 3 OK created sql view model LISTINGS.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.24s]
[0m01:11:28.354931 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_second_dbt_model
[0m01:11:28.354931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:11:28.354931 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m01:11:28.354931 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m01:11:28.534753 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS' was left open.
[0m01:11:28.535738 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS: Close
[0m01:11:28.704340 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.my_second_dbt_model' was left open.
[0m01:11:28.704340 [debug] [MainThread]: On model.real_estate_project_dbt.my_second_dbt_model: Close
[0m01:11:28.903903 [info ] [MainThread]: 
[0m01:11:28.903903 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 5.38 seconds (5.38s).
[0m01:11:28.903903 [debug] [MainThread]: Command end result
[0m01:11:28.932459 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m01:11:28.932459 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m01:11:28.932459 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m01:11:28.932459 [info ] [MainThread]: 
[0m01:11:28.932459 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:11:28.932459 [info ] [MainThread]: 
[0m01:11:28.944669 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:11:28.946110 [debug] [MainThread]: Command `dbt run` succeeded at 01:11:28.946110 after 7.92 seconds
[0m01:11:28.946110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133E7902D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133EE195160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133EE194E00>]}
[0m01:11:28.946110 [debug] [MainThread]: Flushing usage events
[0m01:11:30.017673 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:31:09.441421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA30214440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA3073EC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA3073CDA0>]}


============================== 01:31:09.459254 | c3fc6fb8-5230-4c9d-94a3-cae959738706 ==============================
[0m01:31:09.459254 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:31:09.461318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:31:10.579127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3fc6fb8-5230-4c9d-94a3-cae959738706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA40B44B60>]}
[0m01:31:10.666650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3fc6fb8-5230-4c9d-94a3-cae959738706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4013DD60>]}
[0m01:31:10.668086 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:31:11.058441 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:31:11.231657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:31:11.231657 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\city_avaerage_price.sql
[0m01:31:11.559335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3fc6fb8-5230-4c9d-94a3-cae959738706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4304B200>]}
[0m01:31:11.685741 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m01:31:11.685741 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m01:31:11.717169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3fc6fb8-5230-4c9d-94a3-cae959738706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA42FE0830>]}
[0m01:31:11.717169 [info ] [MainThread]: Found 3 models, 4 data tests, 476 macros
[0m01:31:11.717169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3fc6fb8-5230-4c9d-94a3-cae959738706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA43025B80>]}
[0m01:31:11.717169 [info ] [MainThread]: 
[0m01:31:11.717169 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:31:11.717169 [info ] [MainThread]: 
[0m01:31:11.717169 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:31:11.717169 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m01:31:11.807864 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m01:31:11.807864 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m01:31:11.807864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:13.103278 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.301 seconds
[0m01:31:13.128819 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m01:31:13.130773 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m01:31:13.295343 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.164 seconds
[0m01:31:13.295343 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m01:31:13.305822 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:31:13.305822 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:31:13.305822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:14.529482 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.219 seconds
[0m01:31:14.543354 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:31:14.545382 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m01:31:14.736240 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.193 seconds
[0m01:31:14.736240 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:31:14.736240 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:31:14.878624 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.145 seconds
[0m01:31:14.878624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTINGS)
[0m01:31:14.894712 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:31:14.894712 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:31:15.028801 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.133 seconds
[0m01:31:15.031794 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:31:15.032782 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m01:31:15.174859 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.151 seconds
[0m01:31:15.186446 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:31:15.186446 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:31:15.315754 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.135 seconds
[0m01:31:15.331777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3fc6fb8-5230-4c9d-94a3-cae959738706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA434A4560>]}
[0m01:31:15.331777 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m01:31:15.331777 [info ] [Thread-1 (]: 1 of 3 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m01:31:15.331777 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m01:31:15.331777 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m01:31:15.347718 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m01:31:15.348594 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m01:31:15.379988 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m01:31:15.380991 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m01:31:15.381953 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m01:31:15.381953 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:31:16.367439 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd1e51-3201-b504-0000-000e0472c521
[0m01:31:16.367439 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 8 unexpected 'AVG'.
syntax error line 10 at position 12 unexpected 'PRICE'.
syntax error line 10 at position 19 unexpected 'AS'.
[0m01:31:16.367439 [debug] [Thread-1 (]: Database Error in model city_avaerage_price (models\example\city_avaerage_price.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 8 unexpected 'AVG'.
  syntax error line 10 at position 12 unexpected 'PRICE'.
  syntax error line 10 at position 19 unexpected 'AS'.
  compiled code at target\run\real_estate_project_dbt\models\example\city_avaerage_price.sql
[0m01:31:16.367439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3fc6fb8-5230-4c9d-94a3-cae959738706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA2FCBBB00>]}
[0m01:31:16.367439 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model LISTINGS_LISTINGS.city_avaerage_price ..... [[31mERROR[0m in 1.04s]
[0m01:31:16.367439 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m01:31:16.367439 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_first_dbt_model
[0m01:31:16.367439 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.city_avaerage_price' to be skipped because of status 'error'.  Reason: Database Error in model city_avaerage_price (models\example\city_avaerage_price.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 8 unexpected 'AVG'.
  syntax error line 10 at position 12 unexpected 'PRICE'.
  syntax error line 10 at position 19 unexpected 'AS'.
  compiled code at target\run\real_estate_project_dbt\models\example\city_avaerage_price.sql.
[0m01:31:16.367439 [info ] [Thread-1 (]: 2 of 3 START sql table model LISTINGS.my_first_dbt_model ....................... [RUN]
[0m01:31:16.367439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.my_first_dbt_model)
[0m01:31:16.367439 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_first_dbt_model
[0m01:31:16.385092 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:31:16.386463 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_first_dbt_model
[0m01:31:16.412525 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:31:16.412525 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:31:16.412525 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_first_dbt_model"} */
create or replace transient table REAL_ESTATE.LISTINGS.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m01:31:17.273105 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.856 seconds
[0m01:31:17.284786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3fc6fb8-5230-4c9d-94a3-cae959738706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA2D9FA480>]}
[0m01:31:17.284786 [info ] [Thread-1 (]: 2 of 3 OK created sql table model LISTINGS.my_first_dbt_model .................. [[32mSUCCESS 1[0m in 0.92s]
[0m01:31:17.300492 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_first_dbt_model
[0m01:31:17.300492 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_second_dbt_model
[0m01:31:17.300492 [info ] [Thread-1 (]: 3 of 3 START sql view model LISTINGS.my_second_dbt_model ....................... [RUN]
[0m01:31:17.300492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.my_first_dbt_model, now model.real_estate_project_dbt.my_second_dbt_model)
[0m01:31:17.300492 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_second_dbt_model
[0m01:31:17.300492 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:31:17.300492 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_second_dbt_model
[0m01:31:17.300492 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:31:17.300492 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:31:17.300492 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_second_dbt_model"} */
create or replace   view REAL_ESTATE.LISTINGS.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from REAL_ESTATE.LISTINGS.my_first_dbt_model
where id = 1
  );
[0m01:31:17.551448 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.250 seconds
[0m01:31:17.551448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3fc6fb8-5230-4c9d-94a3-cae959738706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA435F7860>]}
[0m01:31:17.551448 [info ] [Thread-1 (]: 3 of 3 OK created sql view model LISTINGS.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.25s]
[0m01:31:17.567195 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_second_dbt_model
[0m01:31:17.567195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:17.570151 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m01:31:17.570151 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m01:31:17.776306 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS' was left open.
[0m01:31:17.778053 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS: Close
[0m01:31:17.979495 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.my_second_dbt_model' was left open.
[0m01:31:17.979495 [debug] [MainThread]: On model.real_estate_project_dbt.my_second_dbt_model: Close
[0m01:31:18.162477 [info ] [MainThread]: 
[0m01:31:18.162477 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 6.45 seconds (6.45s).
[0m01:31:18.162477 [debug] [MainThread]: Command end result
[0m01:31:18.176790 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m01:31:18.192541 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m01:31:18.197975 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m01:31:18.197975 [info ] [MainThread]: 
[0m01:31:18.197975 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:31:18.203184 [info ] [MainThread]: 
[0m01:31:18.203184 [error] [MainThread]: [31mFailure in model city_avaerage_price (models\example\city_avaerage_price.sql)[0m
[0m01:31:18.203184 [error] [MainThread]:   Database Error in model city_avaerage_price (models\example\city_avaerage_price.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 8 unexpected 'AVG'.
  syntax error line 10 at position 12 unexpected 'PRICE'.
  syntax error line 10 at position 19 unexpected 'AS'.
  compiled code at target\run\real_estate_project_dbt\models\example\city_avaerage_price.sql
[0m01:31:18.203184 [info ] [MainThread]: 
[0m01:31:18.203184 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\city_avaerage_price.sql
[0m01:31:18.203184 [info ] [MainThread]: 
[0m01:31:18.203184 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m01:31:18.209017 [debug] [MainThread]: Command `dbt run` failed at 01:31:18.209017 after 8.95 seconds
[0m01:31:18.209905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA418649B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA41A3D610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA43024860>]}
[0m01:31:18.209905 [debug] [MainThread]: Flushing usage events
[0m01:31:19.401961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:31:35.202457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219E4CA92B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219E4776A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219E49B0F20>]}


============================== 01:31:35.204399 | 82de931a-63ed-40f3-bed7-1e9ef192b7a0 ==============================
[0m01:31:35.204399 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:31:35.204399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:31:36.345314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82de931a-63ed-40f3-bed7-1e9ef192b7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F6306E40>]}
[0m01:31:36.439974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82de931a-63ed-40f3-bed7-1e9ef192b7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F5295820>]}
[0m01:31:36.439974 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:31:36.848368 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:31:37.022207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:31:37.022207 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\city_avaerage_price.sql
[0m01:31:37.351919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82de931a-63ed-40f3-bed7-1e9ef192b7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F78DB200>]}
[0m01:31:37.478125 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m01:31:37.480130 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m01:31:37.509482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82de931a-63ed-40f3-bed7-1e9ef192b7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F786C6B0>]}
[0m01:31:37.509482 [info ] [MainThread]: Found 3 models, 4 data tests, 476 macros
[0m01:31:37.509482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82de931a-63ed-40f3-bed7-1e9ef192b7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F78B2BA0>]}
[0m01:31:37.513488 [info ] [MainThread]: 
[0m01:31:37.513488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:31:37.513488 [info ] [MainThread]: 
[0m01:31:37.513488 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:31:37.519012 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m01:31:37.598179 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m01:31:37.598179 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m01:31:37.598179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:38.889446 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.292 seconds
[0m01:31:38.906385 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m01:31:38.908595 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m01:31:39.115788 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.210 seconds
[0m01:31:39.120614 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m01:31:39.127672 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:31:39.127672 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:31:39.127672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:40.132237 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.004 seconds
[0m01:31:40.132237 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:31:40.132237 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m01:31:40.283610 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.147 seconds
[0m01:31:40.298573 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:31:40.299625 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:31:40.465400 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.174 seconds
[0m01:31:40.465400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTINGS)
[0m01:31:40.481291 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:31:40.481291 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:31:40.614120 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.130 seconds
[0m01:31:40.614120 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:31:40.614120 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m01:31:40.830026 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.207 seconds
[0m01:31:40.830026 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:31:40.830026 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:31:40.964975 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.132 seconds
[0m01:31:40.976075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82de931a-63ed-40f3-bed7-1e9ef192b7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219E23706B0>]}
[0m01:31:40.976075 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m01:31:40.976075 [info ] [Thread-1 (]: 1 of 3 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m01:31:40.976075 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m01:31:40.976075 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m01:31:40.992742 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m01:31:40.993492 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m01:31:41.015516 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m01:31:41.015516 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m01:31:41.015516 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m01:31:41.015516 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:31:42.099217 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.083 seconds
[0m01:31:42.132513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82de931a-63ed-40f3-bed7-1e9ef192b7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219E228A450>]}
[0m01:31:42.132513 [info ] [Thread-1 (]: 1 of 3 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.16s]
[0m01:31:42.132513 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m01:31:42.132513 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_first_dbt_model
[0m01:31:42.132513 [info ] [Thread-1 (]: 2 of 3 START sql table model LISTINGS.my_first_dbt_model ....................... [RUN]
[0m01:31:42.132513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.my_first_dbt_model)
[0m01:31:42.132513 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_first_dbt_model
[0m01:31:42.132513 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:31:42.132513 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_first_dbt_model
[0m01:31:42.168424 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:31:42.170844 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:31:42.171957 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_first_dbt_model"} */
create or replace transient table REAL_ESTATE.LISTINGS.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m01:31:43.232728 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.071 seconds
[0m01:31:43.232728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82de931a-63ed-40f3-bed7-1e9ef192b7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F7E87770>]}
[0m01:31:43.232728 [info ] [Thread-1 (]: 2 of 3 OK created sql table model LISTINGS.my_first_dbt_model .................. [[32mSUCCESS 1[0m in 1.10s]
[0m01:31:43.232728 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_first_dbt_model
[0m01:31:43.248959 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_second_dbt_model
[0m01:31:43.249396 [info ] [Thread-1 (]: 3 of 3 START sql view model LISTINGS.my_second_dbt_model ....................... [RUN]
[0m01:31:43.249396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.my_first_dbt_model, now model.real_estate_project_dbt.my_second_dbt_model)
[0m01:31:43.249396 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_second_dbt_model
[0m01:31:43.249396 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:31:43.249396 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_second_dbt_model
[0m01:31:43.249396 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:31:43.249396 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:31:43.249396 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_second_dbt_model"} */
create or replace   view REAL_ESTATE.LISTINGS.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from REAL_ESTATE.LISTINGS.my_first_dbt_model
where id = 1
  );
[0m01:31:43.544881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m01:31:43.559973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82de931a-63ed-40f3-bed7-1e9ef192b7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F7EA4C50>]}
[0m01:31:43.559973 [info ] [Thread-1 (]: 3 of 3 OK created sql view model LISTINGS.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.31s]
[0m01:31:43.559973 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_second_dbt_model
[0m01:31:43.559973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:43.559973 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m01:31:43.559973 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m01:31:43.747108 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS' was left open.
[0m01:31:43.747108 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS: Close
[0m01:31:43.955100 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.my_second_dbt_model' was left open.
[0m01:31:43.955100 [debug] [MainThread]: On model.real_estate_project_dbt.my_second_dbt_model: Close
[0m01:31:44.133657 [info ] [MainThread]: 
[0m01:31:44.133657 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 6.62 seconds (6.62s).
[0m01:31:44.133657 [debug] [MainThread]: Command end result
[0m01:31:44.154773 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m01:31:44.166936 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m01:31:44.174975 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m01:31:44.174975 [info ] [MainThread]: 
[0m01:31:44.175975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:31:44.176964 [info ] [MainThread]: 
[0m01:31:44.176964 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:31:44.176964 [debug] [MainThread]: Command `dbt run` succeeded at 01:31:44.176964 after 9.13 seconds
[0m01:31:44.176964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219E4BAC440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F4993260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219E4578860>]}
[0m01:31:44.176964 [debug] [MainThread]: Flushing usage events
[0m01:31:45.370116 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:51:42.872826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E2D51280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E2D51820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E2D50E90>]}


============================== 01:51:42.876863 | c15542d4-5e7e-45ed-8c03-9b7fcc38e8d3 ==============================
[0m01:51:42.876863 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:51:42.876863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:51:44.080692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c15542d4-5e7e-45ed-8c03-9b7fcc38e8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222F3CA16D0>]}
[0m01:51:44.168101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c15542d4-5e7e-45ed-8c03-9b7fcc38e8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E238AC90>]}
[0m01:51:44.168101 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:51:44.583300 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:51:44.746154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:51:44.746154 [debug] [MainThread]: Partial parsing: added file: real_estate_project_dbt://models\example\property_distribution.sql
[0m01:51:45.028017 [error] [MainThread]: Encountered an error:
Compilation Error in model property_distribution (models\example\property_distribution.sql)
  expected token 'end of print statement', got 'database'
    line 2
      database='REAL_ESTATE',
[0m01:51:45.028017 [debug] [MainThread]: Command `dbt run` failed at 01:51:45.028017 after 2.38 seconds
[0m01:51:45.043838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E2D52C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222F5314050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222F3E48230>]}
[0m01:51:45.044925 [debug] [MainThread]: Flushing usage events
[0m01:51:46.294046 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:53:32.899450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167F298DD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167F5B3EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167F57E4440>]}


============================== 01:53:32.911829 | eb86d9df-4655-42ef-9afd-8fd2a565b70d ==============================
[0m01:53:32.911829 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:53:32.912823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:53:34.179291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb86d9df-4655-42ef-9afd-8fd2a565b70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167FF665190>]}
[0m01:53:34.282185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb86d9df-4655-42ef-9afd-8fd2a565b70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167F573F290>]}
[0m01:53:34.283185 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:53:34.720362 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:53:34.880027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:53:34.880027 [debug] [MainThread]: Partial parsing: added file: real_estate_project_dbt://models\example\property_distribution.sql
[0m01:53:35.161627 [error] [MainThread]: Encountered an error:
Compilation Error in model property_distribution (models\example\property_distribution.sql)
  expected token 'end of print statement', got 'database'
    line 2
      database='REAL_ESTATE',
[0m01:53:35.163720 [debug] [MainThread]: Command `dbt run` failed at 01:53:35.162713 after 2.46 seconds
[0m01:53:35.163720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167F5A0B0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167882DCB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167885AB6B0>]}
[0m01:53:35.164719 [debug] [MainThread]: Flushing usage events
[0m01:53:35.172675 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:59:11.901411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B59EDB800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B5C9711C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B5C973A40>]}


============================== 01:59:11.909401 | 19b99be5-7199-4559-a23a-b63d0a4937a3 ==============================
[0m01:59:11.909401 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:59:11.911451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:59:13.842839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19b99be5-7199-4559-a23a-b63d0a4937a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B6F0BBFB0>]}
[0m01:59:14.032244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19b99be5-7199-4559-a23a-b63d0a4937a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B5CD3EAB0>]}
[0m01:59:14.032244 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:59:14.833113 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:59:15.070895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:59:15.086704 [debug] [MainThread]: Partial parsing: added file: real_estate_project_dbt://models\example\property_distribution.sql
[0m01:59:15.532251 [error] [MainThread]: Encountered an error:
Compilation Error in model property_distribution (models\example\property_distribution.sql)
  expected token 'end of print statement', got 'database'
    line 2
      database='REAL_ESTATE',
[0m01:59:15.536579 [debug] [MainThread]: Command `dbt run` failed at 01:59:15.536579 after 3.83 seconds
[0m01:59:15.536579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B59EDB800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B6D99DE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B6C86E630>]}
[0m01:59:15.536579 [debug] [MainThread]: Flushing usage events
[0m01:59:16.903741 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:59:43.282353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AACBB443B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AACBE9EC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AACBE9C740>]}


============================== 01:59:43.289886 | a7610099-09a3-42af-b32f-2ee73beb2332 ==============================
[0m01:59:43.289886 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:59:43.289886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:59:45.373632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7610099-09a3-42af-b32f-2ee73beb2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AADE22D670>]}
[0m01:59:45.484364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7610099-09a3-42af-b32f-2ee73beb2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AADBAE7E60>]}
[0m01:59:45.484364 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:59:46.121146 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:59:46.342755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:59:46.342755 [debug] [MainThread]: Partial parsing: added file: real_estate_project_dbt://models\example\property_distribution.sql
[0m01:59:46.766823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7610099-09a3-42af-b32f-2ee73beb2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AADE3B3200>]}
[0m01:59:46.935040 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m01:59:46.935040 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m01:59:46.982123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7610099-09a3-42af-b32f-2ee73beb2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AADE795280>]}
[0m01:59:46.982123 [info ] [MainThread]: Found 4 models, 4 data tests, 476 macros
[0m01:59:46.984640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7610099-09a3-42af-b32f-2ee73beb2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AADE64F230>]}
[0m01:59:46.986024 [info ] [MainThread]: 
[0m01:59:46.986024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:59:46.986024 [info ] [MainThread]: 
[0m01:59:46.990295 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:59:46.994885 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m01:59:47.157703 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m01:59:47.157703 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m01:59:47.157703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:59:49.067162 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.907 seconds
[0m01:59:49.082872 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m01:59:49.082872 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m01:59:49.228904 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.137 seconds
[0m01:59:49.241868 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m01:59:49.276270 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:59:49.276270 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:59:49.276270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:59:50.423765 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.148 seconds
[0m01:59:50.439515 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:59:50.439515 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m01:59:50.601000 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.149 seconds
[0m01:59:50.601000 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:59:50.601000 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:59:50.730333 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m01:59:50.730333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTINGS)
[0m01:59:50.746173 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:59:50.746173 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:59:50.925449 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.171 seconds
[0m01:59:50.925449 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:59:50.925449 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m01:59:51.070363 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.144 seconds
[0m01:59:51.086191 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:59:51.086191 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:59:51.199202 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m01:59:51.215045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7610099-09a3-42af-b32f-2ee73beb2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AADED47080>]}
[0m01:59:51.230782 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m01:59:51.230782 [info ] [Thread-1 (]: 1 of 4 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m01:59:51.230782 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m01:59:51.230782 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m01:59:51.271360 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m01:59:51.271360 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m01:59:51.376549 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m01:59:51.376549 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m01:59:51.376549 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m01:59:51.376549 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:59:52.615319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.227 seconds
[0m01:59:52.692383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7610099-09a3-42af-b32f-2ee73beb2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AADECBA900>]}
[0m01:59:52.692383 [info ] [Thread-1 (]: 1 of 4 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.46s]
[0m01:59:52.692383 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m01:59:52.708263 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_first_dbt_model
[0m01:59:52.708263 [info ] [Thread-1 (]: 2 of 4 START sql table model LISTINGS.my_first_dbt_model ....................... [RUN]
[0m01:59:52.708263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.my_first_dbt_model)
[0m01:59:52.713513 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_first_dbt_model
[0m01:59:52.720649 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:59:52.724945 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_first_dbt_model
[0m01:59:52.786717 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:59:52.786717 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_first_dbt_model"
[0m01:59:52.791674 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_first_dbt_model"} */
create or replace transient table REAL_ESTATE.LISTINGS.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m01:59:53.690164 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.899 seconds
[0m01:59:53.703217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7610099-09a3-42af-b32f-2ee73beb2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AADED578C0>]}
[0m01:59:53.705238 [info ] [Thread-1 (]: 2 of 4 OK created sql table model LISTINGS.my_first_dbt_model .................. [[32mSUCCESS 1[0m in 0.99s]
[0m01:59:53.709277 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_first_dbt_model
[0m01:59:53.711296 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m01:59:53.715334 [info ] [Thread-1 (]: 3 of 4 START sql Table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m01:59:53.719955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.my_first_dbt_model, now model.real_estate_project_dbt.property_distribution)
[0m01:59:53.719955 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m01:59:53.742526 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m01:59:53.748082 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m01:59:53.776570 [debug] [Thread-1 (]: Compilation Error in model property_distribution (models\example\property_distribution.sql)
  No materialization 'Table' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m01:59:53.779645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7610099-09a3-42af-b32f-2ee73beb2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AADEDA8B60>]}
[0m01:59:53.780989 [error] [Thread-1 (]: 3 of 4 ERROR creating sql Table model LISTINGS_LISTINGS.property_distribution .. [[31mERROR[0m in 0.06s]
[0m01:59:53.787500 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m01:59:53.787500 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_second_dbt_model
[0m01:59:53.791676 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.property_distribution' to be skipped because of status 'error'.  Reason: Compilation Error in model property_distribution (models\example\property_distribution.sql)
  No materialization 'Table' was found for adapter snowflake! (searched types 'default' and 'snowflake').
[0m01:59:53.791676 [info ] [Thread-1 (]: 4 of 4 START sql view model LISTINGS.my_second_dbt_model ....................... [RUN]
[0m01:59:53.802092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.my_second_dbt_model)
[0m01:59:53.803873 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_second_dbt_model
[0m01:59:53.821654 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:59:53.832799 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_second_dbt_model
[0m01:59:53.858738 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:59:53.867227 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_second_dbt_model"
[0m01:59:53.869582 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_second_dbt_model"} */
create or replace   view REAL_ESTATE.LISTINGS.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from REAL_ESTATE.LISTINGS.my_first_dbt_model
where id = 1
  );
[0m01:59:54.194674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.330 seconds
[0m01:59:54.210726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7610099-09a3-42af-b32f-2ee73beb2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AACAA94AD0>]}
[0m01:59:54.210726 [info ] [Thread-1 (]: 4 of 4 OK created sql view model LISTINGS.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.41s]
[0m01:59:54.210726 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_second_dbt_model
[0m01:59:54.210726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:59:54.210726 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m01:59:54.226872 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m01:59:54.405277 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS' was left open.
[0m01:59:54.405277 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS: Close
[0m01:59:54.594954 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.my_second_dbt_model' was left open.
[0m01:59:54.594954 [debug] [MainThread]: On model.real_estate_project_dbt.my_second_dbt_model: Close
[0m01:59:54.816904 [info ] [MainThread]: 
[0m01:59:54.819829 [info ] [MainThread]: Finished running 1 Table model, 1 table model, 2 view models in 0 hours 0 minutes and 7.83 seconds (7.83s).
[0m01:59:54.827466 [debug] [MainThread]: Command end result
[0m01:59:54.918890 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m01:59:54.924921 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m01:59:54.935006 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m01:59:54.935006 [info ] [MainThread]: 
[0m01:59:54.935006 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:59:54.938266 [info ] [MainThread]: 
[0m01:59:54.938266 [error] [MainThread]: [31mFailure in model property_distribution (models\example\property_distribution.sql)[0m
[0m01:59:54.940490 [error] [MainThread]:   Compilation Error in model property_distribution (models\example\property_distribution.sql)
  No materialization 'Table' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m01:59:54.941503 [info ] [MainThread]: 
[0m01:59:54.941503 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\property_distribution.sql
[0m01:59:54.941503 [info ] [MainThread]: 
[0m01:59:54.944309 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m01:59:54.946602 [debug] [MainThread]: Command `dbt run` failed at 01:59:54.944309 after 11.90 seconds
[0m01:59:54.947193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AACBB443B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AACB8C9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AACC1ACD40>]}
[0m01:59:54.948441 [debug] [MainThread]: Flushing usage events
[0m01:59:56.242442 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:00:39.317556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C4CF002F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C4D5BEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C4D5BE9F0>]}


============================== 02:00:39.334420 | 6e8310f2-869e-4cae-acd3-0d6f7acdb2b8 ==============================
[0m02:00:39.334420 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:00:39.334420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:00:41.709959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e8310f2-869e-4cae-acd3-0d6f7acdb2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C4D267530>]}
[0m02:00:41.824549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e8310f2-869e-4cae-acd3-0d6f7acdb2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5E4117F0>]}
[0m02:00:41.826855 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m02:00:42.393819 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m02:00:42.726894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:00:42.726894 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\property_distribution.sql
[0m02:00:43.232499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e8310f2-869e-4cae-acd3-0d6f7acdb2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5FEEB200>]}
[0m02:00:43.485333 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m02:00:43.485333 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m02:00:43.542152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e8310f2-869e-4cae-acd3-0d6f7acdb2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5FE600E0>]}
[0m02:00:43.542152 [info ] [MainThread]: Found 4 models, 4 data tests, 476 macros
[0m02:00:43.542152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e8310f2-869e-4cae-acd3-0d6f7acdb2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5FEE9A90>]}
[0m02:00:43.542152 [info ] [MainThread]: 
[0m02:00:43.542152 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:00:43.542152 [info ] [MainThread]: 
[0m02:00:43.551687 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:00:43.560153 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m02:00:43.740391 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m02:00:43.740391 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m02:00:43.740391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:45.337138 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.600 seconds
[0m02:00:45.356218 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m02:00:45.360002 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m02:00:45.540126 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.182 seconds
[0m02:00:45.547940 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m02:00:45.587976 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m02:00:45.587976 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:00:45.587976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:46.980854 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.391 seconds
[0m02:00:46.994406 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m02:00:46.994406 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m02:00:47.144228 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.145 seconds
[0m02:00:47.156095 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m02:00:47.156095 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:00:47.336339 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.185 seconds
[0m02:00:47.350827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTINGS)
[0m02:00:47.366561 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m02:00:47.366561 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:00:47.498176 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.130 seconds
[0m02:00:47.498176 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m02:00:47.498176 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m02:00:47.645719 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.149 seconds
[0m02:00:47.661809 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m02:00:47.661809 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:00:47.859400 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.191 seconds
[0m02:00:47.865454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e8310f2-869e-4cae-acd3-0d6f7acdb2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5FFE5A60>]}
[0m02:00:47.878865 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m02:00:47.878865 [info ] [Thread-1 (]: 1 of 4 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m02:00:47.889206 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m02:00:47.889206 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m02:00:47.925617 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m02:00:47.928271 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m02:00:48.044080 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m02:00:48.052422 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m02:00:48.052422 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m02:00:48.052422 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:00:49.497417 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.444 seconds
[0m02:00:49.587601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e8310f2-869e-4cae-acd3-0d6f7acdb2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C4A87A1B0>]}
[0m02:00:49.587601 [info ] [Thread-1 (]: 1 of 4 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.68s]
[0m02:00:49.587601 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m02:00:49.587601 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_first_dbt_model
[0m02:00:49.587601 [info ] [Thread-1 (]: 2 of 4 START sql table model LISTINGS.my_first_dbt_model ....................... [RUN]
[0m02:00:49.587601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.my_first_dbt_model)
[0m02:00:49.604700 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_first_dbt_model
[0m02:00:49.614434 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m02:00:49.619695 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_first_dbt_model
[0m02:00:49.696192 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m02:00:49.710789 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_first_dbt_model"
[0m02:00:49.710789 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_first_dbt_model"} */
create or replace transient table REAL_ESTATE.LISTINGS.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m02:00:50.526181 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.812 seconds
[0m02:00:50.531155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e8310f2-869e-4cae-acd3-0d6f7acdb2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6046B3E0>]}
[0m02:00:50.540719 [info ] [Thread-1 (]: 2 of 4 OK created sql table model LISTINGS.my_first_dbt_model .................. [[32mSUCCESS 1[0m in 0.94s]
[0m02:00:50.544772 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_first_dbt_model
[0m02:00:50.548680 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m02:00:50.554496 [info ] [Thread-1 (]: 3 of 4 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m02:00:50.559004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.my_first_dbt_model, now model.real_estate_project_dbt.property_distribution)
[0m02:00:50.561685 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m02:00:50.571134 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m02:00:50.579691 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m02:00:50.601022 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m02:00:50.610150 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m02:00:50.612168 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS(
    SELECT
    CLEAN_CITY_NAME,
    PERCENTILE_CONT(O.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
GROUP BY CLEAN_CITY_NAME
)

flagged_listings AS (
    SELECT
      1.*,
      c.P90_PRICE,
      CASE
          wHEN 1.PRICE > c.P90_PRICE THEN TRUE
          ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED 1
    JOIN city_percentiles c 
    ON 1.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)
    )
;
[0m02:00:50.793765 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd1e6e-3201-b504-0000-000e0472c5b5
[0m02:00:50.793765 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 21 unexpected '.9'.
syntax error line 10 at position 21 unexpected '.9'.
syntax error line 10 at position 53 unexpected ')'.
[0m02:00:50.807402 [debug] [Thread-1 (]: Database Error in model property_distribution (models\example\property_distribution.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 21 unexpected '.9'.
  syntax error line 10 at position 21 unexpected '.9'.
  syntax error line 10 at position 53 unexpected ')'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_distribution.sql
[0m02:00:50.808739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e8310f2-869e-4cae-acd3-0d6f7acdb2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C604A3E00>]}
[0m02:00:50.810581 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model LISTINGS_LISTINGS.property_distribution .. [[31mERROR[0m in 0.25s]
[0m02:00:50.815568 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m02:00:50.817587 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_second_dbt_model
[0m02:00:50.817587 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.property_distribution' to be skipped because of status 'error'.  Reason: Database Error in model property_distribution (models\example\property_distribution.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 21 unexpected '.9'.
  syntax error line 10 at position 21 unexpected '.9'.
  syntax error line 10 at position 53 unexpected ')'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_distribution.sql.
[0m02:00:50.823313 [info ] [Thread-1 (]: 4 of 4 START sql view model LISTINGS.my_second_dbt_model ....................... [RUN]
[0m02:00:50.830725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.my_second_dbt_model)
[0m02:00:50.831889 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_second_dbt_model
[0m02:00:50.858604 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m02:00:50.863165 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_second_dbt_model
[0m02:00:50.877858 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m02:00:50.885226 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_second_dbt_model"
[0m02:00:50.885226 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_second_dbt_model"} */
create or replace   view REAL_ESTATE.LISTINGS.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from REAL_ESTATE.LISTINGS.my_first_dbt_model
where id = 1
  );
[0m02:00:51.444919 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.555 seconds
[0m02:00:51.446222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e8310f2-869e-4cae-acd3-0d6f7acdb2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C4A968380>]}
[0m02:00:51.446222 [info ] [Thread-1 (]: 4 of 4 OK created sql view model LISTINGS.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.62s]
[0m02:00:51.462705 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_second_dbt_model
[0m02:00:51.466678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:00:51.468995 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m02:00:51.471017 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m02:00:51.854720 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS' was left open.
[0m02:00:51.856740 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS: Close
[0m02:00:52.074883 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.my_second_dbt_model' was left open.
[0m02:00:52.078360 [debug] [MainThread]: On model.real_estate_project_dbt.my_second_dbt_model: Close
[0m02:00:52.299500 [info ] [MainThread]: 
[0m02:00:52.299500 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 8.75 seconds (8.75s).
[0m02:00:52.309160 [debug] [MainThread]: Command end result
[0m02:00:52.412490 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m02:00:52.422839 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m02:00:52.444968 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m02:00:52.444968 [info ] [MainThread]: 
[0m02:00:52.444968 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:00:52.444968 [info ] [MainThread]: 
[0m02:00:52.444968 [error] [MainThread]: [31mFailure in model property_distribution (models\example\property_distribution.sql)[0m
[0m02:00:52.444968 [error] [MainThread]:   Database Error in model property_distribution (models\example\property_distribution.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 21 unexpected '.9'.
  syntax error line 10 at position 21 unexpected '.9'.
  syntax error line 10 at position 53 unexpected ')'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_distribution.sql
[0m02:00:52.459398 [info ] [MainThread]: 
[0m02:00:52.463127 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\property_distribution.sql
[0m02:00:52.465921 [info ] [MainThread]: 
[0m02:00:52.469071 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m02:00:52.475792 [debug] [MainThread]: Command `dbt run` failed at 02:00:52.475792 after 13.42 seconds
[0m02:00:52.475792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5FF6B740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C4CB68AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C60079310>]}
[0m02:00:52.479282 [debug] [MainThread]: Flushing usage events
[0m02:00:53.994941 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:02:24.192090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B3925F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B38B0ED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B38D94EF0>]}


============================== 02:02:24.203098 | c2a6cdcc-d321-4dc6-b28b-cc627301032d ==============================
[0m02:02:24.203098 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:02:24.213166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:02:26.613929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2a6cdcc-d321-4dc6-b28b-cc627301032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B49869BB0>]}
[0m02:02:26.736417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2a6cdcc-d321-4dc6-b28b-cc627301032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B48E07260>]}
[0m02:02:26.736417 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m02:02:27.300306 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m02:02:27.663563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:02:27.663563 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\property_distribution.sql
[0m02:02:28.086528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2a6cdcc-d321-4dc6-b28b-cc627301032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B4BD39640>]}
[0m02:02:28.293389 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m02:02:28.303625 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m02:02:28.367367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2a6cdcc-d321-4dc6-b28b-cc627301032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B4BB20B90>]}
[0m02:02:28.367367 [info ] [MainThread]: Found 4 models, 4 data tests, 476 macros
[0m02:02:28.367367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2a6cdcc-d321-4dc6-b28b-cc627301032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B4BD39490>]}
[0m02:02:28.367367 [info ] [MainThread]: 
[0m02:02:28.367367 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:02:28.378745 [info ] [MainThread]: 
[0m02:02:28.380248 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:02:28.395355 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m02:02:28.572288 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m02:02:28.572288 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m02:02:28.572288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:02:30.571870 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.997 seconds
[0m02:02:30.598328 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m02:02:30.601135 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m02:02:30.769560 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.170 seconds
[0m02:02:30.784054 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m02:02:30.899194 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m02:02:30.913863 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:02:30.915886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:02:32.250433 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.340 seconds
[0m02:02:32.264148 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m02:02:32.264148 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m02:02:32.428116 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.155 seconds
[0m02:02:32.428116 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m02:02:32.438968 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:02:32.604081 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.175 seconds
[0m02:02:32.620181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTINGS)
[0m02:02:32.635925 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m02:02:32.635925 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:02:32.820747 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.180 seconds
[0m02:02:32.826400 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m02:02:32.828110 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m02:02:32.974953 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.145 seconds
[0m02:02:32.983060 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m02:02:32.985165 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:02:33.126090 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.141 seconds
[0m02:02:33.131363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2a6cdcc-d321-4dc6-b28b-cc627301032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B4C0F5CA0>]}
[0m02:02:33.145998 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m02:02:33.145998 [info ] [Thread-1 (]: 1 of 4 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m02:02:33.145998 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m02:02:33.163468 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m02:02:33.194168 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m02:02:33.198275 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m02:02:33.272518 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m02:02:33.272518 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m02:02:33.272518 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m02:02:33.272518 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:02:34.769524 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.485 seconds
[0m02:02:34.919167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2a6cdcc-d321-4dc6-b28b-cc627301032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B3651A210>]}
[0m02:02:34.921187 [info ] [Thread-1 (]: 1 of 4 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.77s]
[0m02:02:34.925222 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m02:02:34.928867 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_first_dbt_model
[0m02:02:34.931764 [info ] [Thread-1 (]: 2 of 4 START sql table model LISTINGS.my_first_dbt_model ....................... [RUN]
[0m02:02:34.935292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.my_first_dbt_model)
[0m02:02:34.936385 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_first_dbt_model
[0m02:02:34.949735 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m02:02:34.958332 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_first_dbt_model
[0m02:02:35.074337 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m02:02:35.078360 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_first_dbt_model"
[0m02:02:35.078360 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_first_dbt_model"} */
create or replace transient table REAL_ESTATE.LISTINGS.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m02:02:35.994823 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.914 seconds
[0m02:02:36.002637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2a6cdcc-d321-4dc6-b28b-cc627301032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B4C10B9B0>]}
[0m02:02:36.006239 [info ] [Thread-1 (]: 2 of 4 OK created sql table model LISTINGS.my_first_dbt_model .................. [[32mSUCCESS 1[0m in 1.07s]
[0m02:02:36.012332 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_first_dbt_model
[0m02:02:36.017336 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m02:02:36.021386 [info ] [Thread-1 (]: 3 of 4 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m02:02:36.023599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.my_first_dbt_model, now model.real_estate_project_dbt.property_distribution)
[0m02:02:36.023599 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m02:02:36.044970 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m02:02:36.044970 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m02:02:36.065247 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m02:02:36.073669 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m02:02:36.073669 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS(
    SELECT
    CLEAN_CITY_NAME,
    PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
GROUP BY CLEAN_CITY_NAME
)

flagged_listings AS (
    SELECT
      l.*,
      c.P90_PRICE,
      CASE
          wHEN 1.PRICE > c.P90_PRICE THEN TRUE
          ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED l
    JOIN city_percentiles c 
    ON 1.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m02:02:36.212659 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd1e70-3201-b497-0000-000e0472bda9
[0m02:02:36.212659 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 0 unexpected 'flagged_listings'.
syntax error line 25 at position 7 unexpected '1.'.
[0m02:02:36.228647 [debug] [Thread-1 (]: Database Error in model property_distribution (models\example\property_distribution.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 0 unexpected 'flagged_listings'.
  syntax error line 25 at position 7 unexpected '1.'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_distribution.sql
[0m02:02:36.228647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2a6cdcc-d321-4dc6-b28b-cc627301032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B4C143890>]}
[0m02:02:36.228647 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model LISTINGS_LISTINGS.property_distribution .. [[31mERROR[0m in 0.21s]
[0m02:02:36.244471 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m02:02:36.246840 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_second_dbt_model
[0m02:02:36.248918 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.property_distribution' to be skipped because of status 'error'.  Reason: Database Error in model property_distribution (models\example\property_distribution.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 0 unexpected 'flagged_listings'.
  syntax error line 25 at position 7 unexpected '1.'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_distribution.sql.
[0m02:02:36.248918 [info ] [Thread-1 (]: 4 of 4 START sql view model LISTINGS.my_second_dbt_model ....................... [RUN]
[0m02:02:36.256546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.my_second_dbt_model)
[0m02:02:36.256546 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_second_dbt_model
[0m02:02:36.278754 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m02:02:36.281620 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_second_dbt_model
[0m02:02:36.292253 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m02:02:36.299022 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_second_dbt_model"
[0m02:02:36.299022 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_second_dbt_model"} */
create or replace   view REAL_ESTATE.LISTINGS.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from REAL_ESTATE.LISTINGS.my_first_dbt_model
where id = 1
  );
[0m02:02:36.515285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m02:02:36.531060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2a6cdcc-d321-4dc6-b28b-cc627301032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B4BB1E780>]}
[0m02:02:36.531060 [info ] [Thread-1 (]: 4 of 4 OK created sql view model LISTINGS.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.27s]
[0m02:02:36.531060 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_second_dbt_model
[0m02:02:36.542719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:02:36.544744 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m02:02:36.546768 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m02:02:37.225679 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS' was left open.
[0m02:02:37.227700 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS: Close
[0m02:02:37.478405 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.my_second_dbt_model' was left open.
[0m02:02:37.478405 [debug] [MainThread]: On model.real_estate_project_dbt.my_second_dbt_model: Close
[0m02:02:37.666778 [info ] [MainThread]: 
[0m02:02:37.669176 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 9.28 seconds (9.28s).
[0m02:02:37.674554 [debug] [MainThread]: Command end result
[0m02:02:37.771197 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m02:02:37.779478 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m02:02:37.807859 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m02:02:37.809844 [info ] [MainThread]: 
[0m02:02:37.812591 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:02:37.814638 [info ] [MainThread]: 
[0m02:02:37.817390 [error] [MainThread]: [31mFailure in model property_distribution (models\example\property_distribution.sql)[0m
[0m02:02:37.821263 [error] [MainThread]:   Database Error in model property_distribution (models\example\property_distribution.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 0 unexpected 'flagged_listings'.
  syntax error line 25 at position 7 unexpected '1.'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_distribution.sql
[0m02:02:37.823941 [info ] [MainThread]: 
[0m02:02:37.828158 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\property_distribution.sql
[0m02:02:37.832011 [info ] [MainThread]: 
[0m02:02:37.834735 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m02:02:37.841895 [debug] [MainThread]: Command `dbt run` failed at 02:02:37.841255 after 13.93 seconds
[0m02:02:37.843895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B38D735C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B4BD3A0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B38808BC0>]}
[0m02:02:37.845635 [debug] [MainThread]: Flushing usage events
[0m02:02:39.366505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:27.206076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFE0238C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFE3563440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFE3560A40>]}


============================== 02:03:27.219978 | 015df002-b62e-46b1-a0b8-22a1f40dcbb1 ==============================
[0m02:03:27.219978 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:03:27.219978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:03:29.275971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '015df002-b62e-46b1-a0b8-22a1f40dcbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFF4633830>]}
[0m02:03:29.390510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '015df002-b62e-46b1-a0b8-22a1f40dcbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFF422EAB0>]}
[0m02:03:29.390510 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m02:03:29.998148 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m02:03:30.327111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:03:30.328232 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\property_distribution.sql
[0m02:03:30.778657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '015df002-b62e-46b1-a0b8-22a1f40dcbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFF5CE9730>]}
[0m02:03:30.969985 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m02:03:30.969985 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m02:03:31.051115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '015df002-b62e-46b1-a0b8-22a1f40dcbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFF5B15190>]}
[0m02:03:31.053132 [info ] [MainThread]: Found 4 models, 4 data tests, 476 macros
[0m02:03:31.055143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '015df002-b62e-46b1-a0b8-22a1f40dcbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFE2841520>]}
[0m02:03:31.055143 [info ] [MainThread]: 
[0m02:03:31.055143 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:03:31.063620 [info ] [MainThread]: 
[0m02:03:31.064897 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:03:31.078936 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m02:03:31.232472 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m02:03:31.232472 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m02:03:31.232472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:32.989549 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.759 seconds
[0m02:03:33.004257 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m02:03:33.004257 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m02:03:33.182675 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.173 seconds
[0m02:03:33.182675 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m02:03:33.230067 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m02:03:33.230067 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:03:33.230067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:34.455924 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.230 seconds
[0m02:03:34.468022 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m02:03:34.468022 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m02:03:34.661099 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.188 seconds
[0m02:03:34.676862 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m02:03:34.678955 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:03:34.823757 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.144 seconds
[0m02:03:34.829277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTINGS)
[0m02:03:34.840204 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m02:03:34.843929 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:03:34.977696 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.132 seconds
[0m02:03:34.983770 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m02:03:34.985187 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m02:03:35.128923 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.146 seconds
[0m02:03:35.128923 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m02:03:35.128923 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:03:35.274209 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.144 seconds
[0m02:03:35.290034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '015df002-b62e-46b1-a0b8-22a1f40dcbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFE2ECD3D0>]}
[0m02:03:35.305890 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m02:03:35.305890 [info ] [Thread-1 (]: 1 of 4 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m02:03:35.305890 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m02:03:35.305890 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m02:03:35.341714 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m02:03:35.341714 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m02:03:35.439290 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m02:03:35.451860 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m02:03:35.451860 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m02:03:35.451860 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:03:36.706614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.267 seconds
[0m02:03:36.801701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '015df002-b62e-46b1-a0b8-22a1f40dcbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFE04E9F10>]}
[0m02:03:36.801701 [info ] [Thread-1 (]: 1 of 4 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.48s]
[0m02:03:36.801701 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m02:03:36.801701 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_first_dbt_model
[0m02:03:36.801701 [info ] [Thread-1 (]: 2 of 4 START sql table model LISTINGS.my_first_dbt_model ....................... [RUN]
[0m02:03:36.801701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.my_first_dbt_model)
[0m02:03:36.817823 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_first_dbt_model
[0m02:03:36.827790 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m02:03:36.834264 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_first_dbt_model
[0m02:03:36.914895 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m02:03:36.914895 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_first_dbt_model"
[0m02:03:36.914895 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_first_dbt_model"} */
create or replace transient table REAL_ESTATE.LISTINGS.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m02:03:37.948640 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.030 seconds
[0m02:03:37.966512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '015df002-b62e-46b1-a0b8-22a1f40dcbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFF60DB320>]}
[0m02:03:37.972888 [info ] [Thread-1 (]: 2 of 4 OK created sql table model LISTINGS.my_first_dbt_model .................. [[32mSUCCESS 1[0m in 1.16s]
[0m02:03:37.976587 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_first_dbt_model
[0m02:03:37.976587 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m02:03:37.981595 [info ] [Thread-1 (]: 3 of 4 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m02:03:37.984819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.my_first_dbt_model, now model.real_estate_project_dbt.property_distribution)
[0m02:03:37.985853 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m02:03:38.005253 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m02:03:38.009569 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m02:03:38.030003 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m02:03:38.033110 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m02:03:38.040809 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS(
    SELECT
    CLEAN_CITY_NAME,
    PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
      l.*,
      c.P90_PRICE,
      CASE
          wHEN 1.PRICE > c.P90_PRICE THEN TRUE
          ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
    ON 1.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m02:03:38.174866 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd1e71-3201-b497-0000-000e0472bdc5
[0m02:03:38.174866 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 17 unexpected 'PRICE'.
syntax error line 20 at position 37 unexpected 'THEN'.
syntax error line 21 at position 10 unexpected 'ELSE'.
syntax error line 25 at position 7 unexpected '1.'.
[0m02:03:38.196484 [debug] [Thread-1 (]: Database Error in model property_distribution (models\example\property_distribution.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 17 unexpected 'PRICE'.
  syntax error line 20 at position 37 unexpected 'THEN'.
  syntax error line 21 at position 10 unexpected 'ELSE'.
  syntax error line 25 at position 7 unexpected '1.'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_distribution.sql
[0m02:03:38.198662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '015df002-b62e-46b1-a0b8-22a1f40dcbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFF6113E60>]}
[0m02:03:38.198662 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model LISTINGS_LISTINGS.property_distribution .. [[31mERROR[0m in 0.22s]
[0m02:03:38.205720 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m02:03:38.207081 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_second_dbt_model
[0m02:03:38.207081 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.property_distribution' to be skipped because of status 'error'.  Reason: Database Error in model property_distribution (models\example\property_distribution.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 17 unexpected 'PRICE'.
  syntax error line 20 at position 37 unexpected 'THEN'.
  syntax error line 21 at position 10 unexpected 'ELSE'.
  syntax error line 25 at position 7 unexpected '1.'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_distribution.sql.
[0m02:03:38.207081 [info ] [Thread-1 (]: 4 of 4 START sql view model LISTINGS.my_second_dbt_model ....................... [RUN]
[0m02:03:38.214914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.my_second_dbt_model)
[0m02:03:38.220335 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_second_dbt_model
[0m02:03:38.234868 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m02:03:38.236243 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_second_dbt_model
[0m02:03:38.246133 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m02:03:38.256651 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_second_dbt_model"
[0m02:03:38.256651 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_second_dbt_model"} */
create or replace   view REAL_ESTATE.LISTINGS.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from REAL_ESTATE.LISTINGS.my_first_dbt_model
where id = 1
  );
[0m02:03:38.563224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.301 seconds
[0m02:03:38.573891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '015df002-b62e-46b1-a0b8-22a1f40dcbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFF603DAC0>]}
[0m02:03:38.573891 [info ] [Thread-1 (]: 4 of 4 OK created sql view model LISTINGS.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.36s]
[0m02:03:38.573891 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_second_dbt_model
[0m02:03:38.581159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:03:38.581159 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m02:03:38.589094 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m02:03:38.870407 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS' was left open.
[0m02:03:38.872429 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS: Close
[0m02:03:39.131982 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.my_second_dbt_model' was left open.
[0m02:03:39.131982 [debug] [MainThread]: On model.real_estate_project_dbt.my_second_dbt_model: Close
[0m02:03:39.373139 [info ] [MainThread]: 
[0m02:03:39.373139 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 8.31 seconds (8.31s).
[0m02:03:39.389196 [debug] [MainThread]: Command end result
[0m02:03:39.473614 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m02:03:39.489211 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m02:03:39.509440 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m02:03:39.509440 [info ] [MainThread]: 
[0m02:03:39.509440 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:03:39.509440 [info ] [MainThread]: 
[0m02:03:39.517622 [error] [MainThread]: [31mFailure in model property_distribution (models\example\property_distribution.sql)[0m
[0m02:03:39.519445 [error] [MainThread]:   Database Error in model property_distribution (models\example\property_distribution.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 17 unexpected 'PRICE'.
  syntax error line 20 at position 37 unexpected 'THEN'.
  syntax error line 21 at position 10 unexpected 'ELSE'.
  syntax error line 25 at position 7 unexpected '1.'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_distribution.sql
[0m02:03:39.521178 [info ] [MainThread]: 
[0m02:03:39.523296 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\property_distribution.sql
[0m02:03:39.523296 [info ] [MainThread]: 
[0m02:03:39.526655 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m02:03:39.528725 [debug] [MainThread]: Command `dbt run` failed at 02:03:39.528725 after 12.66 seconds
[0m02:03:39.528725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFE35315B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFE3562AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFF2BF2F30>]}
[0m02:03:39.528725 [debug] [MainThread]: Flushing usage events
[0m02:03:40.917311 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:05:28.736840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023482E8FE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023482E8FF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023482BCB530>]}


============================== 02:05:28.748517 | 29eda8d3-cb31-41e4-ac2d-aa37cf9f09bf ==============================
[0m02:05:28.748517 [info ] [MainThread]: Running with dbt=1.10.1
[0m02:05:28.748517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m02:05:31.002558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29eda8d3-cb31-41e4-ac2d-aa37cf9f09bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023495695CA0>]}
[0m02:05:31.138815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29eda8d3-cb31-41e4-ac2d-aa37cf9f09bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234955DDFD0>]}
[0m02:05:31.138815 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m02:05:31.765528 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m02:05:31.991988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:05:31.991988 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\property_distribution.sql
[0m02:05:32.533834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29eda8d3-cb31-41e4-ac2d-aa37cf9f09bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023495B84290>]}
[0m02:05:32.731505 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m02:05:32.735520 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m02:05:32.794873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29eda8d3-cb31-41e4-ac2d-aa37cf9f09bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023495AC2180>]}
[0m02:05:32.794873 [info ] [MainThread]: Found 4 models, 4 data tests, 476 macros
[0m02:05:32.794873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29eda8d3-cb31-41e4-ac2d-aa37cf9f09bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023495C05F40>]}
[0m02:05:32.803508 [info ] [MainThread]: 
[0m02:05:32.805519 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:05:32.807538 [info ] [MainThread]: 
[0m02:05:32.807538 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:05:32.821003 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m02:05:32.983514 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m02:05:32.983514 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m02:05:32.983514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:05:34.636984 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.645 seconds
[0m02:05:34.653505 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m02:05:34.655122 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m02:05:34.788722 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.131 seconds
[0m02:05:34.793082 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS'
[0m02:05:34.841467 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m02:05:34.841467 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:05:34.849564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:05:36.168206 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.321 seconds
[0m02:05:36.184859 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m02:05:36.184859 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m02:05:36.340756 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.154 seconds
[0m02:05:36.353823 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m02:05:36.354907 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:05:36.528569 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.171 seconds
[0m02:05:36.537854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS, now list_REAL_ESTATE_LISTINGS_LISTINGS)
[0m02:05:36.566855 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m02:05:36.569009 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m02:05:36.707403 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.143 seconds
[0m02:05:36.721974 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m02:05:36.723267 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m02:05:36.871290 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.145 seconds
[0m02:05:36.879574 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m02:05:36.879574 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m02:05:37.039576 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.158 seconds
[0m02:05:37.039576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29eda8d3-cb31-41e4-ac2d-aa37cf9f09bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023495AECEC0>]}
[0m02:05:37.062616 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m02:05:37.062616 [info ] [Thread-1 (]: 1 of 4 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m02:05:37.070815 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m02:05:37.070815 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m02:05:37.105273 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m02:05:37.109682 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m02:05:37.190556 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m02:05:37.190556 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m02:05:37.190556 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m02:05:37.195886 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:05:38.568453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.381 seconds
[0m02:05:38.661785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29eda8d3-cb31-41e4-ac2d-aa37cf9f09bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002348051A540>]}
[0m02:05:38.663547 [info ] [Thread-1 (]: 1 of 4 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.59s]
[0m02:05:38.665703 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m02:05:38.665703 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_first_dbt_model
[0m02:05:38.665703 [info ] [Thread-1 (]: 2 of 4 START sql table model LISTINGS.my_first_dbt_model ....................... [RUN]
[0m02:05:38.672447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.my_first_dbt_model)
[0m02:05:38.675466 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_first_dbt_model
[0m02:05:38.685271 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m02:05:38.689228 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_first_dbt_model
[0m02:05:38.772694 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m02:05:38.776187 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_first_dbt_model"
[0m02:05:38.780531 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_first_dbt_model"} */
create or replace transient table REAL_ESTATE.LISTINGS.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m02:05:39.705322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.923 seconds
[0m02:05:39.719489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29eda8d3-cb31-41e4-ac2d-aa37cf9f09bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002349603C0E0>]}
[0m02:05:39.723281 [info ] [Thread-1 (]: 2 of 4 OK created sql table model LISTINGS.my_first_dbt_model .................. [[32mSUCCESS 1[0m in 1.05s]
[0m02:05:39.725301 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_first_dbt_model
[0m02:05:39.727322 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m02:05:39.731356 [info ] [Thread-1 (]: 3 of 4 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m02:05:39.735391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.my_first_dbt_model, now model.real_estate_project_dbt.property_distribution)
[0m02:05:39.737421 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m02:05:39.750147 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m02:05:39.752693 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m02:05:39.760678 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m02:05:39.764694 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m02:05:39.764694 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m02:05:40.929110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.166 seconds
[0m02:05:40.937646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29eda8d3-cb31-41e4-ac2d-aa37cf9f09bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002349613EE70>]}
[0m02:05:40.937646 [info ] [Thread-1 (]: 3 of 4 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 1.20s]
[0m02:05:40.945726 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m02:05:40.945726 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_second_dbt_model
[0m02:05:40.945726 [info ] [Thread-1 (]: 4 of 4 START sql view model LISTINGS.my_second_dbt_model ....................... [RUN]
[0m02:05:40.953850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.my_second_dbt_model)
[0m02:05:40.957885 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_second_dbt_model
[0m02:05:40.962251 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m02:05:40.972296 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_second_dbt_model
[0m02:05:40.988000 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m02:05:40.993937 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_second_dbt_model"
[0m02:05:40.995669 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_second_dbt_model"} */
create or replace   view REAL_ESTATE.LISTINGS.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from REAL_ESTATE.LISTINGS.my_first_dbt_model
where id = 1
  );
[0m02:05:41.345402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.347 seconds
[0m02:05:41.354991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29eda8d3-cb31-41e4-ac2d-aa37cf9f09bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234960F49B0>]}
[0m02:05:41.354991 [info ] [Thread-1 (]: 4 of 4 OK created sql view model LISTINGS.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.40s]
[0m02:05:41.361237 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_second_dbt_model
[0m02:05:41.365375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:05:41.367025 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m02:05:41.367025 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m02:05:41.595087 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m02:05:41.595087 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m02:05:41.854188 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.my_second_dbt_model' was left open.
[0m02:05:41.856209 [debug] [MainThread]: On model.real_estate_project_dbt.my_second_dbt_model: Close
[0m02:05:42.158003 [info ] [MainThread]: 
[0m02:05:42.158003 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 9.35 seconds (9.35s).
[0m02:05:42.173328 [debug] [MainThread]: Command end result
[0m02:05:42.265320 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m02:05:42.271379 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m02:05:42.294752 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m02:05:42.294752 [info ] [MainThread]: 
[0m02:05:42.302981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:05:42.302981 [info ] [MainThread]: 
[0m02:05:42.305837 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m02:05:42.305837 [debug] [MainThread]: Command `dbt run` succeeded at 02:05:42.305837 after 14.01 seconds
[0m02:05:42.305837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234831D45C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023482E8EE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234835615E0>]}
[0m02:05:42.311119 [debug] [MainThread]: Flushing usage events
[0m02:05:43.798471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:27:24.066981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CC535EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CC535EA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CC535CB30>]}


============================== 00:27:24.072240 | a6fb8ce7-2962-4782-b7fd-60576caa056a ==============================
[0m00:27:24.072240 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:27:24.073243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:27:27.972848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6fb8ce7-2962-4782-b7fd-60576caa056a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD6527EC0>]}
[0m00:27:28.069047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6fb8ce7-2962-4782-b7fd-60576caa056a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD769DEE0>]}
[0m00:27:28.070517 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:27:28.679428 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:27:30.016060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:27:30.017805 [debug] [MainThread]: Partial parsing: added file: real_estate_project_dbt://models\example\property_value_index.sql
[0m00:27:30.272428 [error] [MainThread]: Encountered an error:
Compilation Error in model property_value_index (models\example\property_value_index.sql)
  expected token ',', got 'schema'
    line 4
      schema='LISTINGS'
[0m00:27:30.273575 [debug] [MainThread]: Command `dbt run` failed at 00:27:30.273575 after 6.37 seconds
[0m00:27:30.274721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CC5693200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD7D6ADB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CD77BAA20>]}
[0m00:27:30.274721 [debug] [MainThread]: Flushing usage events
[0m00:27:31.822190 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:27:53.999432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF26D3A1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF26E2C5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF26E2C500>]}


============================== 00:27:53.999432 | 6a01b3cf-5743-4ffb-8d1c-80e7f9b780df ==============================
[0m00:27:53.999432 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:27:53.999432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:27:55.171172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a01b3cf-5743-4ffb-8d1c-80e7f9b780df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF36BE0FE0>]}
[0m00:27:55.281968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a01b3cf-5743-4ffb-8d1c-80e7f9b780df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF276C8C20>]}
[0m00:27:55.281968 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:27:55.673362 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:27:55.830999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:27:55.830999 [debug] [MainThread]: Partial parsing: added file: real_estate_project_dbt://models\example\property_value_index.sql
[0m00:27:56.176877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a01b3cf-5743-4ffb-8d1c-80e7f9b780df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF39AC74D0>]}
[0m00:27:56.315960 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:27:56.333946 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:27:56.379524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a01b3cf-5743-4ffb-8d1c-80e7f9b780df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF39A845C0>]}
[0m00:27:56.379524 [info ] [MainThread]: Found 5 models, 4 data tests, 476 macros
[0m00:27:56.379524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a01b3cf-5743-4ffb-8d1c-80e7f9b780df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF39AA6780>]}
[0m00:27:56.379524 [info ] [MainThread]: 
[0m00:27:56.379524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:27:56.379524 [info ] [MainThread]: 
[0m00:27:56.379524 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:27:56.379524 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m00:28:00.840295 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:28:00.840295 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:28:00.840295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:03.062789 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.223 seconds
[0m00:28:03.062789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE, now list_REAL_ESATE)
[0m00:28:03.076403 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESATE"
[0m00:28:03.076403 [debug] [ThreadPool]: On list_REAL_ESATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESATE"} */
show terse schemas in database REAL_ESATE
    limit 10000
[0m00:28:03.650529 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bd23b2-3201-b7c8-000e-0472000150b2
[0m00:28:03.650529 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m00:28:03.650529 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:28:03.650529 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:28:03.650529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESATE, now list_REAL_ESTATE)
[0m00:28:03.650529 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:28:03.650529 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:28:03.783786 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.120 seconds
[0m00:28:03.783786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:28:03.783786 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m00:28:03.795938 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m00:28:03.989097 [info ] [MainThread]: 
[0m00:28:04.004892 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.61 seconds (7.61s).
[0m00:28:04.004892 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "REAL_ESATE"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m00:28:04.013725 [debug] [MainThread]: Command `dbt run` failed at 00:28:04.013725 after 10.17 seconds
[0m00:28:04.016416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF26FFFEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF26DEBEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF39D65760>]}
[0m00:28:04.018379 [debug] [MainThread]: Flushing usage events
[0m00:28:05.315010 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:28:32.484254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F4C3BCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F734ED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F734CC20>]}


============================== 00:28:32.500380 | 13b24814-c2ce-4cfc-b1a5-ec98ab55abc8 ==============================
[0m00:28:32.500380 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:28:32.500380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:28:34.520684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13b24814-c2ce-4cfc-b1a5-ec98ab55abc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D188D2FF80>]}
[0m00:28:34.646827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13b24814-c2ce-4cfc-b1a5-ec98ab55abc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D188D2C4A0>]}
[0m00:28:34.646827 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:28:35.285879 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:28:35.618068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:28:35.618068 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\property_value_index.sql
[0m00:28:36.082378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13b24814-c2ce-4cfc-b1a5-ec98ab55abc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18A48EE40>]}
[0m00:28:36.297555 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:28:36.301571 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:28:36.352827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13b24814-c2ce-4cfc-b1a5-ec98ab55abc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18A366930>]}
[0m00:28:36.352827 [info ] [MainThread]: Found 5 models, 4 data tests, 476 macros
[0m00:28:36.361879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13b24814-c2ce-4cfc-b1a5-ec98ab55abc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F7088A40>]}
[0m00:28:36.369570 [info ] [MainThread]: 
[0m00:28:36.371116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:28:36.372762 [info ] [MainThread]: 
[0m00:28:36.375637 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:28:36.388908 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m00:28:36.588212 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:28:36.590235 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:28:36.590235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:38.269586 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.678 seconds
[0m00:28:38.280548 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:28:38.285137 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:28:38.439460 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.153 seconds
[0m00:28:38.447305 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m00:28:38.487678 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:28:38.487678 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:28:38.487678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:39.657951 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.176 seconds
[0m00:28:39.673745 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:28:39.673745 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m00:28:39.836770 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.150 seconds
[0m00:28:39.836770 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:28:39.836770 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:28:39.965566 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.130 seconds
[0m00:28:39.981303 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTINGS)
[0m00:28:39.981303 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:28:39.997136 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:28:40.129016 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.130 seconds
[0m00:28:40.135075 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:28:40.135075 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m00:28:40.303329 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.170 seconds
[0m00:28:40.303329 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:28:40.303329 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:28:40.432445 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.116 seconds
[0m00:28:40.440487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13b24814-c2ce-4cfc-b1a5-ec98ab55abc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F4E40860>]}
[0m00:28:40.454306 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m00:28:40.456316 [info ] [Thread-1 (]: 1 of 5 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m00:28:40.458327 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m00:28:40.458327 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m00:28:40.477912 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:28:40.481567 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m00:28:40.542908 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:28:40.550934 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m00:28:40.551387 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m00:28:40.551387 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:28:41.977197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.427 seconds
[0m00:28:42.049034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13b24814-c2ce-4cfc-b1a5-ec98ab55abc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F4D5A4B0>]}
[0m00:28:42.064308 [info ] [Thread-1 (]: 1 of 5 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.59s]
[0m00:28:42.068852 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m00:28:42.068852 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_first_dbt_model
[0m00:28:42.070869 [info ] [Thread-1 (]: 2 of 5 START sql table model LISTINGS.my_first_dbt_model ....................... [RUN]
[0m00:28:42.070869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.my_first_dbt_model)
[0m00:28:42.076433 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_first_dbt_model
[0m00:28:42.084848 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m00:28:42.089385 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_first_dbt_model
[0m00:28:42.171040 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m00:28:42.176918 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_first_dbt_model"
[0m00:28:42.176918 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_first_dbt_model"} */
create or replace transient table REAL_ESTATE.LISTINGS.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m00:28:43.306752 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.127 seconds
[0m00:28:43.312791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13b24814-c2ce-4cfc-b1a5-ec98ab55abc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18A9B5520>]}
[0m00:28:43.312791 [info ] [Thread-1 (]: 2 of 5 OK created sql table model LISTINGS.my_first_dbt_model .................. [[32mSUCCESS 1[0m in 1.24s]
[0m00:28:43.316797 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_first_dbt_model
[0m00:28:43.316797 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m00:28:43.316797 [info ] [Thread-1 (]: 3 of 5 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m00:28:43.320954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.my_first_dbt_model, now model.real_estate_project_dbt.property_distribution)
[0m00:28:43.323080 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m00:28:43.330201 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m00:28:43.330201 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m00:28:43.342833 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m00:28:43.346416 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m00:28:43.346416 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m00:28:44.438805 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.088 seconds
[0m00:28:44.447919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13b24814-c2ce-4cfc-b1a5-ec98ab55abc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18A9D9A30>]}
[0m00:28:44.447919 [info ] [Thread-1 (]: 3 of 5 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 1.12s]
[0m00:28:44.452787 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m00:28:44.454805 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m00:28:44.456818 [info ] [Thread-1 (]: 4 of 5 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m00:28:44.458829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_value_index)
[0m00:28:44.460035 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m00:28:44.470918 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m00:28:44.472730 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m00:28:44.479728 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m00:28:44.479728 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m00:28:44.479728 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
    PROP_ID,
    CLEAN_CITY_NAME,
    PRICE,
    AGE,
    TOTAL_FLOOR,
    BEDROOM_NUM,


    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_score,
    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDERBY BEDROOM_NUM) AS BEDROOM_SCORE,


    1-PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

FROM REAL_ESATE.LISTINGS.LISTINGS_CLEANED

),


scored AS (
    SELECT
      *,
      ROUND(
        0.4 * PRICE_score +
        0.2 * AGE_SCORE +
        0.2 * FLOOR_SCORE +
        0.2 * BEDROOM_SCORE, 4
    
      ) AS FINAL_VALUE_SCORE

    FROM ranked
)

SELECT * FROM scored
ORDERBY FINAL_VALUE_SCORE DESC
  );
[0m00:28:44.671525 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd23b2-3201-b7c8-000e-0472000150ce
[0m00:28:44.671525 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 18 at position 53 unexpected 'ORDERBY'.
syntax error line 18 at position 61 unexpected 'BEDROOM_NUM'.
syntax error line 21 at position 21 unexpected 'OVER'.
[0m00:28:44.703159 [debug] [Thread-1 (]: Database Error in model property_value_index (models\example\property_value_index.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 53 unexpected 'ORDERBY'.
  syntax error line 18 at position 61 unexpected 'BEDROOM_NUM'.
  syntax error line 21 at position 21 unexpected 'OVER'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_value_index.sql
[0m00:28:44.718812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13b24814-c2ce-4cfc-b1a5-ec98ab55abc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18A8FDA00>]}
[0m00:28:44.718812 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model LISTINGS_LISTINGS.property_value_index .... [[31mERROR[0m in 0.26s]
[0m00:28:44.718812 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m00:28:44.718812 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_second_dbt_model
[0m00:28:44.718812 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.property_value_index' to be skipped because of status 'error'.  Reason: Database Error in model property_value_index (models\example\property_value_index.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 53 unexpected 'ORDERBY'.
  syntax error line 18 at position 61 unexpected 'BEDROOM_NUM'.
  syntax error line 21 at position 21 unexpected 'OVER'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_value_index.sql.
[0m00:28:44.718812 [info ] [Thread-1 (]: 5 of 5 START sql view model LISTINGS.my_second_dbt_model ....................... [RUN]
[0m00:28:44.731219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_value_index, now model.real_estate_project_dbt.my_second_dbt_model)
[0m00:28:44.733005 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_second_dbt_model
[0m00:28:44.740515 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m00:28:44.743032 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_second_dbt_model
[0m00:28:44.748206 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m00:28:44.748206 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_second_dbt_model"
[0m00:28:44.755090 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_second_dbt_model"} */
create or replace   view REAL_ESTATE.LISTINGS.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from REAL_ESTATE.LISTINGS.my_first_dbt_model
where id = 1
  );
[0m00:28:45.042999 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.292 seconds
[0m00:28:45.042999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13b24814-c2ce-4cfc-b1a5-ec98ab55abc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18A8CB4A0>]}
[0m00:28:45.058846 [info ] [Thread-1 (]: 5 of 5 OK created sql view model LISTINGS.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.31s]
[0m00:28:45.058846 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_second_dbt_model
[0m00:28:45.058846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:28:45.058846 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m00:28:45.058846 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m00:28:45.267867 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS' was left open.
[0m00:28:45.267867 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS: Close
[0m00:28:45.467176 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.my_second_dbt_model' was left open.
[0m00:28:45.467176 [debug] [MainThread]: On model.real_estate_project_dbt.my_second_dbt_model: Close
[0m00:28:45.657448 [info ] [MainThread]: 
[0m00:28:45.657448 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 9.28 seconds (9.28s).
[0m00:28:45.657448 [debug] [MainThread]: Command end result
[0m00:28:45.708026 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:28:45.723060 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:28:45.729535 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m00:28:45.729535 [info ] [MainThread]: 
[0m00:28:45.729535 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:28:45.729535 [info ] [MainThread]: 
[0m00:28:45.738771 [error] [MainThread]: [31mFailure in model property_value_index (models\example\property_value_index.sql)[0m
[0m00:28:45.739854 [error] [MainThread]:   Database Error in model property_value_index (models\example\property_value_index.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 53 unexpected 'ORDERBY'.
  syntax error line 18 at position 61 unexpected 'BEDROOM_NUM'.
  syntax error line 21 at position 21 unexpected 'OVER'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_value_index.sql
[0m00:28:45.739854 [info ] [MainThread]: 
[0m00:28:45.739854 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\property_value_index.sql
[0m00:28:45.742790 [info ] [MainThread]: 
[0m00:28:45.743890 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m00:28:45.743890 [debug] [MainThread]: Command `dbt run` failed at 00:28:45.743890 after 13.51 seconds
[0m00:28:45.745904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F4B7C650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FFF872F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18A2EB4A0>]}
[0m00:28:45.745904 [debug] [MainThread]: Flushing usage events
[0m00:28:47.391321 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:30:33.408913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026001DBD1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260024D2300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260024D2150>]}


============================== 00:30:33.412952 | 653418a1-f28a-4c0f-a421-fa5084c32096 ==============================
[0m00:30:33.412952 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:30:33.413952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:30:34.547369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '653418a1-f28a-4c0f-a421-fa5084c32096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260036658B0>]}
[0m00:30:34.658608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '653418a1-f28a-4c0f-a421-fa5084c32096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026001B716A0>]}
[0m00:30:34.658608 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:30:35.085273 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:30:35.254659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:30:35.254659 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\property_value_index.sql
[0m00:30:35.607735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '653418a1-f28a-4c0f-a421-fa5084c32096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026014C59AC0>]}
[0m00:30:35.730011 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:30:35.730011 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:30:35.761387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '653418a1-f28a-4c0f-a421-fa5084c32096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026014A43020>]}
[0m00:30:35.761387 [info ] [MainThread]: Found 5 models, 4 data tests, 476 macros
[0m00:30:35.761387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '653418a1-f28a-4c0f-a421-fa5084c32096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026014ACD640>]}
[0m00:30:35.761387 [info ] [MainThread]: 
[0m00:30:35.761387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:30:35.761387 [info ] [MainThread]: 
[0m00:30:35.761387 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:30:35.780548 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m00:30:35.859341 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:30:35.860341 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:30:35.860341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:30:37.164673 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.312 seconds
[0m00:30:37.180613 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:30:37.182590 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:30:37.326900 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.143 seconds
[0m00:30:37.333857 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS'
[0m00:30:37.351948 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:30:37.351948 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:30:37.351948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:30:38.298963 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.940 seconds
[0m00:30:38.302987 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:30:38.302987 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m00:30:38.453293 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.149 seconds
[0m00:30:38.455301 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:30:38.457307 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:30:38.572959 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.120 seconds
[0m00:30:38.572959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS, now list_REAL_ESTATE_LISTINGS_LISTINGS)
[0m00:30:38.596707 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:30:38.596707 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:30:38.723383 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.128 seconds
[0m00:30:38.723383 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:30:38.734636 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m00:30:38.881740 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.146 seconds
[0m00:30:38.883747 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:30:38.883747 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:30:39.018455 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.135 seconds
[0m00:30:39.026097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '653418a1-f28a-4c0f-a421-fa5084c32096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026014BC67E0>]}
[0m00:30:39.026097 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m00:30:39.026097 [info ] [Thread-1 (]: 1 of 5 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m00:30:39.026097 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m00:30:39.026097 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m00:30:39.043863 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:30:39.044933 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m00:30:39.074641 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:30:39.076603 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m00:30:39.077604 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m00:30:39.077604 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:30:40.170843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.106 seconds
[0m00:30:40.214914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '653418a1-f28a-4c0f-a421-fa5084c32096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002607F43A4E0>]}
[0m00:30:40.214914 [info ] [Thread-1 (]: 1 of 5 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.19s]
[0m00:30:40.216199 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m00:30:40.217247 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_first_dbt_model
[0m00:30:40.217247 [info ] [Thread-1 (]: 2 of 5 START sql table model LISTINGS.my_first_dbt_model ....................... [RUN]
[0m00:30:40.218205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.my_first_dbt_model)
[0m00:30:40.218205 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_first_dbt_model
[0m00:30:40.223250 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m00:30:40.224258 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_first_dbt_model
[0m00:30:40.238578 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m00:30:40.238578 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_first_dbt_model"
[0m00:30:40.238578 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_first_dbt_model"} */
create or replace transient table REAL_ESTATE.LISTINGS.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m00:30:41.054100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.812 seconds
[0m00:30:41.054100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '653418a1-f28a-4c0f-a421-fa5084c32096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026014FAD580>]}
[0m00:30:41.054100 [info ] [Thread-1 (]: 2 of 5 OK created sql table model LISTINGS.my_first_dbt_model .................. [[32mSUCCESS 1[0m in 0.84s]
[0m00:30:41.054100 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_first_dbt_model
[0m00:30:41.054100 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m00:30:41.069209 [info ] [Thread-1 (]: 3 of 5 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m00:30:41.069741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.my_first_dbt_model, now model.real_estate_project_dbt.property_distribution)
[0m00:30:41.069741 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m00:30:41.069741 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m00:30:41.069741 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m00:30:41.069741 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m00:30:41.069741 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m00:30:41.069741 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m00:30:42.389695 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.312 seconds
[0m00:30:42.389695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '653418a1-f28a-4c0f-a421-fa5084c32096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260150784A0>]}
[0m00:30:42.404219 [info ] [Thread-1 (]: 3 of 5 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 1.32s]
[0m00:30:42.407215 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m00:30:42.409212 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m00:30:42.410221 [info ] [Thread-1 (]: 4 of 5 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m00:30:42.410221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_value_index)
[0m00:30:42.413905 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m00:30:42.419536 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m00:30:42.420547 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m00:30:42.425544 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m00:30:42.428195 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m00:30:42.428195 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
    PROP_ID,
    CLEAN_CITY_NAME,
    PRICE,
    AGE,
    TOTAL_FLOOR,
    BEDROOM_NUM,


    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,


    1-PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

FROM REAL_ESATE.LISTINGS.LISTINGS_CLEANED

),


scored AS (
    SELECT
      *,
      ROUND(
        0.4 * PRICE_score +
        0.2 * AGE_SCORE +
        0.2 * FLOOR_SCORE +
        0.2 * BEDROOM_SCORE, 4
    
      ) AS FINAL_VALUE_SCORE

    FROM ranked
)

SELECT * FROM scored
ORDERBY FINAL_VALUE_SCORE DESC
  );
[0m00:30:42.601516 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd23b4-3201-b7c8-000e-0472000150e6
[0m00:30:42.601516 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 43 at position 8 unexpected 'FINAL_VALUE_SCORE'.
[0m00:30:42.617239 [debug] [Thread-1 (]: Database Error in model property_value_index (models\example\property_value_index.sql)
  001003 (42000): SQL compilation error:
  syntax error line 43 at position 8 unexpected 'FINAL_VALUE_SCORE'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_value_index.sql
[0m00:30:42.617239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '653418a1-f28a-4c0f-a421-fa5084c32096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026014FA80B0>]}
[0m00:30:42.617239 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model LISTINGS_LISTINGS.property_value_index .... [[31mERROR[0m in 0.21s]
[0m00:30:42.617239 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m00:30:42.617239 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_second_dbt_model
[0m00:30:42.617239 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.property_value_index' to be skipped because of status 'error'.  Reason: Database Error in model property_value_index (models\example\property_value_index.sql)
  001003 (42000): SQL compilation error:
  syntax error line 43 at position 8 unexpected 'FINAL_VALUE_SCORE'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_value_index.sql.
[0m00:30:42.617239 [info ] [Thread-1 (]: 5 of 5 START sql view model LISTINGS.my_second_dbt_model ....................... [RUN]
[0m00:30:42.617239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_value_index, now model.real_estate_project_dbt.my_second_dbt_model)
[0m00:30:42.617239 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_second_dbt_model
[0m00:30:42.617239 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m00:30:42.617239 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_second_dbt_model
[0m00:30:42.617239 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m00:30:42.617239 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_second_dbt_model"
[0m00:30:42.617239 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_second_dbt_model"} */
create or replace   view REAL_ESTATE.LISTINGS.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from REAL_ESTATE.LISTINGS.my_first_dbt_model
where id = 1
  );
[0m00:30:42.897190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.273 seconds
[0m00:30:42.897190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '653418a1-f28a-4c0f-a421-fa5084c32096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260150A57C0>]}
[0m00:30:42.897190 [info ] [Thread-1 (]: 5 of 5 OK created sql view model LISTINGS.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.28s]
[0m00:30:42.897190 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_second_dbt_model
[0m00:30:42.897190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:30:42.897190 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m00:30:42.912977 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m00:30:43.424659 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m00:30:43.430661 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m00:30:43.654659 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.my_second_dbt_model' was left open.
[0m00:30:43.654659 [debug] [MainThread]: On model.real_estate_project_dbt.my_second_dbt_model: Close
[0m00:30:44.063870 [info ] [MainThread]: 
[0m00:30:44.065888 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 8.30 seconds (8.30s).
[0m00:30:44.071961 [debug] [MainThread]: Command end result
[0m00:30:44.111232 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:30:44.113264 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:30:44.119994 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m00:30:44.119994 [info ] [MainThread]: 
[0m00:30:44.121081 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:30:44.122026 [info ] [MainThread]: 
[0m00:30:44.123028 [error] [MainThread]: [31mFailure in model property_value_index (models\example\property_value_index.sql)[0m
[0m00:30:44.124026 [error] [MainThread]:   Database Error in model property_value_index (models\example\property_value_index.sql)
  001003 (42000): SQL compilation error:
  syntax error line 43 at position 8 unexpected 'FINAL_VALUE_SCORE'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_value_index.sql
[0m00:30:44.125039 [info ] [MainThread]: 
[0m00:30:44.125633 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\property_value_index.sql
[0m00:30:44.125633 [info ] [MainThread]: 
[0m00:30:44.125633 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m00:30:44.130436 [debug] [MainThread]: Command `dbt run` failed at 00:30:44.130436 after 10.89 seconds
[0m00:30:44.130436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260020589B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026001DF3680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002607F520830>]}
[0m00:30:44.131422 [debug] [MainThread]: Flushing usage events
[0m00:30:45.657315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:33:25.971660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002602A8BB9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002602D2C91F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002602D2CAEA0>]}


============================== 00:33:25.971660 | 5a4b6de7-7d99-47ec-94d8-f169e296cf8d ==============================
[0m00:33:25.971660 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:33:25.971660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:33:27.113955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a4b6de7-7d99-47ec-94d8-f169e296cf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002603E7B32C0>]}
[0m00:33:27.208913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a4b6de7-7d99-47ec-94d8-f169e296cf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002603FA99A00>]}
[0m00:33:27.208913 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:33:27.645339 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:33:27.819712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:33:27.819712 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\property_value_index.sql
[0m00:33:28.178826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a4b6de7-7d99-47ec-94d8-f169e296cf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002603D150FE0>]}
[0m00:33:28.321405 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:33:28.321405 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:33:28.354245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a4b6de7-7d99-47ec-94d8-f169e296cf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002603FFF2CF0>]}
[0m00:33:28.354245 [info ] [MainThread]: Found 5 models, 4 data tests, 476 macros
[0m00:33:28.354245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a4b6de7-7d99-47ec-94d8-f169e296cf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260400A0920>]}
[0m00:33:28.359045 [info ] [MainThread]: 
[0m00:33:28.359045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:33:28.359045 [info ] [MainThread]: 
[0m00:33:28.359045 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:33:28.365864 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m00:33:28.443473 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:33:28.444473 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:33:28.444473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:29.749730 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.317 seconds
[0m00:33:29.773060 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:33:29.774052 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:33:29.897230 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.130 seconds
[0m00:33:29.897230 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m00:33:29.929465 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:33:29.929465 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:33:29.929465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:30.887894 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.954 seconds
[0m00:33:30.887894 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:33:30.887894 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m00:33:31.043413 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.146 seconds
[0m00:33:31.046378 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:33:31.046378 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:33:31.164810 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m00:33:31.164810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTINGS)
[0m00:33:31.164810 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:33:31.164810 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:33:31.290084 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.129 seconds
[0m00:33:31.306032 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:33:31.306032 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m00:33:31.463542 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.152 seconds
[0m00:33:31.465550 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:33:31.465550 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:33:31.580523 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.128 seconds
[0m00:33:31.596702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a4b6de7-7d99-47ec-94d8-f169e296cf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026027240D40>]}
[0m00:33:31.596702 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m00:33:31.596702 [info ] [Thread-1 (]: 1 of 5 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m00:33:31.612407 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m00:33:31.612407 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m00:33:31.612407 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:33:31.612407 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m00:33:31.648269 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:33:31.648269 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m00:33:31.648269 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m00:33:31.648269 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:33:32.622817 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.968 seconds
[0m00:33:32.648434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a4b6de7-7d99-47ec-94d8-f169e296cf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002602A9DA2D0>]}
[0m00:33:32.648434 [info ] [Thread-1 (]: 1 of 5 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.02s]
[0m00:33:32.648434 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m00:33:32.648434 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_first_dbt_model
[0m00:33:32.648434 [info ] [Thread-1 (]: 2 of 5 START sql table model LISTINGS.my_first_dbt_model ....................... [RUN]
[0m00:33:32.648434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.my_first_dbt_model)
[0m00:33:32.648434 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_first_dbt_model
[0m00:33:32.654136 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m00:33:32.656141 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_first_dbt_model
[0m00:33:32.682369 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m00:33:32.684368 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_first_dbt_model"
[0m00:33:32.685377 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_first_dbt_model"} */
create or replace transient table REAL_ESTATE.LISTINGS.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m00:33:33.534901 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.850 seconds
[0m00:33:33.538832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a4b6de7-7d99-47ec-94d8-f169e296cf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260405DF710>]}
[0m00:33:33.538832 [info ] [Thread-1 (]: 2 of 5 OK created sql table model LISTINGS.my_first_dbt_model .................. [[32mSUCCESS 1[0m in 0.89s]
[0m00:33:33.538832 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_first_dbt_model
[0m00:33:33.538832 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m00:33:33.538832 [info ] [Thread-1 (]: 3 of 5 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m00:33:33.538832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.my_first_dbt_model, now model.real_estate_project_dbt.property_distribution)
[0m00:33:33.538832 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m00:33:33.546879 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m00:33:33.546879 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m00:33:33.553803 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m00:33:33.556350 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m00:33:33.556350 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m00:33:34.489742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.939 seconds
[0m00:33:34.489742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a4b6de7-7d99-47ec-94d8-f169e296cf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026040629CA0>]}
[0m00:33:34.489742 [info ] [Thread-1 (]: 3 of 5 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 0.95s]
[0m00:33:34.489742 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m00:33:34.489742 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m00:33:34.489742 [info ] [Thread-1 (]: 4 of 5 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m00:33:34.489742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_value_index)
[0m00:33:34.489742 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m00:33:34.507481 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m00:33:34.507481 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m00:33:34.511490 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m00:33:34.511490 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m00:33:34.513496 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
    PROP_ID,
    CLEAN_CITY_NAME,
    PRICE,
    AGE,
    TOTAL_FLOOR,
    BEDROOM_NUM,


    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,


    1-PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

FROM REAL_ESATE.LISTINGS.LISTINGS_CLEANED

),


scored AS (
    SELECT
      *,
      ROUND(
        0.4 * PRICE_score +
        0.2 * AGE_SCORE +
        0.2 * FLOOR_SCORE +
        0.2 * BEDROOM_SCORE, 4
    
      ) AS FINAL_VALUE_SCORE

    FROM ranked
)

SELECT * FROM scored
ORDER BY FINAL_VALUE_SCORE DESC
  );
[0m00:33:34.630986 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd23b7-3201-b728-0000-000e0472f1f9
[0m00:33:34.630986 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'REAL_ESATE' does not exist or not authorized.
[0m00:33:34.647052 [debug] [Thread-1 (]: Database Error in model property_value_index (models\example\property_value_index.sql)
  002003 (02000): SQL compilation error:
  Database 'REAL_ESATE' does not exist or not authorized.
  compiled code at target\run\real_estate_project_dbt\models\example\property_value_index.sql
[0m00:33:34.647052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a4b6de7-7d99-47ec-94d8-f169e296cf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604050AE40>]}
[0m00:33:34.647052 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model LISTINGS_LISTINGS.property_value_index .... [[31mERROR[0m in 0.16s]
[0m00:33:34.647052 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m00:33:34.647052 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_second_dbt_model
[0m00:33:34.647052 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.property_value_index' to be skipped because of status 'error'.  Reason: Database Error in model property_value_index (models\example\property_value_index.sql)
  002003 (02000): SQL compilation error:
  Database 'REAL_ESATE' does not exist or not authorized.
  compiled code at target\run\real_estate_project_dbt\models\example\property_value_index.sql.
[0m00:33:34.647052 [info ] [Thread-1 (]: 5 of 5 START sql view model LISTINGS.my_second_dbt_model ....................... [RUN]
[0m00:33:34.662711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_value_index, now model.real_estate_project_dbt.my_second_dbt_model)
[0m00:33:34.663731 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_second_dbt_model
[0m00:33:34.667644 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m00:33:34.667644 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_second_dbt_model
[0m00:33:34.667644 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m00:33:34.667644 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_second_dbt_model"
[0m00:33:34.667644 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_second_dbt_model"} */
create or replace   view REAL_ESTATE.LISTINGS.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from REAL_ESTATE.LISTINGS.my_first_dbt_model
where id = 1
  );
[0m00:33:34.878963 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.206 seconds
[0m00:33:34.878963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a4b6de7-7d99-47ec-94d8-f169e296cf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026040639A30>]}
[0m00:33:34.878963 [info ] [Thread-1 (]: 5 of 5 OK created sql view model LISTINGS.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.22s]
[0m00:33:34.878963 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_second_dbt_model
[0m00:33:34.878963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:34.878963 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m00:33:34.878963 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m00:33:35.063018 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS' was left open.
[0m00:33:35.063018 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS: Close
[0m00:33:35.274297 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.my_second_dbt_model' was left open.
[0m00:33:35.276295 [debug] [MainThread]: On model.real_estate_project_dbt.my_second_dbt_model: Close
[0m00:33:35.460019 [info ] [MainThread]: 
[0m00:33:35.460019 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 7.10 seconds (7.10s).
[0m00:33:35.460019 [debug] [MainThread]: Command end result
[0m00:33:35.500730 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:33:35.500730 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:33:35.513593 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m00:33:35.514134 [info ] [MainThread]: 
[0m00:33:35.514709 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:33:35.515537 [info ] [MainThread]: 
[0m00:33:35.516645 [error] [MainThread]: [31mFailure in model property_value_index (models\example\property_value_index.sql)[0m
[0m00:33:35.517756 [error] [MainThread]:   Database Error in model property_value_index (models\example\property_value_index.sql)
  002003 (02000): SQL compilation error:
  Database 'REAL_ESATE' does not exist or not authorized.
  compiled code at target\run\real_estate_project_dbt\models\example\property_value_index.sql
[0m00:33:35.518322 [info ] [MainThread]: 
[0m00:33:35.519439 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\property_value_index.sql
[0m00:33:35.520211 [info ] [MainThread]: 
[0m00:33:35.521294 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m00:33:35.523072 [debug] [MainThread]: Command `dbt run` failed at 00:33:35.523072 after 9.76 seconds
[0m00:33:35.524151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002603E3C4A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002602D3C7EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002603DD15E80>]}
[0m00:33:35.524700 [debug] [MainThread]: Flushing usage events
[0m00:33:36.984590 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:35:07.700645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCC3BB1460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCC70BDC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCC70BFC20>]}


============================== 00:35:07.700645 | 4792cf2b-32b0-45b4-96e5-c9648582923c ==============================
[0m00:35:07.700645 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:35:07.700645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:35:11.183348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4792cf2b-32b0-45b4-96e5-c9648582923c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCC5AF7170>]}
[0m00:35:11.294625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4792cf2b-32b0-45b4-96e5-c9648582923c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCD7095D60>]}
[0m00:35:11.294625 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:35:11.841005 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:35:13.042555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:35:13.042555 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:35:13.074096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4792cf2b-32b0-45b4-96e5-c9648582923c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCD91FA000>]}
[0m00:35:13.156585 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:35:13.174630 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:35:13.212431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4792cf2b-32b0-45b4-96e5-c9648582923c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCD94F7F80>]}
[0m00:35:13.212431 [info ] [MainThread]: Found 5 models, 4 data tests, 476 macros
[0m00:35:13.217686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4792cf2b-32b0-45b4-96e5-c9648582923c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCD92E7140>]}
[0m00:35:13.221778 [info ] [MainThread]: 
[0m00:35:13.223788 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:35:13.223788 [info ] [MainThread]: 
[0m00:35:13.225797 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:35:13.231817 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m00:35:15.523990 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:35:15.523990 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:35:15.523990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:35:16.931905 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.409 seconds
[0m00:35:16.939946 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:35:16.940956 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:35:17.093635 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.149 seconds
[0m00:35:17.103508 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS'
[0m00:35:17.125832 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:35:17.125832 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:35:17.125832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:35:18.199670 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.081 seconds
[0m00:35:18.215820 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:35:18.215820 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m00:35:18.348773 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.133 seconds
[0m00:35:18.352839 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:35:18.352839 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:35:18.490104 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.136 seconds
[0m00:35:18.490104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS, now list_REAL_ESTATE_LISTINGS_LISTINGS)
[0m00:35:18.490104 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:35:18.506029 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:35:18.634614 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.136 seconds
[0m00:35:18.634614 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:35:18.634614 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m00:35:18.842868 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.194 seconds
[0m00:35:18.842868 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:35:18.842868 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:35:18.976784 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.130 seconds
[0m00:35:18.976784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4792cf2b-32b0-45b4-96e5-c9648582923c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCC4130920>]}
[0m00:35:18.976784 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m00:35:18.976784 [info ] [Thread-1 (]: 1 of 5 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m00:35:18.976784 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m00:35:18.976784 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m00:35:19.059243 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:35:19.060245 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m00:35:19.092067 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:35:19.092067 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m00:35:19.092067 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m00:35:19.092067 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:35:20.187399 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.098 seconds
[0m00:35:20.219339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4792cf2b-32b0-45b4-96e5-c9648582923c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCC630BD70>]}
[0m00:35:20.219339 [info ] [Thread-1 (]: 1 of 5 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.24s]
[0m00:35:20.219339 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m00:35:20.219339 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_first_dbt_model
[0m00:35:20.219339 [info ] [Thread-1 (]: 2 of 5 START sql table model LISTINGS.my_first_dbt_model ....................... [RUN]
[0m00:35:20.219339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.my_first_dbt_model)
[0m00:35:20.219339 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_first_dbt_model
[0m00:35:20.219339 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m00:35:20.219339 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_first_dbt_model
[0m00:35:20.262325 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m00:35:20.276795 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_first_dbt_model"
[0m00:35:20.278067 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_first_dbt_model"} */
create or replace transient table REAL_ESTATE.LISTINGS.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m00:35:21.566695 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.288 seconds
[0m00:35:21.570180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4792cf2b-32b0-45b4-96e5-c9648582923c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCD91FA060>]}
[0m00:35:21.570180 [info ] [Thread-1 (]: 2 of 5 OK created sql table model LISTINGS.my_first_dbt_model .................. [[32mSUCCESS 1[0m in 1.35s]
[0m00:35:21.570180 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_first_dbt_model
[0m00:35:21.570180 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m00:35:21.570180 [info ] [Thread-1 (]: 3 of 5 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m00:35:21.570180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.my_first_dbt_model, now model.real_estate_project_dbt.property_distribution)
[0m00:35:21.570180 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m00:35:21.570180 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m00:35:21.570180 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m00:35:21.570180 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m00:35:21.570180 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m00:35:21.570180 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m00:35:23.213069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.635 seconds
[0m00:35:23.213069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4792cf2b-32b0-45b4-96e5-c9648582923c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCD91F9D60>]}
[0m00:35:23.213069 [info ] [Thread-1 (]: 3 of 5 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 1.64s]
[0m00:35:23.213069 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m00:35:23.213069 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m00:35:23.213069 [info ] [Thread-1 (]: 4 of 5 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m00:35:23.226731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_value_index)
[0m00:35:23.226731 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m00:35:23.230768 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m00:35:23.230768 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m00:35:23.230768 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m00:35:23.230768 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m00:35:23.230768 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
    PROP_ID,
    CLEAN_CITY_NAME,
    PRICE,
    AGE,
    TOTAL_FLOOR,
    BEDROOM_NUM,


    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,


    1-PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

FROM REAL_ESATE.LISTINGS.LISTINGS_CLEANED

),


scored AS (
    SELECT
      *,
      ROUND(
        0.4 * PRICE_score +
        0.2 * AGE_SCORE +
        0.2 * FLOOR_SCORE +
        0.2 * BEDROOM_SCORE, 4
    
      ) AS FINAL_VALUE_SCORE

    FROM ranked
)

SELECT * FROM scored
ORDER BY FINAL_VALUE_SCORE DESC
  );
[0m00:35:23.525978 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd23b9-3201-b728-0000-000e0472f22d
[0m00:35:23.527984 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'REAL_ESATE' does not exist or not authorized.
[0m00:35:23.538799 [debug] [Thread-1 (]: Database Error in model property_value_index (models\example\property_value_index.sql)
  002003 (02000): SQL compilation error:
  Database 'REAL_ESATE' does not exist or not authorized.
  compiled code at target\run\real_estate_project_dbt\models\example\property_value_index.sql
[0m00:35:23.549617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4792cf2b-32b0-45b4-96e5-c9648582923c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCD9B66F30>]}
[0m00:35:23.549617 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model LISTINGS_LISTINGS.property_value_index .... [[31mERROR[0m in 0.32s]
[0m00:35:23.549617 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m00:35:23.549617 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_second_dbt_model
[0m00:35:23.549617 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.property_value_index' to be skipped because of status 'error'.  Reason: Database Error in model property_value_index (models\example\property_value_index.sql)
  002003 (02000): SQL compilation error:
  Database 'REAL_ESATE' does not exist or not authorized.
  compiled code at target\run\real_estate_project_dbt\models\example\property_value_index.sql.
[0m00:35:23.549617 [info ] [Thread-1 (]: 5 of 5 START sql view model LISTINGS.my_second_dbt_model ....................... [RUN]
[0m00:35:23.549617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_value_index, now model.real_estate_project_dbt.my_second_dbt_model)
[0m00:35:23.549617 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_second_dbt_model
[0m00:35:23.549617 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m00:35:23.549617 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_second_dbt_model
[0m00:35:23.569647 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m00:35:23.572061 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_second_dbt_model"
[0m00:35:23.574072 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_second_dbt_model"} */
create or replace   view REAL_ESTATE.LISTINGS.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from REAL_ESTATE.LISTINGS.my_first_dbt_model
where id = 1
  );
[0m00:35:24.050404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m00:35:24.050404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4792cf2b-32b0-45b4-96e5-c9648582923c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCD9B1F890>]}
[0m00:35:24.050404 [info ] [Thread-1 (]: 5 of 5 OK created sql view model LISTINGS.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.50s]
[0m00:35:24.050404 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_second_dbt_model
[0m00:35:24.050404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:35:24.050404 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m00:35:24.050404 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m00:35:24.277679 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m00:35:24.277679 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m00:35:24.486068 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.my_second_dbt_model' was left open.
[0m00:35:24.486068 [debug] [MainThread]: On model.real_estate_project_dbt.my_second_dbt_model: Close
[0m00:35:24.695252 [info ] [MainThread]: 
[0m00:35:24.695252 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 11.47 seconds (11.47s).
[0m00:35:24.695252 [debug] [MainThread]: Command end result
[0m00:35:24.732812 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:35:24.732812 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:35:24.748566 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m00:35:24.748566 [info ] [MainThread]: 
[0m00:35:24.748566 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:35:24.748566 [info ] [MainThread]: 
[0m00:35:24.748566 [error] [MainThread]: [31mFailure in model property_value_index (models\example\property_value_index.sql)[0m
[0m00:35:24.748566 [error] [MainThread]:   Database Error in model property_value_index (models\example\property_value_index.sql)
  002003 (02000): SQL compilation error:
  Database 'REAL_ESATE' does not exist or not authorized.
  compiled code at target\run\real_estate_project_dbt\models\example\property_value_index.sql
[0m00:35:24.748566 [info ] [MainThread]: 
[0m00:35:24.748566 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\property_value_index.sql
[0m00:35:24.748566 [info ] [MainThread]: 
[0m00:35:24.748566 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m00:35:24.748566 [debug] [MainThread]: Command `dbt run` failed at 00:35:24.748566 after 17.28 seconds
[0m00:35:24.758139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCC3BB1460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCD9302D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCC6D70A70>]}
[0m00:35:24.758139 [debug] [MainThread]: Flushing usage events
[0m00:35:26.260092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:37:04.593997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB90F91460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB939EFE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB93AAD040>]}


============================== 00:37:04.593997 | 0ced052a-2bcf-4bd5-a553-d048b5ed3ae2 ==============================
[0m00:37:04.593997 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:37:04.593997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:37:05.822156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ced052a-2bcf-4bd5-a553-d048b5ed3ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA6122AB0>]}
[0m00:37:05.933215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ced052a-2bcf-4bd5-a553-d048b5ed3ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA389D7F0>]}
[0m00:37:05.933215 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:37:06.365794 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:37:06.536674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:37:06.536674 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\property_value_index.sql
[0m00:37:06.917547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ced052a-2bcf-4bd5-a553-d048b5ed3ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA624A480>]}
[0m00:37:07.069847 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:37:07.069847 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:37:07.101847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ced052a-2bcf-4bd5-a553-d048b5ed3ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA671A5D0>]}
[0m00:37:07.101847 [info ] [MainThread]: Found 5 models, 4 data tests, 476 macros
[0m00:37:07.101847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ced052a-2bcf-4bd5-a553-d048b5ed3ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB93369340>]}
[0m00:37:07.101847 [info ] [MainThread]: 
[0m00:37:07.101847 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:37:07.101847 [info ] [MainThread]: 
[0m00:37:07.101847 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:37:07.101847 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m00:37:07.188387 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:37:07.188387 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:37:07.188387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:08.451974 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.255 seconds
[0m00:37:08.464389 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:37:08.466447 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:37:08.592593 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.125 seconds
[0m00:37:08.601440 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS'
[0m00:37:08.606557 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:37:08.606557 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:37:08.606557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:09.545364 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.938 seconds
[0m00:37:09.561066 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:37:09.561066 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m00:37:09.718937 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.154 seconds
[0m00:37:09.724998 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:37:09.727018 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:37:09.836005 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.117 seconds
[0m00:37:09.836005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS, now list_REAL_ESTATE_LISTINGS_LISTINGS)
[0m00:37:09.851121 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:37:09.851121 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:37:09.978412 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.127 seconds
[0m00:37:09.978412 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:37:09.978412 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m00:37:10.106977 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.128 seconds
[0m00:37:10.106977 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:37:10.106977 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:37:10.234129 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.114 seconds
[0m00:37:10.243796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ced052a-2bcf-4bd5-a553-d048b5ed3ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA69D5430>]}
[0m00:37:10.255969 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m00:37:10.255969 [info ] [Thread-1 (]: 1 of 5 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m00:37:10.255969 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m00:37:10.255969 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m00:37:10.271252 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:37:10.272330 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m00:37:10.290617 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:37:10.290617 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m00:37:10.305808 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m00:37:10.306389 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:37:11.396139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.096 seconds
[0m00:37:11.423238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ced052a-2bcf-4bd5-a553-d048b5ed3ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB9112A510>]}
[0m00:37:11.423238 [info ] [Thread-1 (]: 1 of 5 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.17s]
[0m00:37:11.423238 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m00:37:11.423238 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_first_dbt_model
[0m00:37:11.423238 [info ] [Thread-1 (]: 2 of 5 START sql table model LISTINGS.my_first_dbt_model ....................... [RUN]
[0m00:37:11.423238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.my_first_dbt_model)
[0m00:37:11.423238 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_first_dbt_model
[0m00:37:11.423238 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m00:37:11.423238 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_first_dbt_model
[0m00:37:11.463445 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_first_dbt_model"
[0m00:37:11.465390 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_first_dbt_model"
[0m00:37:11.466430 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_first_dbt_model"} */
create or replace transient table REAL_ESTATE.LISTINGS.my_first_dbt_model
    

    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
;
[0m00:37:12.240548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.787 seconds
[0m00:37:12.257174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ced052a-2bcf-4bd5-a553-d048b5ed3ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA6CEB7D0>]}
[0m00:37:12.257174 [info ] [Thread-1 (]: 2 of 5 OK created sql table model LISTINGS.my_first_dbt_model .................. [[32mSUCCESS 1[0m in 0.83s]
[0m00:37:12.257174 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_first_dbt_model
[0m00:37:12.257174 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m00:37:12.257174 [info ] [Thread-1 (]: 3 of 5 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m00:37:12.257174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.my_first_dbt_model, now model.real_estate_project_dbt.property_distribution)
[0m00:37:12.257174 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m00:37:12.273315 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m00:37:12.274300 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m00:37:12.280530 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m00:37:12.282476 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m00:37:12.283530 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m00:37:13.275433 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.993 seconds
[0m00:37:13.275433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ced052a-2bcf-4bd5-a553-d048b5ed3ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA6CF8BF0>]}
[0m00:37:13.275433 [info ] [Thread-1 (]: 3 of 5 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 1.02s]
[0m00:37:13.275433 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m00:37:13.275433 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m00:37:13.275433 [info ] [Thread-1 (]: 4 of 5 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m00:37:13.275433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_value_index)
[0m00:37:13.275433 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m00:37:13.275433 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m00:37:13.275433 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m00:37:13.290410 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m00:37:13.293356 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m00:37:13.293356 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
    PROP_ID,
    CLEAN_CITY_NAME,
    PRICE,
    AGE,
    TOTAL_FLOOR,
    BEDROOM_NUM,


    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,


    1-PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED

),


scored AS (
    SELECT
      *,
      ROUND(
        0.4 * PRICE_score +
        0.2 * AGE_SCORE +
        0.2 * FLOOR_SCORE +
        0.2 * BEDROOM_SCORE, 4
    
      ) AS FINAL_VALUE_SCORE

    FROM ranked
)

SELECT * FROM scored
ORDER BY FINAL_VALUE_SCORE DESC
  );
[0m00:37:13.533188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.241 seconds
[0m00:37:13.533188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ced052a-2bcf-4bd5-a553-d048b5ed3ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA6CF26F0>]}
[0m00:37:13.533188 [info ] [Thread-1 (]: 4 of 5 OK created sql view model LISTINGS_LISTINGS.property_value_index ........ [[32mSUCCESS 1[0m in 0.26s]
[0m00:37:13.533188 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m00:37:13.533188 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.my_second_dbt_model
[0m00:37:13.533188 [info ] [Thread-1 (]: 5 of 5 START sql view model LISTINGS.my_second_dbt_model ....................... [RUN]
[0m00:37:13.533188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_value_index, now model.real_estate_project_dbt.my_second_dbt_model)
[0m00:37:13.533188 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.my_second_dbt_model
[0m00:37:13.552886 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m00:37:13.553967 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.my_second_dbt_model
[0m00:37:13.558928 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.my_second_dbt_model"
[0m00:37:13.560022 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.my_second_dbt_model"
[0m00:37:13.561021 [debug] [Thread-1 (]: On model.real_estate_project_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.my_second_dbt_model"} */
create or replace   view REAL_ESTATE.LISTINGS.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from REAL_ESTATE.LISTINGS.my_first_dbt_model
where id = 1
  );
[0m00:37:13.788207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.227 seconds
[0m00:37:13.788207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ced052a-2bcf-4bd5-a553-d048b5ed3ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA6B92DB0>]}
[0m00:37:13.788207 [info ] [Thread-1 (]: 5 of 5 OK created sql view model LISTINGS.my_second_dbt_model .................. [[32mSUCCESS 1[0m in 0.26s]
[0m00:37:13.803924 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.my_second_dbt_model
[0m00:37:13.803924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:37:13.803924 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m00:37:13.803924 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m00:37:13.991071 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m00:37:13.991071 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m00:37:14.171858 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.my_second_dbt_model' was left open.
[0m00:37:14.171858 [debug] [MainThread]: On model.real_estate_project_dbt.my_second_dbt_model: Close
[0m00:37:14.389910 [info ] [MainThread]: 
[0m00:37:14.389910 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 7.29 seconds (7.29s).
[0m00:37:14.389910 [debug] [MainThread]: Command end result
[0m00:37:14.441470 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:37:14.444555 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:37:14.446108 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m00:37:14.446108 [info ] [MainThread]: 
[0m00:37:14.446108 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:37:14.446108 [info ] [MainThread]: 
[0m00:37:14.446108 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m00:37:14.446108 [debug] [MainThread]: Command `dbt run` succeeded at 00:37:14.446108 after 10.08 seconds
[0m00:37:14.446108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB93C7FEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA6ADA000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB93CDA300>]}
[0m00:37:14.446108 [debug] [MainThread]: Flushing usage events
[0m00:37:16.075593 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:51:17.003641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F53E2E870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F539EB680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F53D3D310>]}


============================== 23:51:17.014322 | c98959f0-eea7-4b17-bf59-148635ce2e0d ==============================
[0m23:51:17.014322 [info ] [MainThread]: Running with dbt=1.10.1
[0m23:51:17.014322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:51:24.779240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c98959f0-eea7-4b17-bf59-148635ce2e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6633D220>]}
[0m23:51:24.895844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c98959f0-eea7-4b17-bf59-148635ce2e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F5356B9B0>]}
[0m23:51:24.898298 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m23:51:25.942748 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m23:51:28.801201 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 1 files added, 2 files changed.
[0m23:51:28.801201 [debug] [MainThread]: Partial parsing: added file: real_estate_project_dbt://models\example\city_level_aggregates.sql
[0m23:51:28.801201 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\schema.yml
[0m23:51:28.801201 [debug] [MainThread]: Partial parsing: deleted file: real_estate_project_dbt://models\example\my_second_dbt_model.sql
[0m23:51:28.801201 [debug] [MainThread]: Partial parsing: deleted file: real_estate_project_dbt://models\example\my_first_dbt_model.sql
[0m23:51:28.801201 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\property_value_index.sql
[0m23:51:29.335580 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m23:51:29.351366 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m23:51:29.608085 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.real_estate_project_dbt.unique_my_second_dbt_model_id.57a0f8c493' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m23:51:29.608085 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.real_estate_project_dbt.not_null_my_second_dbt_model_id.151b76d778' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m23:51:29.608085 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.real_estate_project_dbt.unique_my_first_dbt_model_id.16e066b321' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m23:51:29.608085 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.real_estate_project_dbt.not_null_my_first_dbt_model_id.5fb22c2710' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m23:51:29.710964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c98959f0-eea7-4b17-bf59-148635ce2e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6628D490>]}
[0m23:51:29.839629 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m23:51:29.871417 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m23:51:30.006298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c98959f0-eea7-4b17-bf59-148635ce2e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F666A0E90>]}
[0m23:51:30.006298 [info ] [MainThread]: Found 4 models, 476 macros
[0m23:51:30.006298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c98959f0-eea7-4b17-bf59-148635ce2e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F66738CE0>]}
[0m23:51:30.018589 [info ] [MainThread]: 
[0m23:51:30.020421 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:51:30.024713 [info ] [MainThread]: 
[0m23:51:30.027899 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:51:30.048277 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m23:51:34.747713 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m23:51:34.749731 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m23:51:34.749731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:38.339806 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.595 seconds
[0m23:51:38.347803 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m23:51:38.395366 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m23:51:38.395366 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:51:38.395366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:39.569557 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.171 seconds
[0m23:51:39.585284 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m23:51:39.585284 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m23:51:39.879590 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.292 seconds
[0m23:51:39.879590 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m23:51:39.879590 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:51:40.064553 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.174 seconds
[0m23:51:40.066565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c98959f0-eea7-4b17-bf59-148635ce2e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F66A61280>]}
[0m23:51:40.099713 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m23:51:40.104412 [info ] [Thread-1 (]: 1 of 4 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m23:51:40.105472 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m23:51:40.108662 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m23:51:40.178712 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m23:51:40.181275 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m23:51:40.307504 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m23:51:40.316623 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m23:51:40.316623 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m23:51:40.316623 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:51:41.714058 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.401 seconds
[0m23:51:41.800841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c98959f0-eea7-4b17-bf59-148635ce2e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F5127A3C0>]}
[0m23:51:41.800841 [info ] [Thread-1 (]: 1 of 4 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.69s]
[0m23:51:41.800841 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m23:51:41.800841 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_level_aggregates
[0m23:51:41.809219 [info ] [Thread-1 (]: 2 of 4 START sql view model LISTINGS_LISTINGS.city_level_aggregates ............ [RUN]
[0m23:51:41.811091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.city_level_aggregates)
[0m23:51:41.812770 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_level_aggregates
[0m23:51:41.817549 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_level_aggregates"
[0m23:51:41.817549 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_level_aggregates
[0m23:51:41.832278 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_level_aggregates"
[0m23:51:41.837413 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_level_aggregates"
[0m23:51:41.837413 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_level_aggregates: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_level_aggregates"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates
  
   as (
    


WITH city_levels AS (
    SELECT CLEAN_CITY_NAME AS CITY_NAME,
    COUNT(PROP_ID) AS TOTAL_LISTINGS,
    AVG(PRICE) AS AVG_PRICE,
    MAX(TOTAL_FLOOR) AS MAX_FLOOR,
    AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT * FROM city_levels
  );
[0m23:51:42.128658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.293 seconds
[0m23:51:42.136935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c98959f0-eea7-4b17-bf59-148635ce2e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F66DA6720>]}
[0m23:51:42.136935 [info ] [Thread-1 (]: 2 of 4 OK created sql view model LISTINGS_LISTINGS.city_level_aggregates ....... [[32mSUCCESS 1[0m in 0.33s]
[0m23:51:42.136935 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_level_aggregates
[0m23:51:42.136935 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m23:51:42.136935 [info ] [Thread-1 (]: 3 of 4 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m23:51:42.136935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_level_aggregates, now model.real_estate_project_dbt.property_distribution)
[0m23:51:42.149022 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m23:51:42.154945 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m23:51:42.158641 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m23:51:42.197195 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m23:51:42.213624 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m23:51:42.213624 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m23:51:43.666114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.450 seconds
[0m23:51:43.674182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c98959f0-eea7-4b17-bf59-148635ce2e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F6703F2C0>]}
[0m23:51:43.676197 [info ] [Thread-1 (]: 3 of 4 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 1.54s]
[0m23:51:43.680611 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m23:51:43.680611 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m23:51:43.680611 [info ] [Thread-1 (]: 4 of 4 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m23:51:43.686146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_value_index)
[0m23:51:43.688164 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m23:51:43.697788 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m23:51:43.704667 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m23:51:43.714130 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m23:51:43.730892 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m23:51:43.730892 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
    PROP_ID,
    CLEAN_CITY_NAME,
    PRICE,
    AGE,
    TOTAL_FLOOR,
    BEDROOM_NUM,


    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
    PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,


    1-PERCENT_RANK() OVER(PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED

),


scored AS (
    SELECT
      *,
      ROUND(
        0.4 * PRICE_score +
        0.2 * AGE_SCORE +
        0.2 * FLOOR_SCORE +
        0.2 * BEDROOM_SCORE, 4
    
      ) AS FINAL_VALUE_SCORE

    FROM ranked
)

luxury_tagged AS (
    SELECT
        *,
        NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY final_value_score DESC) AS decile,
        CASE
            WHEN NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY final_value_score DESC) = 1 THEN TRUE
            ELSE FALSE
        END AS is_luxury
    FROM scored
)

SELECT * FROM scored
ORDER BY FINAL_VALUE_SCORE DESC
  );
[0m23:51:44.294086 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd346d-3201-b7cb-000e-04720001317a
[0m23:51:44.294086 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 42 at position 0 unexpected 'luxury_tagged'.
syntax error line 45 at position 18 unexpected 'OVER'.
[0m23:51:44.329036 [debug] [Thread-1 (]: Database Error in model property_value_index (models\example\property_value_index.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 0 unexpected 'luxury_tagged'.
  syntax error line 45 at position 18 unexpected 'OVER'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_value_index.sql
[0m23:51:44.331048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c98959f0-eea7-4b17-bf59-148635ce2e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F66826660>]}
[0m23:51:44.333061 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model LISTINGS_LISTINGS.property_value_index .... [[31mERROR[0m in 0.64s]
[0m23:51:44.333061 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m23:51:44.336727 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.property_value_index' to be skipped because of status 'error'.  Reason: Database Error in model property_value_index (models\example\property_value_index.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 0 unexpected 'luxury_tagged'.
  syntax error line 45 at position 18 unexpected 'OVER'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_value_index.sql.
[0m23:51:44.339255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:44.343394 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m23:51:44.343394 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m23:51:44.589536 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m23:51:44.591557 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m23:51:44.845246 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.property_value_index' was left open.
[0m23:51:44.847268 [debug] [MainThread]: On model.real_estate_project_dbt.property_value_index: Close
[0m23:51:45.045040 [info ] [MainThread]: 
[0m23:51:45.047058 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 15.02 seconds (15.02s).
[0m23:51:45.051081 [debug] [MainThread]: Command end result
[0m23:51:45.140582 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m23:51:45.145549 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m23:51:45.156756 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m23:51:45.156756 [info ] [MainThread]: 
[0m23:51:45.156756 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:51:45.160423 [info ] [MainThread]: 
[0m23:51:45.160423 [error] [MainThread]: [31mFailure in model property_value_index (models\example\property_value_index.sql)[0m
[0m23:51:45.160423 [error] [MainThread]:   Database Error in model property_value_index (models\example\property_value_index.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 0 unexpected 'luxury_tagged'.
  syntax error line 45 at position 18 unexpected 'OVER'.
  compiled code at target\run\real_estate_project_dbt\models\example\property_value_index.sql
[0m23:51:45.163528 [info ] [MainThread]: 
[0m23:51:45.165050 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\property_value_index.sql
[0m23:51:45.165712 [info ] [MainThread]: 
[0m23:51:45.165712 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m23:51:45.169275 [debug] [MainThread]: Command `dbt run` failed at 23:51:45.169275 after 28.49 seconds
[0m23:51:45.169275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F53F988F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F66A27DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F535691C0>]}
[0m23:51:45.171284 [debug] [MainThread]: Flushing usage events
[0m23:51:46.521696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:54:28.294224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA204D7F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA23330E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA22F821E0>]}


============================== 23:54:28.308209 | 4470dea1-4abc-4e31-ac1b-85aa9c09f2df ==============================
[0m23:54:28.308209 [info ] [MainThread]: Running with dbt=1.10.1
[0m23:54:28.308209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:54:30.570043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4470dea1-4abc-4e31-ac1b-85aa9c09f2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA23276B40>]}
[0m23:54:30.680217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4470dea1-4abc-4e31-ac1b-85aa9c09f2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA20C485F0>]}
[0m23:54:30.692630 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m23:54:31.216235 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m23:54:31.565558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:54:31.565558 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\property_value_index.sql
[0m23:54:31.994800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4470dea1-4abc-4e31-ac1b-85aa9c09f2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA362D5460>]}
[0m23:54:32.233751 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m23:54:32.250563 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m23:54:32.314908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4470dea1-4abc-4e31-ac1b-85aa9c09f2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA36112600>]}
[0m23:54:32.314908 [info ] [MainThread]: Found 4 models, 476 macros
[0m23:54:32.318899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4470dea1-4abc-4e31-ac1b-85aa9c09f2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA3613B500>]}
[0m23:54:32.320632 [info ] [MainThread]: 
[0m23:54:32.320632 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:54:32.328465 [info ] [MainThread]: 
[0m23:54:32.330899 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:54:32.348755 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m23:54:32.505577 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m23:54:32.505577 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m23:54:32.505577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:34.214782 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.705 seconds
[0m23:54:34.226276 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m23:54:34.264815 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m23:54:34.264815 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:54:34.264815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:35.533134 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.266 seconds
[0m23:54:35.543335 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m23:54:35.547551 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m23:54:35.678355 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.128 seconds
[0m23:54:35.684674 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m23:54:35.686042 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:54:35.817581 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.132 seconds
[0m23:54:35.826920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4470dea1-4abc-4e31-ac1b-85aa9c09f2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA362D21E0>]}
[0m23:54:35.833410 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m23:54:35.843371 [info ] [Thread-1 (]: 1 of 4 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m23:54:35.849535 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m23:54:35.851590 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m23:54:35.876804 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m23:54:35.884250 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m23:54:35.981798 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m23:54:35.981798 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m23:54:35.990131 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m23:54:35.990131 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:54:37.394674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.412 seconds
[0m23:54:37.486316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4470dea1-4abc-4e31-ac1b-85aa9c09f2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA20ADA330>]}
[0m23:54:37.486316 [info ] [Thread-1 (]: 1 of 4 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.62s]
[0m23:54:37.492483 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m23:54:37.492483 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_level_aggregates
[0m23:54:37.494501 [info ] [Thread-1 (]: 2 of 4 START sql view model LISTINGS_LISTINGS.city_level_aggregates ............ [RUN]
[0m23:54:37.494501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.city_level_aggregates)
[0m23:54:37.499950 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_level_aggregates
[0m23:54:37.508847 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_level_aggregates"
[0m23:54:37.513895 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_level_aggregates
[0m23:54:37.517044 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_level_aggregates"
[0m23:54:37.526324 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_level_aggregates"
[0m23:54:37.530952 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_level_aggregates: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_level_aggregates"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates
  
   as (
    


WITH city_levels AS (
    SELECT CLEAN_CITY_NAME AS CITY_NAME,
    COUNT(PROP_ID) AS TOTAL_LISTINGS,
    AVG(PRICE) AS AVG_PRICE,
    MAX(TOTAL_FLOOR) AS MAX_FLOOR,
    AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT * FROM city_levels
  );
[0m23:54:37.849762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.319 seconds
[0m23:54:37.849762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4470dea1-4abc-4e31-ac1b-85aa9c09f2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA366F4C20>]}
[0m23:54:37.849762 [info ] [Thread-1 (]: 2 of 4 OK created sql view model LISTINGS_LISTINGS.city_level_aggregates ....... [[32mSUCCESS 1[0m in 0.36s]
[0m23:54:37.867071 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_level_aggregates
[0m23:54:37.867071 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m23:54:37.870063 [info ] [Thread-1 (]: 3 of 4 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m23:54:37.873235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_level_aggregates, now model.real_estate_project_dbt.property_distribution)
[0m23:54:37.876808 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m23:54:37.886881 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m23:54:37.892386 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m23:54:38.009304 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m23:54:38.017038 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m23:54:38.019163 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m23:54:39.233624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.212 seconds
[0m23:54:39.233624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4470dea1-4abc-4e31-ac1b-85aa9c09f2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA366FFDA0>]}
[0m23:54:39.233624 [info ] [Thread-1 (]: 3 of 4 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 1.36s]
[0m23:54:39.247821 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m23:54:39.249558 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m23:54:39.249558 [info ] [Thread-1 (]: 4 of 4 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m23:54:39.249558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_value_index)
[0m23:54:39.256487 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m23:54:39.270895 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m23:54:39.280266 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m23:54:39.292748 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m23:54:39.295202 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m23:54:39.295202 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
        PROP_ID,
        CLEAN_CITY_NAME,
        PRICE,
        AGE,
        TOTAL_FLOOR,
        BEDROOM_NUM,

        -- Score calculations
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,
        1 - PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

scored AS (
    SELECT
        *,
        ROUND(
            0.4 * PRICE_SCORE +
            0.2 * AGE_SCORE +
            0.2 * FLOOR_SCORE +
            0.2 * BEDROOM_SCORE, 4
        ) AS FINAL_VALUE_SCORE
    FROM ranked
),

-- ✅ Only call NTILE(10) once and reuse it
luxury_tagged AS (
    SELECT
        *,
        NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY FINAL_VALUE_SCORE DESC) AS decile
    FROM scored
)

SELECT
    *,
    CASE
        WHEN decile = 1 THEN TRUE
        ELSE FALSE
    END AS IS_LUXURY
FROM luxury_tagged
ORDER BY CLEAN_CITY_NAME, FINAL_VALUE_SCORE DESC
  );
[0m23:54:39.591263 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.286 seconds
[0m23:54:39.591263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4470dea1-4abc-4e31-ac1b-85aa9c09f2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA36645BB0>]}
[0m23:54:39.591263 [info ] [Thread-1 (]: 4 of 4 OK created sql view model LISTINGS_LISTINGS.property_value_index ........ [[32mSUCCESS 1[0m in 0.34s]
[0m23:54:39.608997 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m23:54:39.613355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:39.613355 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m23:54:39.613355 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m23:54:39.849983 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m23:54:39.849983 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m23:54:40.105781 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.property_value_index' was left open.
[0m23:54:40.105781 [debug] [MainThread]: On model.real_estate_project_dbt.property_value_index: Close
[0m23:54:40.313444 [info ] [MainThread]: 
[0m23:54:40.313444 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 7.98 seconds (7.98s).
[0m23:54:40.318028 [debug] [MainThread]: Command end result
[0m23:54:40.420420 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m23:54:40.427046 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m23:54:40.453877 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m23:54:40.455171 [info ] [MainThread]: 
[0m23:54:40.458011 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:40.459942 [info ] [MainThread]: 
[0m23:54:40.462604 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m23:54:40.467511 [debug] [MainThread]: Command `dbt run` succeeded at 23:54:40.466908 after 12.55 seconds
[0m23:54:40.468769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2384C5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA22447DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA362B34A0>]}
[0m23:54:40.470360 [debug] [MainThread]: Flushing usage events
[0m23:54:42.248808 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:57:04.197870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022546AAEA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022546AAEAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022546AAEA50>]}


============================== 23:57:04.197870 | 919b549d-adee-4adf-8a29-72f0de889ddd ==============================
[0m23:57:04.197870 [info ] [MainThread]: Running with dbt=1.10.1
[0m23:57:04.197870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:57:06.110623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '919b549d-adee-4adf-8a29-72f0de889ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225460E5E20>]}
[0m23:57:06.220951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '919b549d-adee-4adf-8a29-72f0de889ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022558E58B90>]}
[0m23:57:06.220951 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m23:57:06.817302 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m23:57:07.115730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:57:07.115730 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\city_level_aggregates.sql
[0m23:57:07.573231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '919b549d-adee-4adf-8a29-72f0de889ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002255955D8B0>]}
[0m23:57:07.821147 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m23:57:07.825171 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m23:57:07.884992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '919b549d-adee-4adf-8a29-72f0de889ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002255936D010>]}
[0m23:57:07.884992 [info ] [MainThread]: Found 4 models, 476 macros
[0m23:57:07.884992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '919b549d-adee-4adf-8a29-72f0de889ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022559557E90>]}
[0m23:57:07.901047 [info ] [MainThread]: 
[0m23:57:07.902876 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:57:07.904633 [info ] [MainThread]: 
[0m23:57:07.905818 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:57:07.920253 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m23:57:08.140553 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m23:57:08.148720 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m23:57:08.150067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:10.071075 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.922 seconds
[0m23:57:10.083759 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m23:57:10.118664 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m23:57:10.118664 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:57:10.118664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:11.297692 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.166 seconds
[0m23:57:11.309234 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m23:57:11.316334 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m23:57:11.503116 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.186 seconds
[0m23:57:11.503116 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m23:57:11.503116 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m23:57:11.632175 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.129 seconds
[0m23:57:11.648357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '919b549d-adee-4adf-8a29-72f0de889ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002254602BAA0>]}
[0m23:57:11.664477 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m23:57:11.664477 [info ] [Thread-1 (]: 1 of 4 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m23:57:11.664477 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m23:57:11.664477 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m23:57:11.702376 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m23:57:11.702376 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m23:57:11.802918 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m23:57:11.802918 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m23:57:11.802918 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m23:57:11.817110 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:57:13.116488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.302 seconds
[0m23:57:13.190401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '919b549d-adee-4adf-8a29-72f0de889ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022559750C50>]}
[0m23:57:13.206448 [info ] [Thread-1 (]: 1 of 4 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.53s]
[0m23:57:13.206448 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m23:57:13.206448 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_level_aggregates
[0m23:57:13.206448 [info ] [Thread-1 (]: 2 of 4 START sql table model LISTINGS_LISTINGS.city_level_aggregates ........... [RUN]
[0m23:57:13.206448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.city_level_aggregates)
[0m23:57:13.217612 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_level_aggregates
[0m23:57:13.227728 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_level_aggregates"
[0m23:57:13.231894 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_level_aggregates
[0m23:57:13.267548 [debug] [Thread-1 (]:  adapter: Dropping relation "REAL_ESTATE"."LISTINGS_LISTINGS"."CITY_LEVEL_AGGREGATES" because it is a view and target relation REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates is of type table.
[0m23:57:13.290842 [debug] [Thread-1 (]: Applying DROP to: "REAL_ESTATE"."LISTINGS_LISTINGS"."CITY_LEVEL_AGGREGATES"
[0m23:57:13.307125 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_level_aggregates"
[0m23:57:13.307125 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_level_aggregates: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_level_aggregates"} */
drop view if exists "REAL_ESTATE"."LISTINGS_LISTINGS"."CITY_LEVEL_AGGREGATES" cascade
[0m23:57:13.495995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.178 seconds
[0m23:57:13.544410 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_level_aggregates"
[0m23:57:13.544410 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_level_aggregates"
[0m23:57:13.544410 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_level_aggregates: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_level_aggregates"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates
    

    
    as (


WITH city_levels AS (
    SELECT CLEAN_CITY_NAME AS CITY_NAME,
    COUNT(PROP_ID) AS TOTAL_LISTINGS,
    AVG(PRICE) AS AVG_PRICE,
    MAX(TOTAL_FLOOR) AS MAX_FLOOR,
    AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT * FROM city_levels
    )
;
[0m23:57:14.627535 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.067 seconds
[0m23:57:14.629308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '919b549d-adee-4adf-8a29-72f0de889ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002255994EC30>]}
[0m23:57:14.629308 [info ] [Thread-1 (]: 2 of 4 OK created sql table model LISTINGS_LISTINGS.city_level_aggregates ...... [[32mSUCCESS 1[0m in 1.42s]
[0m23:57:14.636899 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_level_aggregates
[0m23:57:14.636899 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m23:57:14.639446 [info ] [Thread-1 (]: 3 of 4 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m23:57:14.641696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_level_aggregates, now model.real_estate_project_dbt.property_distribution)
[0m23:57:14.643083 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m23:57:14.649607 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m23:57:14.651240 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m23:57:14.660582 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m23:57:14.667181 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m23:57:14.669617 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m23:57:15.592380 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.929 seconds
[0m23:57:15.608298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '919b549d-adee-4adf-8a29-72f0de889ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225599A4FE0>]}
[0m23:57:15.608298 [info ] [Thread-1 (]: 3 of 4 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 0.97s]
[0m23:57:15.615886 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m23:57:15.617906 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m23:57:15.621713 [info ] [Thread-1 (]: 4 of 4 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m23:57:15.624438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_value_index)
[0m23:57:15.626771 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m23:57:15.647257 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m23:57:15.654068 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m23:57:15.669891 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m23:57:15.682141 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m23:57:15.684209 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
        PROP_ID,
        CLEAN_CITY_NAME,
        PRICE,
        AGE,
        TOTAL_FLOOR,
        BEDROOM_NUM,

        -- Score calculations
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,
        1 - PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

scored AS (
    SELECT
        *,
        ROUND(
            0.4 * PRICE_SCORE +
            0.2 * AGE_SCORE +
            0.2 * FLOOR_SCORE +
            0.2 * BEDROOM_SCORE, 4
        ) AS FINAL_VALUE_SCORE
    FROM ranked
),

-- ✅ Only call NTILE(10) once and reuse it
luxury_tagged AS (
    SELECT
        *,
        NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY FINAL_VALUE_SCORE DESC) AS decile
    FROM scored
)

SELECT
    *,
    CASE
        WHEN decile = 1 THEN TRUE
        ELSE FALSE
    END AS IS_LUXURY
FROM luxury_tagged
ORDER BY CLEAN_CITY_NAME, FINAL_VALUE_SCORE DESC
  );
[0m23:57:16.062042 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.374 seconds
[0m23:57:16.072155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '919b549d-adee-4adf-8a29-72f0de889ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225598E6600>]}
[0m23:57:16.072155 [info ] [Thread-1 (]: 4 of 4 OK created sql view model LISTINGS_LISTINGS.property_value_index ........ [[32mSUCCESS 1[0m in 0.45s]
[0m23:57:16.072155 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m23:57:16.080648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:16.084283 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m23:57:16.086890 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m23:57:16.294460 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m23:57:16.296474 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m23:57:16.675291 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.property_value_index' was left open.
[0m23:57:16.675291 [debug] [MainThread]: On model.real_estate_project_dbt.property_value_index: Close
[0m23:57:16.884734 [info ] [MainThread]: 
[0m23:57:16.884734 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 8.98 seconds (8.98s).
[0m23:57:16.900723 [debug] [MainThread]: Command end result
[0m23:57:16.989451 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m23:57:16.997547 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m23:57:17.005995 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m23:57:17.005995 [info ] [MainThread]: 
[0m23:57:17.014054 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:57:17.015136 [info ] [MainThread]: 
[0m23:57:17.015136 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m23:57:17.015136 [debug] [MainThread]: Command `dbt run` succeeded at 23:57:17.015136 after 13.21 seconds
[0m23:57:17.015136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022546DB1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022558FB08F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002254605D0D0>]}
[0m23:57:17.015136 [debug] [MainThread]: Flushing usage events
[0m23:57:18.815766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:11:07.437512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D3CF12390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D3D26CF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D3C4DEA20>]}


============================== 00:11:07.445744 | 689b1cce-e746-45f9-915a-4016045de67b ==============================
[0m00:11:07.445744 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:11:07.445744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:11:09.577872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '689b1cce-e746-45f9-915a-4016045de67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D3ADE8D10>]}
[0m00:11:09.697988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '689b1cce-e746-45f9-915a-4016045de67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D4E8D38F0>]}
[0m00:11:09.700649 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:11:10.358895 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:11:10.686746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:11:10.686746 [debug] [MainThread]: Partial parsing: added file: real_estate_project_dbt://models\example\property_type_price_comparison.sql
[0m00:11:11.148315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '689b1cce-e746-45f9-915a-4016045de67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5046D850>]}
[0m00:11:11.378374 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:11:11.382801 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:11:11.411629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '689b1cce-e746-45f9-915a-4016045de67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5023D0D0>]}
[0m00:11:11.411629 [info ] [MainThread]: Found 5 models, 476 macros
[0m00:11:11.411629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '689b1cce-e746-45f9-915a-4016045de67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D3D9BEAB0>]}
[0m00:11:11.411629 [info ] [MainThread]: 
[0m00:11:11.411629 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:11:11.426219 [info ] [MainThread]: 
[0m00:11:11.426219 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:11:11.426219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m00:11:11.593243 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:11:11.593243 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:11:11.593243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:13.704425 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.104 seconds
[0m00:11:13.704425 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m00:11:13.736054 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:11:13.752203 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:11:13.756201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:15.129513 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.381 seconds
[0m00:11:15.145716 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:11:15.145716 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m00:11:15.288998 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.135 seconds
[0m00:11:15.288998 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:11:15.288998 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:11:15.479561 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.181 seconds
[0m00:11:15.479561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '689b1cce-e746-45f9-915a-4016045de67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D50484110>]}
[0m00:11:15.506676 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m00:11:15.511466 [info ] [Thread-1 (]: 1 of 5 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m00:11:15.511466 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m00:11:15.511466 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m00:11:15.557405 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:11:15.557405 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m00:11:15.645243 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:11:15.645243 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m00:11:15.645243 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m00:11:15.659833 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:11:17.130084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.473 seconds
[0m00:11:17.215671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '689b1cce-e746-45f9-915a-4016045de67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D3AC7A090>]}
[0m00:11:17.215671 [info ] [Thread-1 (]: 1 of 5 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.69s]
[0m00:11:17.215671 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m00:11:17.215671 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_level_aggregates
[0m00:11:17.215671 [info ] [Thread-1 (]: 2 of 5 START sql table model LISTINGS_LISTINGS.city_level_aggregates ........... [RUN]
[0m00:11:17.215671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.city_level_aggregates)
[0m00:11:17.215671 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_level_aggregates
[0m00:11:17.239664 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:11:17.243264 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_level_aggregates
[0m00:11:17.290387 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:11:17.305577 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_level_aggregates"
[0m00:11:17.306340 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_level_aggregates: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_level_aggregates"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates
    

    
    as (


WITH city_levels AS (
    SELECT CLEAN_CITY_NAME AS CITY_NAME,
    COUNT(PROP_ID) AS TOTAL_LISTINGS,
    AVG(PRICE) AS AVG_PRICE,
    MAX(TOTAL_FLOOR) AS MAX_FLOOR,
    AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT * FROM city_levels
    )
;
[0m00:11:18.311252 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.003 seconds
[0m00:11:18.316784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '689b1cce-e746-45f9-915a-4016045de67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5088BAD0>]}
[0m00:11:18.319666 [info ] [Thread-1 (]: 2 of 5 OK created sql table model LISTINGS_LISTINGS.city_level_aggregates ...... [[32mSUCCESS 1[0m in 1.10s]
[0m00:11:18.324446 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_level_aggregates
[0m00:11:18.324446 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m00:11:18.328797 [info ] [Thread-1 (]: 3 of 5 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m00:11:18.330694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_level_aggregates, now model.real_estate_project_dbt.property_distribution)
[0m00:11:18.332617 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m00:11:18.340172 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m00:11:18.344876 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m00:11:18.362059 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m00:11:18.371098 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m00:11:18.374114 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m00:11:19.384274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.009 seconds
[0m00:11:19.392360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '689b1cce-e746-45f9-915a-4016045de67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D508B6360>]}
[0m00:11:19.396401 [info ] [Thread-1 (]: 3 of 5 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 1.06s]
[0m00:11:19.396401 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m00:11:19.396401 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:11:19.396401 [info ] [Thread-1 (]: 4 of 5 START sql table model LISTINGS_LISTINGS.property_type_price_comparison .. [RUN]
[0m00:11:19.406378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_type_price_comparison)
[0m00:11:19.408154 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_type_price_comparison
[0m00:11:19.425325 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:11:19.431397 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_type_price_comparison
[0m00:11:19.448827 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:11:19.452728 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:11:19.458126 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_type_price_comparison: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_type_price_comparison"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_type_price_comparison
    

    
    as (


WITH property_type_price AS (
  SELECT CLEAN_CITY_NAME AS CITY_NAME, PROPERTY_TYPE AS PROPERTY_TYPE,
  AVG(PRICE) AS AVG_PRICE,
  COUNT(PROP_ID) AS TOTAL_LISTINGS
  FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
  GROUP BY CLEAN_CITY_NAME, PROPERTY_TYPE
)


SELECT * FROM property_type_price
    )
;
[0m00:11:20.153354 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m00:11:20.161438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '689b1cce-e746-45f9-915a-4016045de67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D507D0200>]}
[0m00:11:20.165481 [info ] [Thread-1 (]: 4 of 5 OK created sql table model LISTINGS_LISTINGS.property_type_price_comparison  [[32mSUCCESS 1[0m in 0.76s]
[0m00:11:20.165481 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:11:20.165481 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m00:11:20.173497 [info ] [Thread-1 (]: 5 of 5 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m00:11:20.173497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_type_price_comparison, now model.real_estate_project_dbt.property_value_index)
[0m00:11:20.179010 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m00:11:20.190929 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m00:11:20.195843 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m00:11:20.212535 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m00:11:20.219631 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m00:11:20.219631 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
        PROP_ID,
        CLEAN_CITY_NAME,
        PRICE,
        AGE,
        TOTAL_FLOOR,
        BEDROOM_NUM,

        -- Score calculations
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,
        1 - PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

scored AS (
    SELECT
        *,
        ROUND(
            0.4 * PRICE_SCORE +
            0.2 * AGE_SCORE +
            0.2 * FLOOR_SCORE +
            0.2 * BEDROOM_SCORE, 4
        ) AS FINAL_VALUE_SCORE
    FROM ranked
),

-- ✅ Only call NTILE(10) once and reuse it
luxury_tagged AS (
    SELECT
        *,
        NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY FINAL_VALUE_SCORE DESC) AS decile
    FROM scored
)

SELECT
    *,
    CASE
        WHEN decile = 1 THEN TRUE
        ELSE FALSE
    END AS IS_LUXURY
FROM luxury_tagged
ORDER BY CLEAN_CITY_NAME, FINAL_VALUE_SCORE DESC
  );
[0m00:11:20.562584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.336 seconds
[0m00:11:20.568630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '689b1cce-e746-45f9-915a-4016045de67b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D507C4920>]}
[0m00:11:20.570645 [info ] [Thread-1 (]: 5 of 5 OK created sql view model LISTINGS_LISTINGS.property_value_index ........ [[32mSUCCESS 1[0m in 0.40s]
[0m00:11:20.570645 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m00:11:20.573475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:11:20.575810 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m00:11:20.575810 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m00:11:20.786171 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m00:11:20.788186 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m00:11:21.072778 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.property_value_index' was left open.
[0m00:11:21.072778 [debug] [MainThread]: On model.real_estate_project_dbt.property_value_index: Close
[0m00:11:21.281556 [info ] [MainThread]: 
[0m00:11:21.283980 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 9.85 seconds (9.85s).
[0m00:11:21.290161 [debug] [MainThread]: Command end result
[0m00:11:21.401726 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:11:21.413229 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:11:21.440670 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m00:11:21.442067 [info ] [MainThread]: 
[0m00:11:21.444867 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:11:21.447600 [info ] [MainThread]: 
[0m00:11:21.450148 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m00:11:21.455474 [debug] [MainThread]: Command `dbt run` succeeded at 00:11:21.454806 after 14.47 seconds
[0m00:11:21.458586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D3D2CAF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D3C947200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D3CF68B00>]}
[0m00:11:21.460634 [debug] [MainThread]: Flushing usage events
[0m00:11:23.533552 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:17:40.802299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C99328D580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C99328E3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9906CC5C0>]}


============================== 00:17:40.802299 | 38910f1c-9b9b-408a-9966-e5e009beaaf7 ==============================
[0m00:17:40.802299 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:17:40.802299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:17:43.259822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38910f1c-9b9b-408a-9966-e5e009beaaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A3C05F10>]}
[0m00:17:43.370819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38910f1c-9b9b-408a-9966-e5e009beaaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A30CD3A0>]}
[0m00:17:43.370819 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:17:44.000599 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:17:44.254437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:17:44.254437 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\city_level_aggregates.sql
[0m00:17:44.724446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38910f1c-9b9b-408a-9966-e5e009beaaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A60F1670>]}
[0m00:17:44.957873 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:17:44.959990 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:17:45.036495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38910f1c-9b9b-408a-9966-e5e009beaaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A5D75FA0>]}
[0m00:17:45.043822 [info ] [MainThread]: Found 5 models, 476 macros
[0m00:17:45.045332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38910f1c-9b9b-408a-9966-e5e009beaaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9930E0E00>]}
[0m00:17:45.055930 [info ] [MainThread]: 
[0m00:17:45.058347 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:17:45.059867 [info ] [MainThread]: 
[0m00:17:45.059867 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:17:45.093934 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m00:17:45.213071 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:17:45.213071 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:17:45.213071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:47.134034 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.918 seconds
[0m00:17:47.143565 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m00:17:47.175742 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:17:47.175742 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:17:47.175742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:48.381627 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.207 seconds
[0m00:17:48.397483 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:17:48.397483 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m00:17:48.555969 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.154 seconds
[0m00:17:48.571731 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:17:48.571731 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:17:48.717975 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.142 seconds
[0m00:17:48.730807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38910f1c-9b9b-408a-9966-e5e009beaaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C992B498B0>]}
[0m00:17:48.743826 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m00:17:48.748270 [info ] [Thread-1 (]: 1 of 5 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m00:17:48.751770 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m00:17:48.751770 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m00:17:48.785580 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:17:48.790323 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m00:17:48.850774 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:17:48.850774 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m00:17:48.850774 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m00:17:48.850774 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:17:50.495084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.643 seconds
[0m00:17:50.574666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38910f1c-9b9b-408a-9966-e5e009beaaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9908AA540>]}
[0m00:17:50.574666 [info ] [Thread-1 (]: 1 of 5 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.83s]
[0m00:17:50.590712 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m00:17:50.590712 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_level_aggregates
[0m00:17:50.590712 [info ] [Thread-1 (]: 2 of 5 START sql table model LISTINGS_LISTINGS.city_level_aggregates ........... [RUN]
[0m00:17:50.590712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.city_level_aggregates)
[0m00:17:50.600025 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_level_aggregates
[0m00:17:50.611581 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:17:50.614311 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_level_aggregates
[0m00:17:50.688287 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:17:50.688287 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_level_aggregates"
[0m00:17:50.688287 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_level_aggregates: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_level_aggregates"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates
    

    
    as (


WITH overall_avg AS (
    SELECT AVG(PRICE) AS overall_avg_price
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),


city_levels AS (
    SELECT 
         CLEAN_CITY_NAME AS CITY_NAME,
         COUNT(PROP_ID) AS TOTAL_LISTINGS,
         AVG(PRICE) AS AVG_PRICE,
         MAX(TOTAL_FLOOR) AS MAX_FLOOR,
         AVG(AGE) AS AVG_AGE
        CASE
           WHEN AVG_PRICE > (overall_city_avg * 1.2) THEN 'Overpriced'
           ELSE 'Fair'
        END AS PRICE_CATEGORY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT * FROM city_levels
    )
;
[0m00:17:50.872345 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd3487-3201-b728-0000-000e0472f511
[0m00:17:50.872345 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 8 unexpected 'CASE'.
syntax error line 22 at position 29 unexpected 'overall_city_avg'.
syntax error line 22 at position 53 unexpected 'THEN'.
[0m00:17:50.888265 [debug] [Thread-1 (]: Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 8 unexpected 'CASE'.
  syntax error line 22 at position 29 unexpected 'overall_city_avg'.
  syntax error line 22 at position 53 unexpected 'THEN'.
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:17:50.888265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38910f1c-9b9b-408a-9966-e5e009beaaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A6446300>]}
[0m00:17:50.888265 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model LISTINGS_LISTINGS.city_level_aggregates .. [[31mERROR[0m in 0.30s]
[0m00:17:50.888265 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_level_aggregates
[0m00:17:50.903650 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m00:17:50.903650 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.city_level_aggregates' to be skipped because of status 'error'.  Reason: Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 8 unexpected 'CASE'.
  syntax error line 22 at position 29 unexpected 'overall_city_avg'.
  syntax error line 22 at position 53 unexpected 'THEN'.
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql.
[0m00:17:50.908117 [info ] [Thread-1 (]: 3 of 5 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m00:17:50.913264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_level_aggregates, now model.real_estate_project_dbt.property_distribution)
[0m00:17:50.915624 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m00:17:50.926338 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m00:17:50.931355 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m00:17:50.944135 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m00:17:50.950519 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m00:17:50.952533 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m00:17:52.070086 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.116 seconds
[0m00:17:52.072097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38910f1c-9b9b-408a-9966-e5e009beaaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A660A870>]}
[0m00:17:52.077138 [info ] [Thread-1 (]: 3 of 5 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 1.16s]
[0m00:17:52.080180 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m00:17:52.082194 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:17:52.082194 [info ] [Thread-1 (]: 4 of 5 START sql table model LISTINGS_LISTINGS.property_type_price_comparison .. [RUN]
[0m00:17:52.084207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_type_price_comparison)
[0m00:17:52.086813 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_type_price_comparison
[0m00:17:52.101118 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:17:52.103675 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_type_price_comparison
[0m00:17:52.111473 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:17:52.116333 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:17:52.116333 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_type_price_comparison: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_type_price_comparison"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_type_price_comparison
    

    
    as (


WITH property_type_price AS (
  SELECT CLEAN_CITY_NAME AS CITY_NAME, PROPERTY_TYPE AS PROPERTY_TYPE,
  AVG(PRICE) AS AVG_PRICE,
  COUNT(PROP_ID) AS TOTAL_LISTINGS
  FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
  GROUP BY CLEAN_CITY_NAME, PROPERTY_TYPE
)


SELECT * FROM property_type_price
    )
;
[0m00:17:52.912826 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.794 seconds
[0m00:17:52.918365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38910f1c-9b9b-408a-9966-e5e009beaaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A64D3F80>]}
[0m00:17:52.918365 [info ] [Thread-1 (]: 4 of 5 OK created sql table model LISTINGS_LISTINGS.property_type_price_comparison  [[32mSUCCESS 1[0m in 0.83s]
[0m00:17:52.918365 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:17:52.918365 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m00:17:52.934425 [info ] [Thread-1 (]: 5 of 5 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m00:17:52.937258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_type_price_comparison, now model.real_estate_project_dbt.property_value_index)
[0m00:17:52.941230 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m00:17:52.965803 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m00:17:52.968654 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m00:17:52.989270 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m00:17:53.000510 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m00:17:53.000510 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
        PROP_ID,
        CLEAN_CITY_NAME,
        PRICE,
        AGE,
        TOTAL_FLOOR,
        BEDROOM_NUM,

        -- Score calculations
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,
        1 - PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

scored AS (
    SELECT
        *,
        ROUND(
            0.4 * PRICE_SCORE +
            0.2 * AGE_SCORE +
            0.2 * FLOOR_SCORE +
            0.2 * BEDROOM_SCORE, 4
        ) AS FINAL_VALUE_SCORE
    FROM ranked
),

-- ✅ Only call NTILE(10) once and reuse it
luxury_tagged AS (
    SELECT
        *,
        NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY FINAL_VALUE_SCORE DESC) AS decile
    FROM scored
)

SELECT
    *,
    CASE
        WHEN decile = 1 THEN TRUE
        ELSE FALSE
    END AS IS_LUXURY
FROM luxury_tagged
ORDER BY CLEAN_CITY_NAME, FINAL_VALUE_SCORE DESC
  );
[0m00:17:53.312417 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.315 seconds
[0m00:17:53.333352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38910f1c-9b9b-408a-9966-e5e009beaaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A6422570>]}
[0m00:17:53.333352 [info ] [Thread-1 (]: 5 of 5 OK created sql view model LISTINGS_LISTINGS.property_value_index ........ [[32mSUCCESS 1[0m in 0.40s]
[0m00:17:53.333352 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m00:17:53.346818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:53.347924 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m00:17:53.350782 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m00:17:53.580521 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m00:17:53.581924 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m00:17:53.830479 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.property_value_index' was left open.
[0m00:17:53.830479 [debug] [MainThread]: On model.real_estate_project_dbt.property_value_index: Close
[0m00:17:54.087430 [info ] [MainThread]: 
[0m00:17:54.087430 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 9.03 seconds (9.03s).
[0m00:17:54.099385 [debug] [MainThread]: Command end result
[0m00:17:54.236586 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:17:54.240502 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:17:54.266741 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m00:17:54.280844 [info ] [MainThread]: 
[0m00:17:54.282633 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:17:54.282633 [info ] [MainThread]: 
[0m00:17:54.282633 [error] [MainThread]: [31mFailure in model city_level_aggregates (models\example\city_level_aggregates.sql)[0m
[0m00:17:54.295301 [error] [MainThread]:   Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 8 unexpected 'CASE'.
  syntax error line 22 at position 29 unexpected 'overall_city_avg'.
  syntax error line 22 at position 53 unexpected 'THEN'.
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:17:54.297742 [info ] [MainThread]: 
[0m00:17:54.300622 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:17:54.302641 [info ] [MainThread]: 
[0m00:17:54.306156 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m00:17:54.312672 [debug] [MainThread]: Command `dbt run` failed at 00:17:54.312672 after 13.90 seconds
[0m00:17:54.312672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C99359B500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A5EFF7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A5E13EC0>]}
[0m00:17:54.312672 [debug] [MainThread]: Flushing usage events
[0m00:17:56.342882 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:19:06.480502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168ED88EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168F087680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168ECCE9F0>]}


============================== 00:19:06.494383 | 773faa42-f1c4-44f1-a62b-64e2f6069b41 ==============================
[0m00:19:06.494383 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:19:06.498811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:19:08.426726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '773faa42-f1c4-44f1-a62b-64e2f6069b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168F974740>]}
[0m00:19:08.537930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '773faa42-f1c4-44f1-a62b-64e2f6069b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168EE00E90>]}
[0m00:19:08.537930 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:19:09.088527 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:19:09.377937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:19:09.377937 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\city_level_aggregates.sql
[0m00:19:09.856422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '773faa42-f1c4-44f1-a62b-64e2f6069b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A1ECD9A0>]}
[0m00:19:10.061114 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:19:10.077888 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:19:10.113827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '773faa42-f1c4-44f1-a62b-64e2f6069b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A1B56180>]}
[0m00:19:10.116956 [info ] [MainThread]: Found 5 models, 476 macros
[0m00:19:10.116956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '773faa42-f1c4-44f1-a62b-64e2f6069b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A1EC7080>]}
[0m00:19:10.119625 [info ] [MainThread]: 
[0m00:19:10.119625 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:19:10.119625 [info ] [MainThread]: 
[0m00:19:10.124170 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:19:10.129844 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m00:19:10.285400 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:19:10.285400 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:19:10.285400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:12.252561 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.970 seconds
[0m00:19:12.263684 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m00:19:12.312402 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:19:12.312402 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:19:12.315560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:13.560012 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.252 seconds
[0m00:19:13.573573 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:19:13.573573 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m00:19:13.748075 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.166 seconds
[0m00:19:13.754447 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:19:13.754447 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:19:13.888462 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.126 seconds
[0m00:19:13.899570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '773faa42-f1c4-44f1-a62b-64e2f6069b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A1DF78C0>]}
[0m00:19:13.909920 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m00:19:13.916055 [info ] [Thread-1 (]: 1 of 5 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m00:19:13.916055 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m00:19:13.923774 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m00:19:13.963158 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:19:13.971196 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m00:19:14.069072 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:19:14.069072 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m00:19:14.069072 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m00:19:14.069072 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:19:15.498928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.418 seconds
[0m00:19:15.577940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '773faa42-f1c4-44f1-a62b-64e2f6069b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A1D06F30>]}
[0m00:19:15.577940 [info ] [Thread-1 (]: 1 of 5 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.66s]
[0m00:19:15.577940 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m00:19:15.577940 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_level_aggregates
[0m00:19:15.593646 [info ] [Thread-1 (]: 2 of 5 START sql table model LISTINGS_LISTINGS.city_level_aggregates ........... [RUN]
[0m00:19:15.593646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.city_level_aggregates)
[0m00:19:15.599238 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_level_aggregates
[0m00:19:15.601517 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:19:15.611737 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_level_aggregates
[0m00:19:15.700138 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:19:15.704949 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_level_aggregates"
[0m00:19:15.706745 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_level_aggregates: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_level_aggregates"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates
    

    
    as (


WITH overall_avg AS (
    SELECT AVG(PRICE) AS overall_avg_price
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),


city_levels AS (
    SELECT 
         CLEAN_CITY_NAME AS CITY_NAME,
         COUNT(PROP_ID) AS TOTAL_LISTINGS,
         AVG(PRICE) AS AVG_PRICE,
         MAX(TOTAL_FLOOR) AS MAX_FLOOR,
         AVG(AGE) AS AVG_AGE,
        CASE
           WHEN AVG_PRICE > (overall_avg_price * 1.2) THEN 'Overpriced'
           ELSE 'Fair'
        END AS PRICE_CATEGORY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT * FROM city_levels
    )
;
[0m00:19:15.840502 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd3489-3201-b7cb-000e-04720001324e
[0m00:19:15.840502 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 29
invalid identifier 'OVERALL_AVG_PRICE'
[0m00:19:15.851086 [debug] [Thread-1 (]: Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  000904 (42000): SQL compilation error: error line 22 at position 29
  invalid identifier 'OVERALL_AVG_PRICE'
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:19:15.851086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '773faa42-f1c4-44f1-a62b-64e2f6069b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A22C8D70>]}
[0m00:19:15.851086 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model LISTINGS_LISTINGS.city_level_aggregates .. [[31mERROR[0m in 0.26s]
[0m00:19:15.851086 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_level_aggregates
[0m00:19:15.851086 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m00:19:15.867174 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.city_level_aggregates' to be skipped because of status 'error'.  Reason: Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  000904 (42000): SQL compilation error: error line 22 at position 29
  invalid identifier 'OVERALL_AVG_PRICE'
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql.
[0m00:19:15.867174 [info ] [Thread-1 (]: 3 of 5 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m00:19:15.873257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_level_aggregates, now model.real_estate_project_dbt.property_distribution)
[0m00:19:15.873730 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m00:19:15.883111 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m00:19:15.885823 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m00:19:15.891626 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m00:19:15.894333 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m00:19:15.894333 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m00:19:17.239391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.345 seconds
[0m00:19:17.249244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '773faa42-f1c4-44f1-a62b-64e2f6069b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A22F5F10>]}
[0m00:19:17.249244 [info ] [Thread-1 (]: 3 of 5 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 1.38s]
[0m00:19:17.249244 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m00:19:17.249244 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:19:17.249244 [info ] [Thread-1 (]: 4 of 5 START sql table model LISTINGS_LISTINGS.property_type_price_comparison .. [RUN]
[0m00:19:17.265144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_type_price_comparison)
[0m00:19:17.267713 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_type_price_comparison
[0m00:19:17.282836 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:19:17.286518 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_type_price_comparison
[0m00:19:17.302804 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:19:17.303131 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:19:17.303131 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_type_price_comparison: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_type_price_comparison"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_type_price_comparison
    

    
    as (


WITH property_type_price AS (
  SELECT CLEAN_CITY_NAME AS CITY_NAME, PROPERTY_TYPE AS PROPERTY_TYPE,
  AVG(PRICE) AS AVG_PRICE,
  COUNT(PROP_ID) AS TOTAL_LISTINGS
  FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
  GROUP BY CLEAN_CITY_NAME, PROPERTY_TYPE
)


SELECT * FROM property_type_price
    )
;
[0m00:19:18.060175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.747 seconds
[0m00:19:18.070016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '773faa42-f1c4-44f1-a62b-64e2f6069b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A222B0B0>]}
[0m00:19:18.074049 [info ] [Thread-1 (]: 4 of 5 OK created sql table model LISTINGS_LISTINGS.property_type_price_comparison  [[32mSUCCESS 1[0m in 0.82s]
[0m00:19:18.077218 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:19:18.079237 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m00:19:18.081255 [info ] [Thread-1 (]: 5 of 5 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m00:19:18.085297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_type_price_comparison, now model.real_estate_project_dbt.property_value_index)
[0m00:19:18.088122 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m00:19:18.100330 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m00:19:18.107830 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m00:19:18.118187 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m00:19:18.129192 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m00:19:18.134083 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
        PROP_ID,
        CLEAN_CITY_NAME,
        PRICE,
        AGE,
        TOTAL_FLOOR,
        BEDROOM_NUM,

        -- Score calculations
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,
        1 - PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

scored AS (
    SELECT
        *,
        ROUND(
            0.4 * PRICE_SCORE +
            0.2 * AGE_SCORE +
            0.2 * FLOOR_SCORE +
            0.2 * BEDROOM_SCORE, 4
        ) AS FINAL_VALUE_SCORE
    FROM ranked
),

-- ✅ Only call NTILE(10) once and reuse it
luxury_tagged AS (
    SELECT
        *,
        NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY FINAL_VALUE_SCORE DESC) AS decile
    FROM scored
)

SELECT
    *,
    CASE
        WHEN decile = 1 THEN TRUE
        ELSE FALSE
    END AS IS_LUXURY
FROM luxury_tagged
ORDER BY CLEAN_CITY_NAME, FINAL_VALUE_SCORE DESC
  );
[0m00:19:18.358588 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.231 seconds
[0m00:19:18.370264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '773faa42-f1c4-44f1-a62b-64e2f6069b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A243A780>]}
[0m00:19:18.370264 [info ] [Thread-1 (]: 5 of 5 OK created sql view model LISTINGS_LISTINGS.property_value_index ........ [[32mSUCCESS 1[0m in 0.29s]
[0m00:19:18.370264 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m00:19:18.389121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:18.389121 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m00:19:18.389121 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m00:19:18.583340 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m00:19:18.583340 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m00:19:18.812070 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.property_value_index' was left open.
[0m00:19:18.812070 [debug] [MainThread]: On model.real_estate_project_dbt.property_value_index: Close
[0m00:19:19.025470 [info ] [MainThread]: 
[0m00:19:19.025470 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 8.91 seconds (8.91s).
[0m00:19:19.038337 [debug] [MainThread]: Command end result
[0m00:19:19.148495 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:19:19.151461 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:19:19.183011 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m00:19:19.184280 [info ] [MainThread]: 
[0m00:19:19.184280 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:19:19.184280 [info ] [MainThread]: 
[0m00:19:19.191387 [error] [MainThread]: [31mFailure in model city_level_aggregates (models\example\city_level_aggregates.sql)[0m
[0m00:19:19.195206 [error] [MainThread]:   Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  000904 (42000): SQL compilation error: error line 22 at position 29
  invalid identifier 'OVERALL_AVG_PRICE'
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:19:19.199976 [info ] [MainThread]: 
[0m00:19:19.201003 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:19:19.201003 [info ] [MainThread]: 
[0m00:19:19.208290 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m00:19:19.215146 [debug] [MainThread]: Command `dbt run` failed at 00:19:19.215146 after 13.02 seconds
[0m00:19:19.220382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A1EC7FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168ED88EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168C5BBD10>]}
[0m00:19:19.222402 [debug] [MainThread]: Flushing usage events
[0m00:19:21.336138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:21:37.507548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021572EB3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021570810080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215727B2180>]}


============================== 00:21:37.523055 | b58e4145-4fee-4bee-8a92-b86eeb54d1a4 ==============================
[0m00:21:37.523055 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:21:37.526589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:21:39.516262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b58e4145-4fee-4bee-8a92-b86eeb54d1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215730151C0>]}
[0m00:21:39.627062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b58e4145-4fee-4bee-8a92-b86eeb54d1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021572D50E90>]}
[0m00:21:39.627062 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:21:40.221751 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:21:40.527270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:21:40.527270 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\city_level_aggregates.sql
[0m00:21:41.044234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b58e4145-4fee-4bee-8a92-b86eeb54d1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021507211DF0>]}
[0m00:21:41.212634 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:21:41.214640 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:21:41.268102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b58e4145-4fee-4bee-8a92-b86eeb54d1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021506E97FB0>]}
[0m00:21:41.268102 [info ] [MainThread]: Found 5 models, 476 macros
[0m00:21:41.269856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b58e4145-4fee-4bee-8a92-b86eeb54d1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150708FE60>]}
[0m00:21:41.275886 [info ] [MainThread]: 
[0m00:21:41.275886 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:21:41.277896 [info ] [MainThread]: 
[0m00:21:41.279905 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:21:41.293192 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m00:21:41.466730 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:21:41.468735 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:21:41.468735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:43.167635 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.698 seconds
[0m00:21:43.181780 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m00:21:43.217855 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:21:43.227019 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:21:43.227019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:44.459620 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.232 seconds
[0m00:21:44.474762 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:21:44.476780 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m00:21:44.642417 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.168 seconds
[0m00:21:44.642417 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:21:44.642417 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:21:44.800058 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.144 seconds
[0m00:21:44.806126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b58e4145-4fee-4bee-8a92-b86eeb54d1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150708FB60>]}
[0m00:21:44.825572 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m00:21:44.830081 [info ] [Thread-1 (]: 1 of 5 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m00:21:44.830081 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m00:21:44.837063 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m00:21:44.873684 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:21:44.876246 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m00:21:44.945405 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:21:44.962850 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m00:21:44.964046 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m00:21:44.964046 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:21:46.537830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.578 seconds
[0m00:21:46.628518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b58e4145-4fee-4bee-8a92-b86eeb54d1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215704FA3F0>]}
[0m00:21:46.628518 [info ] [Thread-1 (]: 1 of 5 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.78s]
[0m00:21:46.633912 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m00:21:46.633912 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_level_aggregates
[0m00:21:46.633912 [info ] [Thread-1 (]: 2 of 5 START sql table model LISTINGS_LISTINGS.city_level_aggregates ........... [RUN]
[0m00:21:46.633912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.city_level_aggregates)
[0m00:21:46.633912 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_level_aggregates
[0m00:21:46.650095 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:21:46.652926 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_level_aggregates
[0m00:21:46.724289 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:21:46.730109 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_level_aggregates"
[0m00:21:46.730109 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_level_aggregates: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_level_aggregates"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates
    

    
    as (

-- Step 1: Calculate the overall average price
WITH overall_avg AS (
    SELECT AVG(PRICE) AS overall_avg_price
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

-- Step 2: Get city-level aggregates
city_base AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        COUNT(PROP_ID) AS TOTAL_LISTINGS,
        AVG(PRICE) AS AVG_PRICE,
        MAX(TOTAL_FLOOR) AS MAX_FLOOR,
        AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

-- Step 3: Join both to calculate price category
SELECT
    cb.*,
    CASE
        WHEN cb.AVG_PRICE > oa.overall_avg_price * 1.2 THEN 'Overpriced'
        ELSE 'Fair'
    END AS PRICE_CATEGORY
FROM city_base cb
CROSS JOIN overall_avg oa
    )
;
[0m00:21:47.873355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.136 seconds
[0m00:21:47.880261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b58e4145-4fee-4bee-8a92-b86eeb54d1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215075FF080>]}
[0m00:21:47.881356 [info ] [Thread-1 (]: 2 of 5 OK created sql table model LISTINGS_LISTINGS.city_level_aggregates ...... [[32mSUCCESS 1[0m in 1.25s]
[0m00:21:47.882983 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_level_aggregates
[0m00:21:47.884663 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m00:21:47.886398 [info ] [Thread-1 (]: 3 of 5 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m00:21:47.887738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_level_aggregates, now model.real_estate_project_dbt.property_distribution)
[0m00:21:47.889372 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m00:21:47.897312 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m00:21:47.898419 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m00:21:47.907776 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m00:21:47.914230 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m00:21:47.915316 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m00:21:48.679108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.774 seconds
[0m00:21:48.695173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b58e4145-4fee-4bee-8a92-b86eeb54d1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150760EB10>]}
[0m00:21:48.695173 [info ] [Thread-1 (]: 3 of 5 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 0.81s]
[0m00:21:48.695173 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m00:21:48.695173 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:21:48.695173 [info ] [Thread-1 (]: 4 of 5 START sql table model LISTINGS_LISTINGS.property_type_price_comparison .. [RUN]
[0m00:21:48.695173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_type_price_comparison)
[0m00:21:48.695173 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_type_price_comparison
[0m00:21:48.720535 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:21:48.721888 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_type_price_comparison
[0m00:21:48.730989 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:21:48.736715 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:21:48.736715 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_type_price_comparison: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_type_price_comparison"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_type_price_comparison
    

    
    as (


WITH property_type_price AS (
  SELECT CLEAN_CITY_NAME AS CITY_NAME, PROPERTY_TYPE AS PROPERTY_TYPE,
  AVG(PRICE) AS AVG_PRICE,
  COUNT(PROP_ID) AS TOTAL_LISTINGS
  FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
  GROUP BY CLEAN_CITY_NAME, PROPERTY_TYPE
)


SELECT * FROM property_type_price
    )
;
[0m00:21:49.502631 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.772 seconds
[0m00:21:49.502631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b58e4145-4fee-4bee-8a92-b86eeb54d1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021507569C40>]}
[0m00:21:49.518448 [info ] [Thread-1 (]: 4 of 5 OK created sql table model LISTINGS_LISTINGS.property_type_price_comparison  [[32mSUCCESS 1[0m in 0.81s]
[0m00:21:49.520136 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:21:49.520136 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m00:21:49.520136 [info ] [Thread-1 (]: 5 of 5 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m00:21:49.520136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_type_price_comparison, now model.real_estate_project_dbt.property_value_index)
[0m00:21:49.526779 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m00:21:49.529339 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m00:21:49.535518 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m00:21:49.540252 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m00:21:49.541868 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m00:21:49.541868 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
        PROP_ID,
        CLEAN_CITY_NAME,
        PRICE,
        AGE,
        TOTAL_FLOOR,
        BEDROOM_NUM,

        -- Score calculations
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,
        1 - PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

scored AS (
    SELECT
        *,
        ROUND(
            0.4 * PRICE_SCORE +
            0.2 * AGE_SCORE +
            0.2 * FLOOR_SCORE +
            0.2 * BEDROOM_SCORE, 4
        ) AS FINAL_VALUE_SCORE
    FROM ranked
),

-- ✅ Only call NTILE(10) once and reuse it
luxury_tagged AS (
    SELECT
        *,
        NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY FINAL_VALUE_SCORE DESC) AS decile
    FROM scored
)

SELECT
    *,
    CASE
        WHEN decile = 1 THEN TRUE
        ELSE FALSE
    END AS IS_LUXURY
FROM luxury_tagged
ORDER BY CLEAN_CITY_NAME, FINAL_VALUE_SCORE DESC
  );
[0m00:21:49.819873 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.270 seconds
[0m00:21:49.830974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b58e4145-4fee-4bee-8a92-b86eeb54d1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021507677CB0>]}
[0m00:21:49.835725 [info ] [Thread-1 (]: 5 of 5 OK created sql view model LISTINGS_LISTINGS.property_value_index ........ [[32mSUCCESS 1[0m in 0.31s]
[0m00:21:49.835725 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m00:21:49.835725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:21:49.835725 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m00:21:49.835725 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m00:21:50.054181 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m00:21:50.057305 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m00:21:50.265949 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.property_value_index' was left open.
[0m00:21:50.265949 [debug] [MainThread]: On model.real_estate_project_dbt.property_value_index: Close
[0m00:21:50.471757 [info ] [MainThread]: 
[0m00:21:50.475171 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 9.19 seconds (9.19s).
[0m00:21:50.482588 [debug] [MainThread]: Command end result
[0m00:21:50.581613 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:21:50.592275 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:21:50.609586 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m00:21:50.609586 [info ] [MainThread]: 
[0m00:21:50.609586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:21:50.609586 [info ] [MainThread]: 
[0m00:21:50.619101 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m00:21:50.621622 [debug] [MainThread]: Command `dbt run` succeeded at 00:21:50.621622 after 13.39 seconds
[0m00:21:50.623649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215072134A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021573017EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021507137950>]}
[0m00:21:50.623649 [debug] [MainThread]: Flushing usage events
[0m00:21:52.688627 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:23:03.789175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC36EEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC367DF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC367D640>]}


============================== 00:23:03.807482 | 5fc04c54-7cfb-43ce-95b5-89f54b735655 ==============================
[0m00:23:03.807482 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:23:03.810005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:23:05.844755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fc04c54-7cfb-43ce-95b5-89f54b735655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD4EAA900>]}
[0m00:23:05.956543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fc04c54-7cfb-43ce-95b5-89f54b735655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD4CCB8F0>]}
[0m00:23:05.956543 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:23:06.521664 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:23:06.775811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:23:06.777818 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\city_level_aggregates.sql
[0m00:23:06.777818 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\property_type_price_comparison.sql
[0m00:23:07.183780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fc04c54-7cfb-43ce-95b5-89f54b735655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD657DDC0>]}
[0m00:23:07.359411 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:23:07.375519 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:23:07.413376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fc04c54-7cfb-43ce-95b5-89f54b735655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD6339D00>]}
[0m00:23:07.413376 [info ] [MainThread]: Found 5 models, 476 macros
[0m00:23:07.413376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fc04c54-7cfb-43ce-95b5-89f54b735655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD61B70B0>]}
[0m00:23:07.416112 [info ] [MainThread]: 
[0m00:23:07.416112 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:23:07.416112 [info ] [MainThread]: 
[0m00:23:07.416112 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:23:07.429280 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m00:23:07.605955 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:23:07.605955 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:23:07.605955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:09.310067 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.703 seconds
[0m00:23:09.325914 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m00:23:09.365577 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:23:09.365577 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:23:09.367593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:10.489569 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.123 seconds
[0m00:23:10.505319 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:23:10.505319 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m00:23:10.669486 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.164 seconds
[0m00:23:10.669486 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:23:10.669486 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:23:10.792395 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.119 seconds
[0m00:23:10.809459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fc04c54-7cfb-43ce-95b5-89f54b735655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD63FF0B0>]}
[0m00:23:10.809459 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m00:23:10.823926 [info ] [Thread-1 (]: 1 of 5 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m00:23:10.823926 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m00:23:10.823926 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m00:23:10.858664 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:23:10.863017 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m00:23:10.946181 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:23:10.949064 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m00:23:10.949064 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m00:23:10.949064 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:23:12.355824 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.403 seconds
[0m00:23:12.442818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc04c54-7cfb-43ce-95b5-89f54b735655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC0D0A3F0>]}
[0m00:23:12.444580 [info ] [Thread-1 (]: 1 of 5 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.61s]
[0m00:23:12.448997 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m00:23:12.448997 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_level_aggregates
[0m00:23:12.451015 [info ] [Thread-1 (]: 2 of 5 START sql table model LISTINGS_LISTINGS.city_level_aggregates ........... [RUN]
[0m00:23:12.455323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.city_level_aggregates)
[0m00:23:12.456713 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_level_aggregates
[0m00:23:12.469796 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:23:12.474384 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_level_aggregates
[0m00:23:12.535839 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:23:12.535839 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_level_aggregates"
[0m00:23:12.544024 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_level_aggregates: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_level_aggregates"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates
    

    
    as (


WITH overall_avg AS (
    SELECT AVG(PRICE) AS overall_avg_price
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),


city_levels AS (
    SELECT 
         CLEAN_CITY_NAME AS CITY_NAME,
         COUNT(PROP_ID) AS TOTAL_LISTINGS,
         AVG(PRICE) AS AVG_PRICE,
         MAX(TOTAL_FLOOR) AS MAX_FLOOR,
         AVG(AGE) AS AVG_AGE,
        CASE
           WHEN AVG_PRICE > (overall_avg_price * 1.2) THEN 'Overpriced'
           ELSE 'Fair'
        END AS PRICE_CATEGORY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT * FROM city_levels
    )
;
[0m00:23:12.699865 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd348d-3201-b728-0000-000e0472f579
[0m00:23:12.699865 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 29
invalid identifier 'OVERALL_AVG_PRICE'
[0m00:23:12.715592 [debug] [Thread-1 (]: Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  000904 (42000): SQL compilation error: error line 22 at position 29
  invalid identifier 'OVERALL_AVG_PRICE'
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:23:12.715592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc04c54-7cfb-43ce-95b5-89f54b735655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD68E3F80>]}
[0m00:23:12.715592 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model LISTINGS_LISTINGS.city_level_aggregates .. [[31mERROR[0m in 0.26s]
[0m00:23:12.715592 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_level_aggregates
[0m00:23:12.732892 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.city_level_aggregates' to be skipped because of status 'error'.  Reason: Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  000904 (42000): SQL compilation error: error line 22 at position 29
  invalid identifier 'OVERALL_AVG_PRICE'
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql.
[0m00:23:12.715592 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m00:23:12.732892 [info ] [Thread-1 (]: 3 of 5 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m00:23:12.732892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_level_aggregates, now model.real_estate_project_dbt.property_distribution)
[0m00:23:12.741716 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m00:23:12.752447 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m00:23:12.758202 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m00:23:12.766636 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m00:23:12.774010 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m00:23:12.777904 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m00:23:13.880670 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.110 seconds
[0m00:23:13.893086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc04c54-7cfb-43ce-95b5-89f54b735655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD68E01D0>]}
[0m00:23:13.893086 [info ] [Thread-1 (]: 3 of 5 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 1.16s]
[0m00:23:13.900774 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m00:23:13.900774 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:23:13.903600 [info ] [Thread-1 (]: 4 of 5 START sql table model LISTINGS_LISTINGS.property_type_price_comparison .. [RUN]
[0m00:23:13.905442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_type_price_comparison)
[0m00:23:13.906836 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_type_price_comparison
[0m00:23:13.916910 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:23:13.919752 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_type_price_comparison
[0m00:23:13.929037 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:23:13.932485 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:23:13.932485 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_type_price_comparison: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_type_price_comparison"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_type_price_comparison
    

    
    as (

-- Step 1: Calculate the overall average price
WITH overall_avg AS (
    SELECT AVG(PRICE) AS overall_avg_price
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

-- Step 2: Get city-level aggregates
city_base AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        COUNT(PROP_ID) AS TOTAL_LISTINGS,
        AVG(PRICE) AS AVG_PRICE,
        MAX(TOTAL_FLOOR) AS MAX_FLOOR,
        AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

-- Step 3: Join both to calculate price category
SELECT
    cb.*,
    CASE
        WHEN cb.AVG_PRICE > oa.overall_avg_price * 1.2 THEN 'Overpriced'
        ELSE 'Fair'
    END AS PRICE_CATEGORY
FROM city_base cb
CROSS JOIN overall_avg oa
    )
;
[0m00:23:14.709830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.776 seconds
[0m00:23:14.717915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc04c54-7cfb-43ce-95b5-89f54b735655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD68D7140>]}
[0m00:23:14.721953 [info ] [Thread-1 (]: 4 of 5 OK created sql table model LISTINGS_LISTINGS.property_type_price_comparison  [[32mSUCCESS 1[0m in 0.81s]
[0m00:23:14.725740 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:23:14.727761 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m00:23:14.729785 [info ] [Thread-1 (]: 5 of 5 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m00:23:14.729785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_type_price_comparison, now model.real_estate_project_dbt.property_value_index)
[0m00:23:14.736763 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m00:23:14.751385 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m00:23:14.757276 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m00:23:14.764056 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m00:23:14.781004 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m00:23:14.784398 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
        PROP_ID,
        CLEAN_CITY_NAME,
        PRICE,
        AGE,
        TOTAL_FLOOR,
        BEDROOM_NUM,

        -- Score calculations
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,
        1 - PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

scored AS (
    SELECT
        *,
        ROUND(
            0.4 * PRICE_SCORE +
            0.2 * AGE_SCORE +
            0.2 * FLOOR_SCORE +
            0.2 * BEDROOM_SCORE, 4
        ) AS FINAL_VALUE_SCORE
    FROM ranked
),

-- ✅ Only call NTILE(10) once and reuse it
luxury_tagged AS (
    SELECT
        *,
        NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY FINAL_VALUE_SCORE DESC) AS decile
    FROM scored
)

SELECT
    *,
    CASE
        WHEN decile = 1 THEN TRUE
        ELSE FALSE
    END AS IS_LUXURY
FROM luxury_tagged
ORDER BY CLEAN_CITY_NAME, FINAL_VALUE_SCORE DESC
  );
[0m00:23:15.116560 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.333 seconds
[0m00:23:15.123447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc04c54-7cfb-43ce-95b5-89f54b735655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD697B380>]}
[0m00:23:15.123447 [info ] [Thread-1 (]: 5 of 5 OK created sql view model LISTINGS_LISTINGS.property_value_index ........ [[32mSUCCESS 1[0m in 0.39s]
[0m00:23:15.134791 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m00:23:15.139428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:23:15.141563 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m00:23:15.142647 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m00:23:15.361251 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m00:23:15.361251 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m00:23:15.570852 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.property_value_index' was left open.
[0m00:23:15.570852 [debug] [MainThread]: On model.real_estate_project_dbt.property_value_index: Close
[0m00:23:15.834593 [info ] [MainThread]: 
[0m00:23:15.841286 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 8.42 seconds (8.42s).
[0m00:23:15.848046 [debug] [MainThread]: Command end result
[0m00:23:15.935826 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:23:15.946943 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:23:15.952404 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m00:23:15.952404 [info ] [MainThread]: 
[0m00:23:15.960957 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:23:15.960957 [info ] [MainThread]: 
[0m00:23:15.960957 [error] [MainThread]: [31mFailure in model city_level_aggregates (models\example\city_level_aggregates.sql)[0m
[0m00:23:15.964918 [error] [MainThread]:   Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  000904 (42000): SQL compilation error: error line 22 at position 29
  invalid identifier 'OVERALL_AVG_PRICE'
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:23:15.964918 [info ] [MainThread]: 
[0m00:23:15.967212 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:23:15.968419 [info ] [MainThread]: 
[0m00:23:15.969219 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m00:23:15.971258 [debug] [MainThread]: Command `dbt run` failed at 00:23:15.969219 after 12.60 seconds
[0m00:23:15.972083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC355ECC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD6699370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC38F08F0>]}
[0m00:23:15.973239 [debug] [MainThread]: Flushing usage events
[0m00:23:17.568610 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:24:03.530456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E22F5BBA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E23241EA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E23241E9F0>]}


============================== 00:24:03.546317 | 26c92f89-5245-4600-a7bb-2415e98b8d05 ==============================
[0m00:24:03.546317 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:24:03.546317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:24:05.515325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26c92f89-5245-4600-a7bb-2415e98b8d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2447333E0>]}
[0m00:24:05.686764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26c92f89-5245-4600-a7bb-2415e98b8d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E241ECD3A0>]}
[0m00:24:05.686764 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:24:06.315297 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:24:06.552947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:24:06.552947 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:24:06.584421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26c92f89-5245-4600-a7bb-2415e98b8d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2449227B0>]}
[0m00:24:06.701746 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:24:06.706182 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:24:06.737945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26c92f89-5245-4600-a7bb-2415e98b8d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E244CC28A0>]}
[0m00:24:06.737945 [info ] [MainThread]: Found 5 models, 476 macros
[0m00:24:06.737945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26c92f89-5245-4600-a7bb-2415e98b8d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2431235F0>]}
[0m00:24:06.747417 [info ] [MainThread]: 
[0m00:24:06.749428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:24:06.749428 [info ] [MainThread]: 
[0m00:24:06.749428 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:24:06.758864 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m00:24:06.914460 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:24:06.914460 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:24:06.914460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:08.694691 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.775 seconds
[0m00:24:08.708514 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m00:24:08.760636 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:24:08.762127 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:24:08.764714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:09.918912 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.162 seconds
[0m00:24:09.941863 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:24:09.943233 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m00:24:10.109043 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.164 seconds
[0m00:24:10.111742 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:24:10.111742 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:24:10.241935 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.128 seconds
[0m00:24:10.257665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26c92f89-5245-4600-a7bb-2415e98b8d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E244CCC5F0>]}
[0m00:24:10.273781 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m00:24:10.273781 [info ] [Thread-1 (]: 1 of 5 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m00:24:10.280347 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m00:24:10.280347 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m00:24:10.312246 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:24:10.312246 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m00:24:10.487466 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:24:10.487466 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m00:24:10.487466 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m00:24:10.487466 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:24:11.949982 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.453 seconds
[0m00:24:12.023845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26c92f89-5245-4600-a7bb-2415e98b8d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E23199BDA0>]}
[0m00:24:12.023845 [info ] [Thread-1 (]: 1 of 5 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.75s]
[0m00:24:12.039733 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m00:24:12.039733 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_level_aggregates
[0m00:24:12.039733 [info ] [Thread-1 (]: 2 of 5 START sql table model LISTINGS_LISTINGS.city_level_aggregates ........... [RUN]
[0m00:24:12.046278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.city_level_aggregates)
[0m00:24:12.048289 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_level_aggregates
[0m00:24:12.054310 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:24:12.057666 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_level_aggregates
[0m00:24:12.115025 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:24:12.127855 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_level_aggregates"
[0m00:24:12.130088 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_level_aggregates: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_level_aggregates"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates
    

    
    as (


WITH overall_avg AS (
    SELECT AVG(PRICE) AS overall_avg_price
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),


city_levels AS (
    SELECT 
         CLEAN_CITY_NAME AS CITY_NAME,
         COUNT(PROP_ID) AS TOTAL_LISTINGS,
         AVG(PRICE) AS AVG_PRICE,
         MAX(TOTAL_FLOOR) AS MAX_FLOOR,
         AVG(AGE) AS AVG_AGE,
        CASE
           WHEN AVG_PRICE > (overall_avg_price * 1.2) THEN 'Overpriced'
           ELSE 'Fair'
        END AS PRICE_CATEGORY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT * FROM city_levels
    )
;
[0m00:24:12.267048 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd348e-3201-b7cb-000e-0472000132c2
[0m00:24:12.267048 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 29
invalid identifier 'OVERALL_AVG_PRICE'
[0m00:24:12.283436 [debug] [Thread-1 (]: Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  000904 (42000): SQL compilation error: error line 22 at position 29
  invalid identifier 'OVERALL_AVG_PRICE'
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:24:12.285450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26c92f89-5245-4600-a7bb-2415e98b8d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2451F01D0>]}
[0m00:24:12.288149 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model LISTINGS_LISTINGS.city_level_aggregates .. [[31mERROR[0m in 0.24s]
[0m00:24:12.291340 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_level_aggregates
[0m00:24:12.293312 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m00:24:12.295248 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.city_level_aggregates' to be skipped because of status 'error'.  Reason: Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  000904 (42000): SQL compilation error: error line 22 at position 29
  invalid identifier 'OVERALL_AVG_PRICE'
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql.
[0m00:24:12.298998 [info ] [Thread-1 (]: 3 of 5 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m00:24:12.304326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_level_aggregates, now model.real_estate_project_dbt.property_distribution)
[0m00:24:12.306206 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m00:24:12.322209 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m00:24:12.328566 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m00:24:12.342211 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m00:24:12.351759 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m00:24:12.353825 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m00:24:13.281655 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.927 seconds
[0m00:24:13.281655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26c92f89-5245-4600-a7bb-2415e98b8d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2447F3950>]}
[0m00:24:13.281655 [info ] [Thread-1 (]: 3 of 5 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 0.98s]
[0m00:24:13.292502 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m00:24:13.292502 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:24:13.294593 [info ] [Thread-1 (]: 4 of 5 START sql table model LISTINGS_LISTINGS.property_type_price_comparison .. [RUN]
[0m00:24:13.294593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_type_price_comparison)
[0m00:24:13.297296 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_type_price_comparison
[0m00:24:13.312202 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:24:13.315038 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_type_price_comparison
[0m00:24:13.328591 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:24:13.337259 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:24:13.340450 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_type_price_comparison: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_type_price_comparison"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_type_price_comparison
    

    
    as (

-- Step 1: Calculate the overall average price
WITH overall_avg AS (
    SELECT AVG(PRICE) AS overall_avg_price
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

-- Step 2: Get city-level aggregates
city_base AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        COUNT(PROP_ID) AS TOTAL_LISTINGS,
        AVG(PRICE) AS AVG_PRICE,
        MAX(TOTAL_FLOOR) AS MAX_FLOOR,
        AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

-- Step 3: Join both to calculate price category
SELECT
    cb.*,
    CASE
        WHEN cb.AVG_PRICE > oa.overall_avg_price * 1.2 THEN 'Overpriced'
        ELSE 'Fair'
    END AS PRICE_CATEGORY
FROM city_base cb
CROSS JOIN overall_avg oa
    )
;
[0m00:24:13.999361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.658 seconds
[0m00:24:14.009463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26c92f89-5245-4600-a7bb-2415e98b8d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E24531B260>]}
[0m00:24:14.011482 [info ] [Thread-1 (]: 4 of 5 OK created sql table model LISTINGS_LISTINGS.property_type_price_comparison  [[32mSUCCESS 1[0m in 0.71s]
[0m00:24:14.015970 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:24:14.015970 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m00:24:14.015970 [info ] [Thread-1 (]: 5 of 5 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m00:24:14.015970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_type_price_comparison, now model.real_estate_project_dbt.property_value_index)
[0m00:24:14.025503 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m00:24:14.050860 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m00:24:14.052585 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m00:24:14.063134 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m00:24:14.078696 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m00:24:14.080284 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
        PROP_ID,
        CLEAN_CITY_NAME,
        PRICE,
        AGE,
        TOTAL_FLOOR,
        BEDROOM_NUM,

        -- Score calculations
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,
        1 - PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

scored AS (
    SELECT
        *,
        ROUND(
            0.4 * PRICE_SCORE +
            0.2 * AGE_SCORE +
            0.2 * FLOOR_SCORE +
            0.2 * BEDROOM_SCORE, 4
        ) AS FINAL_VALUE_SCORE
    FROM ranked
),

-- ✅ Only call NTILE(10) once and reuse it
luxury_tagged AS (
    SELECT
        *,
        NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY FINAL_VALUE_SCORE DESC) AS decile
    FROM scored
)

SELECT
    *,
    CASE
        WHEN decile = 1 THEN TRUE
        ELSE FALSE
    END AS IS_LUXURY
FROM luxury_tagged
ORDER BY CLEAN_CITY_NAME, FINAL_VALUE_SCORE DESC
  );
[0m00:24:14.307170 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.223 seconds
[0m00:24:14.321101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26c92f89-5245-4600-a7bb-2415e98b8d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E245319EB0>]}
[0m00:24:14.321101 [info ] [Thread-1 (]: 5 of 5 OK created sql view model LISTINGS_LISTINGS.property_value_index ........ [[32mSUCCESS 1[0m in 0.31s]
[0m00:24:14.330703 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m00:24:14.337238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:14.341280 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m00:24:14.343303 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m00:24:14.615761 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m00:24:14.615761 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m00:24:14.825518 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.property_value_index' was left open.
[0m00:24:14.825518 [debug] [MainThread]: On model.real_estate_project_dbt.property_value_index: Close
[0m00:24:15.032373 [info ] [MainThread]: 
[0m00:24:15.032373 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 8.28 seconds (8.28s).
[0m00:24:15.045619 [debug] [MainThread]: Command end result
[0m00:24:15.160924 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:24:15.169112 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:24:15.193456 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m00:24:15.197097 [info ] [MainThread]: 
[0m00:24:15.197097 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:24:15.197097 [info ] [MainThread]: 
[0m00:24:15.197097 [error] [MainThread]: [31mFailure in model city_level_aggregates (models\example\city_level_aggregates.sql)[0m
[0m00:24:15.206514 [error] [MainThread]:   Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  000904 (42000): SQL compilation error: error line 22 at position 29
  invalid identifier 'OVERALL_AVG_PRICE'
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:24:15.209278 [info ] [MainThread]: 
[0m00:24:15.213090 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:24:15.214969 [info ] [MainThread]: 
[0m00:24:15.214969 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m00:24:15.223862 [debug] [MainThread]: Command `dbt run` failed at 00:24:15.223862 after 11.97 seconds
[0m00:24:15.228866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E232450260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E245096C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2327735F0>]}
[0m00:24:15.230249 [debug] [MainThread]: Flushing usage events
[0m00:24:16.866199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:24:54.692699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C733FABB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C736A3D430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C737151B80>]}


============================== 00:24:54.706416 | 14cc1958-a9b7-4324-83f3-40ecdfcd7e65 ==============================
[0m00:24:54.706416 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:24:54.709306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:24:56.448660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14cc1958-a9b7-4324-83f3-40ecdfcd7e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C747B3C3B0>]}
[0m00:24:56.558428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14cc1958-a9b7-4324-83f3-40ecdfcd7e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7479DC2C0>]}
[0m00:24:56.558428 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:24:57.331460 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:24:57.608708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:24:57.610087 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\property_type_price_comparison.sql
[0m00:24:58.022840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14cc1958-a9b7-4324-83f3-40ecdfcd7e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C74991DA60>]}
[0m00:24:58.190169 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:24:58.206287 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:24:58.241974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14cc1958-a9b7-4324-83f3-40ecdfcd7e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C74972D4C0>]}
[0m00:24:58.241974 [info ] [MainThread]: Found 5 models, 476 macros
[0m00:24:58.241974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14cc1958-a9b7-4324-83f3-40ecdfcd7e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C749817CB0>]}
[0m00:24:58.244274 [info ] [MainThread]: 
[0m00:24:58.244274 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:24:58.244274 [info ] [MainThread]: 
[0m00:24:58.244274 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:24:58.260204 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m00:24:58.422457 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:24:58.422457 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:24:58.422457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:25:00.004462 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.569 seconds
[0m00:25:00.019120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m00:25:00.065377 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:25:00.065377 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:25:00.065377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:25:01.257145 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.188 seconds
[0m00:25:01.271175 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:25:01.271175 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m00:25:01.418059 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.148 seconds
[0m00:25:01.418059 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:25:01.418059 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:25:01.616280 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.185 seconds
[0m00:25:01.616280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14cc1958-a9b7-4324-83f3-40ecdfcd7e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7496FBE00>]}
[0m00:25:01.636063 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m00:25:01.636063 [info ] [Thread-1 (]: 1 of 5 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m00:25:01.636063 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m00:25:01.647676 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m00:25:01.671328 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:25:01.674973 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m00:25:01.766154 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:25:01.780328 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m00:25:01.780328 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m00:25:01.780328 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:25:03.152306 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.370 seconds
[0m00:25:03.264348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14cc1958-a9b7-4324-83f3-40ecdfcd7e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7340CA2D0>]}
[0m00:25:03.267703 [info ] [Thread-1 (]: 1 of 5 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.62s]
[0m00:25:03.269443 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m00:25:03.269443 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_level_aggregates
[0m00:25:03.269443 [info ] [Thread-1 (]: 2 of 5 START sql table model LISTINGS_LISTINGS.city_level_aggregates ........... [RUN]
[0m00:25:03.269443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.city_level_aggregates)
[0m00:25:03.276738 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_level_aggregates
[0m00:25:03.280572 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:25:03.284615 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_level_aggregates
[0m00:25:03.326357 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:25:03.327919 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_level_aggregates"
[0m00:25:03.330549 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_level_aggregates: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_level_aggregates"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates
    

    
    as (


WITH overall_avg AS (
    SELECT AVG(PRICE) AS overall_avg_price
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),


city_levels AS (
    SELECT 
         CLEAN_CITY_NAME AS CITY_NAME,
         COUNT(PROP_ID) AS TOTAL_LISTINGS,
         AVG(PRICE) AS AVG_PRICE,
         MAX(TOTAL_FLOOR) AS MAX_FLOOR,
         AVG(AGE) AS AVG_AGE,
        CASE
           WHEN AVG_PRICE > (overall_avg_price * 1.2) THEN 'Overpriced'
           ELSE 'Fair'
        END AS PRICE_CATEGORY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT * FROM city_levels
    )
;
[0m00:25:03.474404 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd348f-3201-b728-0000-000e0472f595
[0m00:25:03.474404 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 29
invalid identifier 'OVERALL_AVG_PRICE'
[0m00:25:03.485261 [debug] [Thread-1 (]: Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  000904 (42000): SQL compilation error: error line 22 at position 29
  invalid identifier 'OVERALL_AVG_PRICE'
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:25:03.485261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14cc1958-a9b7-4324-83f3-40ecdfcd7e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C749D27CB0>]}
[0m00:25:03.485261 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model LISTINGS_LISTINGS.city_level_aggregates .. [[31mERROR[0m in 0.22s]
[0m00:25:03.497146 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_level_aggregates
[0m00:25:03.497146 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m00:25:03.501278 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.city_level_aggregates' to be skipped because of status 'error'.  Reason: Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  000904 (42000): SQL compilation error: error line 22 at position 29
  invalid identifier 'OVERALL_AVG_PRICE'
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql.
[0m00:25:03.503988 [info ] [Thread-1 (]: 3 of 5 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m00:25:03.511397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_level_aggregates, now model.real_estate_project_dbt.property_distribution)
[0m00:25:03.515458 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m00:25:03.533474 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m00:25:03.542612 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m00:25:03.558926 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m00:25:03.568591 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m00:25:03.570609 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m00:25:04.273114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m00:25:04.283049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14cc1958-a9b7-4324-83f3-40ecdfcd7e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C749D265A0>]}
[0m00:25:04.283049 [info ] [Thread-1 (]: 3 of 5 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 0.77s]
[0m00:25:04.283049 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m00:25:04.283049 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:25:04.298776 [info ] [Thread-1 (]: 4 of 5 START sql table model LISTINGS_LISTINGS.property_type_price_comparison .. [RUN]
[0m00:25:04.298776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_type_price_comparison)
[0m00:25:04.305089 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_type_price_comparison
[0m00:25:04.329658 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:25:04.331197 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_type_price_comparison
[0m00:25:04.347098 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:25:04.359048 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:25:04.360536 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_type_price_comparison: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_type_price_comparison"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_type_price_comparison
    

    
    as (

WITH overall_avg AS (
    SELECT
        AVG(PRICE) AS overall_avg_price
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

city_stats AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        COUNT(PROP_ID) AS TOTAL_LISTINGS,
        AVG(PRICE) AS AVG_PRICE,
        MAX(TOTAL_FLOOR) AS MAX_FLOOR,
        AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT
    cs.*,
    CASE
        WHEN cs.AVG_PRICE > oa.overall_avg_price * 1.2 THEN 'Overpriced'
        ELSE 'Fair'
    END AS PRICE_CATEGORY
FROM city_stats cs
CROSS JOIN overall_avg oa
    )
;
[0m00:25:04.992785 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m00:25:04.992785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14cc1958-a9b7-4324-83f3-40ecdfcd7e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C749C6A360>]}
[0m00:25:05.006921 [info ] [Thread-1 (]: 4 of 5 OK created sql table model LISTINGS_LISTINGS.property_type_price_comparison  [[32mSUCCESS 1[0m in 0.69s]
[0m00:25:05.006921 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:25:05.006921 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m00:25:05.006921 [info ] [Thread-1 (]: 5 of 5 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m00:25:05.006921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_type_price_comparison, now model.real_estate_project_dbt.property_value_index)
[0m00:25:05.018785 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m00:25:05.027523 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m00:25:05.036188 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m00:25:05.045373 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m00:25:05.059679 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m00:25:05.060532 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
        PROP_ID,
        CLEAN_CITY_NAME,
        PRICE,
        AGE,
        TOTAL_FLOOR,
        BEDROOM_NUM,

        -- Score calculations
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,
        1 - PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

scored AS (
    SELECT
        *,
        ROUND(
            0.4 * PRICE_SCORE +
            0.2 * AGE_SCORE +
            0.2 * FLOOR_SCORE +
            0.2 * BEDROOM_SCORE, 4
        ) AS FINAL_VALUE_SCORE
    FROM ranked
),

-- ✅ Only call NTILE(10) once and reuse it
luxury_tagged AS (
    SELECT
        *,
        NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY FINAL_VALUE_SCORE DESC) AS decile
    FROM scored
)

SELECT
    *,
    CASE
        WHEN decile = 1 THEN TRUE
        ELSE FALSE
    END AS IS_LUXURY
FROM luxury_tagged
ORDER BY CLEAN_CITY_NAME, FINAL_VALUE_SCORE DESC
  );
[0m00:25:05.404824 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.340 seconds
[0m00:25:05.414944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14cc1958-a9b7-4324-83f3-40ecdfcd7e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C749E47E60>]}
[0m00:25:05.414944 [info ] [Thread-1 (]: 5 of 5 OK created sql view model LISTINGS_LISTINGS.property_value_index ........ [[32mSUCCESS 1[0m in 0.41s]
[0m00:25:05.414944 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m00:25:05.414944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:25:05.414944 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m00:25:05.430993 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m00:25:05.635129 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m00:25:05.637149 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m00:25:05.850718 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.property_value_index' was left open.
[0m00:25:05.853306 [debug] [MainThread]: On model.real_estate_project_dbt.property_value_index: Close
[0m00:25:06.057906 [info ] [MainThread]: 
[0m00:25:06.060375 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 7.81 seconds (7.81s).
[0m00:25:06.067316 [debug] [MainThread]: Command end result
[0m00:25:06.163993 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:25:06.172062 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:25:06.197247 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m00:25:06.197247 [info ] [MainThread]: 
[0m00:25:06.197247 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:25:06.197247 [info ] [MainThread]: 
[0m00:25:06.197247 [error] [MainThread]: [31mFailure in model city_level_aggregates (models\example\city_level_aggregates.sql)[0m
[0m00:25:06.197247 [error] [MainThread]:   Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  000904 (42000): SQL compilation error: error line 22 at position 29
  invalid identifier 'OVERALL_AVG_PRICE'
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:25:06.197247 [info ] [MainThread]: 
[0m00:25:06.206753 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:25:06.210403 [info ] [MainThread]: 
[0m00:25:06.212713 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m00:25:06.217086 [debug] [MainThread]: Command `dbt run` failed at 00:25:06.215040 after 11.79 seconds
[0m00:25:06.218757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C749727B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C749A390D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C733FABB00>]}
[0m00:25:06.220044 [debug] [MainThread]: Flushing usage events
[0m00:25:07.862904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:26:04.461698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA34EBA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA6692270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA6691730>]}


============================== 00:26:04.470478 | 5a916af9-0a67-4f8c-9ec9-79ad3934821f ==============================
[0m00:26:04.470478 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:26:04.470478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:26:06.597998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a916af9-0a67-4f8c-9ec9-79ad3934821f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB8733830>]}
[0m00:26:06.747748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a916af9-0a67-4f8c-9ec9-79ad3934821f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA5F7FDD0>]}
[0m00:26:06.747748 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:26:07.334618 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:26:07.683151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:26:07.683151 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\property_type_price_comparison.sql
[0m00:26:08.102554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a916af9-0a67-4f8c-9ec9-79ad3934821f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB8E0D970>]}
[0m00:26:08.275266 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:26:08.275266 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:26:08.323550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a916af9-0a67-4f8c-9ec9-79ad3934821f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB8A95A90>]}
[0m00:26:08.334285 [info ] [MainThread]: Found 5 models, 476 macros
[0m00:26:08.334285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a916af9-0a67-4f8c-9ec9-79ad3934821f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB8E07D40>]}
[0m00:26:08.338043 [info ] [MainThread]: 
[0m00:26:08.338043 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:26:08.338043 [info ] [MainThread]: 
[0m00:26:08.338043 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:26:08.338043 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m00:26:08.529755 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:26:08.529755 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:26:08.529755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:10.091384 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.557 seconds
[0m00:26:10.099745 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m00:26:10.147894 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:26:10.147894 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:26:10.147894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:11.398797 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.248 seconds
[0m00:26:11.414874 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:26:11.417014 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m00:26:11.560117 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.146 seconds
[0m00:26:11.570497 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:26:11.570497 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:26:11.706057 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.135 seconds
[0m00:26:11.718604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a916af9-0a67-4f8c-9ec9-79ad3934821f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA5E65400>]}
[0m00:26:11.718604 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m00:26:11.734760 [info ] [Thread-1 (]: 1 of 5 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m00:26:11.734760 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m00:26:11.734760 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m00:26:11.767224 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:26:11.774283 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m00:26:11.863106 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:26:11.865116 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m00:26:11.865116 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m00:26:11.865116 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:26:13.299143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.434 seconds
[0m00:26:13.378571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a916af9-0a67-4f8c-9ec9-79ad3934821f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA360A360>]}
[0m00:26:13.378571 [info ] [Thread-1 (]: 1 of 5 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.64s]
[0m00:26:13.378571 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m00:26:13.394344 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_level_aggregates
[0m00:26:13.397167 [info ] [Thread-1 (]: 2 of 5 START sql table model LISTINGS_LISTINGS.city_level_aggregates ........... [RUN]
[0m00:26:13.397167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.city_level_aggregates)
[0m00:26:13.400777 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_level_aggregates
[0m00:26:13.410355 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:26:13.411912 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_level_aggregates
[0m00:26:13.483861 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:26:13.489447 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_level_aggregates"
[0m00:26:13.489447 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_level_aggregates: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_level_aggregates"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates
    

    
    as (


WITH overall_avg AS (
    SELECT AVG(PRICE) AS overall_avg_price
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),


city_levels AS (
    SELECT 
         CLEAN_CITY_NAME AS CITY_NAME,
         COUNT(PROP_ID) AS TOTAL_LISTINGS,
         AVG(PRICE) AS AVG_PRICE,
         MAX(TOTAL_FLOOR) AS MAX_FLOOR,
         AVG(AGE) AS AVG_AGE,
        CASE
           WHEN AVG_PRICE > (overall_avg_price * 1.2) THEN 'Overpriced'
           ELSE 'Fair'
        END AS PRICE_CATEGORY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT * FROM city_levels
    )
;
[0m00:26:13.621082 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd3490-3201-b7cb-000e-0472000132d6
[0m00:26:13.621082 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 29
invalid identifier 'OVERALL_AVG_PRICE'
[0m00:26:13.637229 [debug] [Thread-1 (]: Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  000904 (42000): SQL compilation error: error line 22 at position 29
  invalid identifier 'OVERALL_AVG_PRICE'
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:26:13.637229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a916af9-0a67-4f8c-9ec9-79ad3934821f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB921FA70>]}
[0m00:26:13.637229 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model LISTINGS_LISTINGS.city_level_aggregates .. [[31mERROR[0m in 0.24s]
[0m00:26:13.637229 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_level_aggregates
[0m00:26:13.637229 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m00:26:13.637229 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.city_level_aggregates' to be skipped because of status 'error'.  Reason: Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  000904 (42000): SQL compilation error: error line 22 at position 29
  invalid identifier 'OVERALL_AVG_PRICE'
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql.
[0m00:26:13.652928 [info ] [Thread-1 (]: 3 of 5 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m00:26:13.659475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_level_aggregates, now model.real_estate_project_dbt.property_distribution)
[0m00:26:13.662310 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m00:26:13.676632 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m00:26:13.680581 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m00:26:13.688577 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m00:26:13.701740 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m00:26:13.704021 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m00:26:14.830793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.128 seconds
[0m00:26:14.838473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a916af9-0a67-4f8c-9ec9-79ad3934821f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB9235940>]}
[0m00:26:14.840278 [info ] [Thread-1 (]: 3 of 5 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 1.18s]
[0m00:26:14.843428 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m00:26:14.844684 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:26:14.846086 [info ] [Thread-1 (]: 4 of 5 START sql table model LISTINGS_LISTINGS.property_type_price_comparison .. [RUN]
[0m00:26:14.846086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_type_price_comparison)
[0m00:26:14.848831 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_type_price_comparison
[0m00:26:14.854962 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:26:14.858481 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_type_price_comparison
[0m00:26:14.864587 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:26:14.871040 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:26:14.871040 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_type_price_comparison: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_type_price_comparison"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_type_price_comparison
    

    
    as (

-- Step 1: Get overall average price across all cities
WITH overall_avg_price_cte AS (
    SELECT AVG(PRICE) AS overall_avg_price
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

-- Step 2: City-level aggregates (do not use CASE here!)
city_level_aggregates_cte AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        COUNT(PROP_ID) AS TOTAL_LISTINGS,
        AVG(PRICE) AS AVG_PRICE,
        MAX(TOTAL_FLOOR) AS MAX_FLOOR,
        AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

-- Step 3: Add price category by comparing to overall average
SELECT
    city.*,
    CASE
        WHEN city.AVG_PRICE > overall.overall_avg_price * 1.2 THEN 'Overpriced'
        ELSE 'Fair'
    END AS PRICE_CATEGORY
FROM city_level_aggregates_cte city
CROSS JOIN overall_avg_price_cte overall
    )
;
[0m00:26:15.643074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.780 seconds
[0m00:26:15.666135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a916af9-0a67-4f8c-9ec9-79ad3934821f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB921F290>]}
[0m00:26:15.666135 [info ] [Thread-1 (]: 4 of 5 OK created sql table model LISTINGS_LISTINGS.property_type_price_comparison  [[32mSUCCESS 1[0m in 0.82s]
[0m00:26:15.673647 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:26:15.677436 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m00:26:15.680490 [info ] [Thread-1 (]: 5 of 5 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m00:26:15.685031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_type_price_comparison, now model.real_estate_project_dbt.property_value_index)
[0m00:26:15.690202 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m00:26:15.717761 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m00:26:15.733276 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m00:26:15.751791 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m00:26:15.771688 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m00:26:15.773708 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
        PROP_ID,
        CLEAN_CITY_NAME,
        PRICE,
        AGE,
        TOTAL_FLOOR,
        BEDROOM_NUM,

        -- Score calculations
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,
        1 - PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

scored AS (
    SELECT
        *,
        ROUND(
            0.4 * PRICE_SCORE +
            0.2 * AGE_SCORE +
            0.2 * FLOOR_SCORE +
            0.2 * BEDROOM_SCORE, 4
        ) AS FINAL_VALUE_SCORE
    FROM ranked
),

-- ✅ Only call NTILE(10) once and reuse it
luxury_tagged AS (
    SELECT
        *,
        NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY FINAL_VALUE_SCORE DESC) AS decile
    FROM scored
)

SELECT
    *,
    CASE
        WHEN decile = 1 THEN TRUE
        ELSE FALSE
    END AS IS_LUXURY
FROM luxury_tagged
ORDER BY CLEAN_CITY_NAME, FINAL_VALUE_SCORE DESC
  );
[0m00:26:16.061204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.286 seconds
[0m00:26:16.071982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a916af9-0a67-4f8c-9ec9-79ad3934821f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB9150170>]}
[0m00:26:16.075286 [info ] [Thread-1 (]: 5 of 5 OK created sql view model LISTINGS_LISTINGS.property_value_index ........ [[32mSUCCESS 1[0m in 0.39s]
[0m00:26:16.077918 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m00:26:16.085544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:26:16.085544 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m00:26:16.085544 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m00:26:16.285996 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m00:26:16.287333 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m00:26:16.486414 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.property_value_index' was left open.
[0m00:26:16.489394 [debug] [MainThread]: On model.real_estate_project_dbt.property_value_index: Close
[0m00:26:16.688330 [info ] [MainThread]: 
[0m00:26:16.688330 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 8.35 seconds (8.35s).
[0m00:26:16.695902 [debug] [MainThread]: Command end result
[0m00:26:16.800678 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:26:16.808882 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:26:16.833480 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m00:26:16.833480 [info ] [MainThread]: 
[0m00:26:16.833480 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:26:16.841922 [info ] [MainThread]: 
[0m00:26:16.844604 [error] [MainThread]: [31mFailure in model city_level_aggregates (models\example\city_level_aggregates.sql)[0m
[0m00:26:16.846368 [error] [MainThread]:   Database Error in model city_level_aggregates (models\example\city_level_aggregates.sql)
  000904 (42000): SQL compilation error: error line 22 at position 29
  invalid identifier 'OVERALL_AVG_PRICE'
  compiled code at target\run\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:26:16.847911 [info ] [MainThread]: 
[0m00:26:16.850342 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\city_level_aggregates.sql
[0m00:26:16.850342 [info ] [MainThread]: 
[0m00:26:16.850342 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m00:26:16.856944 [debug] [MainThread]: Command `dbt run` failed at 00:26:16.856944 after 12.83 seconds
[0m00:26:16.858771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB6F8CC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA66615B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA6661400>]}
[0m00:26:16.858771 [debug] [MainThread]: Flushing usage events
[0m00:26:18.975656 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:27:34.212822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020337D85340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020337D842C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002033810C380>]}


============================== 00:27:34.215845 | a998f8f8-71c3-425d-b8c0-b3761052cdf0 ==============================
[0m00:27:34.215845 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:27:34.227263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:27:36.078431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a998f8f8-71c3-425d-b8c0-b3761052cdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034A5796D0>]}
[0m00:27:36.188920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a998f8f8-71c3-425d-b8c0-b3761052cdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203488F4770>]}
[0m00:27:36.188920 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:27:36.842592 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:27:37.095721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:27:37.098689 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\city_level_aggregates.sql
[0m00:27:37.506584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a998f8f8-71c3-425d-b8c0-b3761052cdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034ABEDA60>]}
[0m00:27:37.693173 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:27:37.693173 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:27:37.772899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a998f8f8-71c3-425d-b8c0-b3761052cdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034A877E90>]}
[0m00:27:37.776495 [info ] [MainThread]: Found 5 models, 476 macros
[0m00:27:37.776495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a998f8f8-71c3-425d-b8c0-b3761052cdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034ABED7C0>]}
[0m00:27:37.780195 [info ] [MainThread]: 
[0m00:27:37.786724 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:27:37.788965 [info ] [MainThread]: 
[0m00:27:37.791706 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:27:37.804886 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m00:27:38.011363 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:27:38.011363 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:27:38.011363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:39.552050 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.528 seconds
[0m00:27:39.562728 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m00:27:39.596299 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:27:39.596299 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:27:39.596299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:40.785671 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.196 seconds
[0m00:27:40.799082 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:27:40.799082 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m00:27:40.951208 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.137 seconds
[0m00:27:40.951208 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:27:40.951208 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:27:41.097775 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.143 seconds
[0m00:27:41.109371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a998f8f8-71c3-425d-b8c0-b3761052cdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020335480920>]}
[0m00:27:41.125102 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m00:27:41.130754 [info ] [Thread-1 (]: 1 of 5 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m00:27:41.132769 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m00:27:41.135548 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m00:27:41.167612 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:27:41.167612 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m00:27:41.254355 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:27:41.254355 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m00:27:41.271102 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m00:27:41.271615 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:27:42.590998 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.318 seconds
[0m00:27:42.677488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a998f8f8-71c3-425d-b8c0-b3761052cdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002033539A5A0>]}
[0m00:27:42.679507 [info ] [Thread-1 (]: 1 of 5 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.54s]
[0m00:27:42.682960 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m00:27:42.682960 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_level_aggregates
[0m00:27:42.686555 [info ] [Thread-1 (]: 2 of 5 START sql table model LISTINGS_LISTINGS.city_level_aggregates ........... [RUN]
[0m00:27:42.686555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.city_level_aggregates)
[0m00:27:42.686555 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_level_aggregates
[0m00:27:42.686555 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:27:42.686555 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_level_aggregates
[0m00:27:42.736009 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:27:42.736009 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_level_aggregates"
[0m00:27:42.736009 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_level_aggregates: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_level_aggregates"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates
    

    
    as (


WITH city_levels AS (
    SELECT CLEAN_CITY_NAME AS CITY_NAME,
    COUNT(PROP_ID) AS TOTAL_LISTINGS,
    AVG(PRICE) AS AVG_PRICE,
    MAX(TOTAL_FLOOR) AS MAX_FLOOR,
    AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT * FROM city_levels
    )
;
[0m00:27:43.716220 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.970 seconds
[0m00:27:43.726310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a998f8f8-71c3-425d-b8c0-b3761052cdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034AFF51C0>]}
[0m00:27:43.730098 [info ] [Thread-1 (]: 2 of 5 OK created sql table model LISTINGS_LISTINGS.city_level_aggregates ...... [[32mSUCCESS 1[0m in 1.04s]
[0m00:27:43.732563 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_level_aggregates
[0m00:27:43.736609 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m00:27:43.739382 [info ] [Thread-1 (]: 3 of 5 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m00:27:43.739382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_level_aggregates, now model.real_estate_project_dbt.property_distribution)
[0m00:27:43.744122 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m00:27:43.762246 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m00:27:43.769711 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m00:27:43.791866 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m00:27:43.807983 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m00:27:43.809670 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m00:27:44.730440 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.928 seconds
[0m00:27:44.746424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a998f8f8-71c3-425d-b8c0-b3761052cdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034B01E240>]}
[0m00:27:44.746424 [info ] [Thread-1 (]: 3 of 5 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 1.01s]
[0m00:27:44.746424 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m00:27:44.746424 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:27:44.746424 [info ] [Thread-1 (]: 4 of 5 START sql table model LISTINGS_LISTINGS.property_type_price_comparison .. [RUN]
[0m00:27:44.746424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_type_price_comparison)
[0m00:27:44.762190 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_type_price_comparison
[0m00:27:44.788807 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:27:44.791872 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_type_price_comparison
[0m00:27:44.805737 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:27:44.817334 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:27:44.818965 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_type_price_comparison: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_type_price_comparison"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_type_price_comparison
    

    
    as (

-- Step 1: Get overall average price across all cities
WITH overall_avg_price_cte AS (
    SELECT AVG(PRICE) AS overall_avg_price
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

-- Step 2: City-level aggregates (do not use CASE here!)
city_level_aggregates_cte AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        COUNT(PROP_ID) AS TOTAL_LISTINGS,
        AVG(PRICE) AS AVG_PRICE,
        MAX(TOTAL_FLOOR) AS MAX_FLOOR,
        AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

-- Step 3: Add price category by comparing to overall average
SELECT
    city.*,
    CASE
        WHEN city.AVG_PRICE > overall.overall_avg_price * 1.2 THEN 'Overpriced'
        ELSE 'Fair'
    END AS PRICE_CATEGORY
FROM city_level_aggregates_cte city
CROSS JOIN overall_avg_price_cte overall
    )
;
[0m00:27:45.661822 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.839 seconds
[0m00:27:45.667879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a998f8f8-71c3-425d-b8c0-b3761052cdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034AE2B5C0>]}
[0m00:27:45.669890 [info ] [Thread-1 (]: 4 of 5 OK created sql table model LISTINGS_LISTINGS.property_type_price_comparison  [[32mSUCCESS 1[0m in 0.92s]
[0m00:27:45.669890 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:27:45.672541 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m00:27:45.674554 [info ] [Thread-1 (]: 5 of 5 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m00:27:45.674554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_type_price_comparison, now model.real_estate_project_dbt.property_value_index)
[0m00:27:45.677489 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m00:27:45.686218 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m00:27:45.686218 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m00:27:45.693167 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m00:27:45.704405 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m00:27:45.709500 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
        PROP_ID,
        CLEAN_CITY_NAME,
        PRICE,
        AGE,
        TOTAL_FLOOR,
        BEDROOM_NUM,

        -- Score calculations
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,
        1 - PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

scored AS (
    SELECT
        *,
        ROUND(
            0.4 * PRICE_SCORE +
            0.2 * AGE_SCORE +
            0.2 * FLOOR_SCORE +
            0.2 * BEDROOM_SCORE, 4
        ) AS FINAL_VALUE_SCORE
    FROM ranked
),

-- ✅ Only call NTILE(10) once and reuse it
luxury_tagged AS (
    SELECT
        *,
        NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY FINAL_VALUE_SCORE DESC) AS decile
    FROM scored
)

SELECT
    *,
    CASE
        WHEN decile = 1 THEN TRUE
        ELSE FALSE
    END AS IS_LUXURY
FROM luxury_tagged
ORDER BY CLEAN_CITY_NAME, FINAL_VALUE_SCORE DESC
  );
[0m00:27:45.964446 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m00:27:45.976341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a998f8f8-71c3-425d-b8c0-b3761052cdf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002034AF22510>]}
[0m00:27:45.976341 [info ] [Thread-1 (]: 5 of 5 OK created sql view model LISTINGS_LISTINGS.property_value_index ........ [[32mSUCCESS 1[0m in 0.30s]
[0m00:27:45.976341 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m00:27:45.976341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:27:45.976341 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m00:27:45.992305 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m00:27:46.196545 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m00:27:46.196545 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m00:27:46.479366 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.property_value_index' was left open.
[0m00:27:46.481380 [debug] [MainThread]: On model.real_estate_project_dbt.property_value_index: Close
[0m00:27:46.676743 [info ] [MainThread]: 
[0m00:27:46.676743 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m00:27:46.686166 [debug] [MainThread]: Command end result
[0m00:27:46.732563 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:27:46.736553 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:27:46.736553 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m00:27:46.736553 [info ] [MainThread]: 
[0m00:27:46.736553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:27:46.736553 [info ] [MainThread]: 
[0m00:27:46.736553 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m00:27:46.750191 [debug] [MainThread]: Command `dbt run` succeeded at 00:27:46.750191 after 12.81 seconds
[0m00:27:46.751189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020337655AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020347FF7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020347B42FC0>]}
[0m00:27:46.752216 [debug] [MainThread]: Flushing usage events
[0m00:27:48.835251 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:49:19.430249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D0385EAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D0348D610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D0348F8C0>]}


============================== 00:49:19.439766 | 83a91785-d59b-4f55-85e8-0f60ac7b11cf ==============================
[0m00:49:19.439766 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:49:19.444263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:49:21.754561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83a91785-d59b-4f55-85e8-0f60ac7b11cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D03539AF0>]}
[0m00:49:21.862647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83a91785-d59b-4f55-85e8-0f60ac7b11cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D1474B680>]}
[0m00:49:21.875613 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:49:22.631229 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:49:23.012808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:49:23.012808 [debug] [MainThread]: Partial parsing: added file: real_estate_project_dbt://snapshots\listings_snapshot.sql
[0m00:49:23.522529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83a91785-d59b-4f55-85e8-0f60ac7b11cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D162BFAA0>]}
[0m00:49:23.761994 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:49:23.763787 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:49:23.834096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83a91785-d59b-4f55-85e8-0f60ac7b11cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D034FD2B0>]}
[0m00:49:23.836888 [info ] [MainThread]: Found 5 models, 1 snapshot, 476 macros
[0m00:49:23.836888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83a91785-d59b-4f55-85e8-0f60ac7b11cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D13297FB0>]}
[0m00:49:23.844371 [info ] [MainThread]: 
[0m00:49:23.845456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:49:23.848013 [info ] [MainThread]: 
[0m00:49:23.851243 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:49:23.855627 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m00:49:24.064625 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:49:24.064625 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:49:24.064625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:49:26.334007 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.268 seconds
[0m00:49:26.334007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE, now create_REAL_ESTATE_LISTNGS)
[0m00:49:26.345046 [debug] [ThreadPool]: Creating schema "database: "REAL_ESTATE"
schema: "LISTNGS"
"
[0m00:49:26.362670 [debug] [ThreadPool]: Using snowflake connection "create_REAL_ESTATE_LISTNGS"
[0m00:49:26.364116 [debug] [ThreadPool]: On create_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "create_REAL_ESTATE_LISTNGS"} */
create schema if not exists REAL_ESTATE.LISTNGS
[0m00:49:26.669036 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.304 seconds
[0m00:49:26.693270 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m00:49:26.734253 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:49:26.742348 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:49:26.742348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:49:28.052203 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.308 seconds
[0m00:49:28.064667 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:49:28.064667 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m00:49:28.248108 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.185 seconds
[0m00:49:28.267762 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:49:28.269783 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:49:28.412679 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.141 seconds
[0m00:49:28.412679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTNGS)
[0m00:49:28.412679 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m00:49:28.428925 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:49:28.564325 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.134 seconds
[0m00:49:28.568930 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m00:49:28.568930 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
show objects in REAL_ESTATE.LISTNGS
    limit 10000
    
;
[0m00:49:28.717508 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.143 seconds
[0m00:49:28.717508 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m00:49:28.717508 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:49:28.869945 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.144 seconds
[0m00:49:28.869945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83a91785-d59b-4f55-85e8-0f60ac7b11cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D16170AD0>]}
[0m00:49:28.893058 [debug] [Thread-1 (]: Began running node snapshot.real_estate_project_dbt.listings_snapshots
[0m00:49:28.895795 [info ] [Thread-1 (]: 1 of 1 START snapshot LISTNGS.listings_snapshots ............................... [RUN]
[0m00:49:28.898795 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.real_estate_project_dbt.listings_snapshots'
[0m00:49:28.900442 [debug] [Thread-1 (]: Began compiling node snapshot.real_estate_project_dbt.listings_snapshots
[0m00:49:28.934875 [debug] [Thread-1 (]: Began executing node snapshot.real_estate_project_dbt.listings_snapshots
[0m00:49:29.113577 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m00:49:29.125311 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:49:29.125311 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:49:30.765612 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.641 seconds
[0m00:49:30.779571 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m00:49:30.779571 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m00:49:30.965332 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.185 seconds
[0m00:49:30.965332 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.real_estate_project_dbt.listings_snapshots"
[0m00:49:30.980769 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m00:49:30.980769 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
create or replace transient table REAL_ESTATE.LISTNGS.listings_snapshots
    

    
    as (
    

    select *,
        md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED

    ) sbq



    )
;
[0m00:49:32.098024 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.112 seconds
[0m00:49:32.254767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83a91785-d59b-4f55-85e8-0f60ac7b11cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D00B1A150>]}
[0m00:49:32.254767 [info ] [Thread-1 (]: 1 of 1 OK snapshotted LISTNGS.listings_snapshots ............................... [[32mSUCCESS 1[0m in 3.35s]
[0m00:49:32.260783 [debug] [Thread-1 (]: Finished running node snapshot.real_estate_project_dbt.listings_snapshots
[0m00:49:32.264095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:49:32.264095 [debug] [MainThread]: Connection 'create_REAL_ESTATE_LISTNGS' was left open.
[0m00:49:32.267287 [debug] [MainThread]: On create_REAL_ESTATE_LISTNGS: Close
[0m00:49:32.453520 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTNGS' was left open.
[0m00:49:32.453520 [debug] [MainThread]: On list_REAL_ESTATE_LISTNGS: Close
[0m00:49:32.659580 [debug] [MainThread]: Connection 'snapshot.real_estate_project_dbt.listings_snapshots' was left open.
[0m00:49:32.662354 [debug] [MainThread]: On snapshot.real_estate_project_dbt.listings_snapshots: Close
[0m00:49:32.867962 [info ] [MainThread]: 
[0m00:49:32.867962 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 9.02 seconds (9.02s).
[0m00:49:32.872756 [debug] [MainThread]: Command end result
[0m00:49:32.998507 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:49:33.002811 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:49:33.033199 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m00:49:33.041422 [info ] [MainThread]: 
[0m00:49:33.043447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:49:33.053775 [info ] [MainThread]: 
[0m00:49:33.055367 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:49:33.057387 [debug] [MainThread]: Command `dbt snapshot` succeeded at 00:49:33.057387 after 14.02 seconds
[0m00:49:33.057387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D03097E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D162F7E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D031C9EE0>]}
[0m00:49:33.064989 [debug] [MainThread]: Flushing usage events
[0m00:49:34.450624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:46.932662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D83E645550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D83EA6C620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8417F86B0>]}


============================== 00:58:46.942319 | 8f760f0a-554f-4e0d-8892-5ac3f1ce82ee ==============================
[0m00:58:46.942319 [info ] [MainThread]: Running with dbt=1.10.1
[0m00:58:46.944718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:58:49.501649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f760f0a-554f-4e0d-8892-5ac3f1ce82ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D853DC98E0>]}
[0m00:58:49.628080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f760f0a-554f-4e0d-8892-5ac3f1ce82ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D853CDBFE0>]}
[0m00:58:49.633474 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m00:58:50.221635 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m00:58:50.585007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:58:50.585007 [debug] [MainThread]: Partial parsing: added file: real_estate_project_dbt://models\example\price_growth_from_snapshot.sql
[0m00:58:51.077603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f760f0a-554f-4e0d-8892-5ac3f1ce82ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8544738C0>]}
[0m00:58:51.377526 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:58:51.377526 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:58:51.461254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f760f0a-554f-4e0d-8892-5ac3f1ce82ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D85439FE60>]}
[0m00:58:51.473644 [info ] [MainThread]: Found 6 models, 1 snapshot, 476 macros
[0m00:58:51.473644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f760f0a-554f-4e0d-8892-5ac3f1ce82ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D83B3368D0>]}
[0m00:58:51.473644 [info ] [MainThread]: 
[0m00:58:51.473644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:58:51.487747 [info ] [MainThread]: 
[0m00:58:51.488959 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:58:51.512128 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m00:58:51.713915 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:58:51.713915 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:58:51.713915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:53.563233 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.844 seconds
[0m00:58:53.578657 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m00:58:53.586640 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m00:58:53.718386 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.132 seconds
[0m00:58:53.729531 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m00:58:53.773260 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:58:53.773260 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:58:53.778383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:55.148052 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.371 seconds
[0m00:58:55.162315 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:58:55.162315 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m00:58:55.304430 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.148 seconds
[0m00:58:55.320533 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m00:58:55.320533 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:58:55.466282 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.152 seconds
[0m00:58:55.482087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTNGS)
[0m00:58:55.482087 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m00:58:55.497864 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:58:55.617055 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.120 seconds
[0m00:58:55.626038 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m00:58:55.627062 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
show objects in REAL_ESTATE.LISTNGS
    limit 10000
    
;
[0m00:58:55.790979 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.161 seconds
[0m00:58:55.796111 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m00:58:55.796111 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:58:55.921405 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.123 seconds
[0m00:58:55.926577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTNGS, now list_REAL_ESTATE_LISTINGS)
[0m00:58:55.929817 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:58:55.929817 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m00:58:56.054316 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.119 seconds
[0m00:58:56.054316 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:58:56.054316 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m00:58:56.229221 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.157 seconds
[0m00:58:56.230749 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m00:58:56.230749 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m00:58:56.358918 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.126 seconds
[0m00:58:56.374936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f760f0a-554f-4e0d-8892-5ac3f1ce82ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8547ACEC0>]}
[0m00:58:56.390875 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m00:58:56.391890 [info ] [Thread-1 (]: 1 of 6 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m00:58:56.396163 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.city_avaerage_price'
[0m00:58:56.396163 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m00:58:56.419883 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:58:56.430342 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m00:58:56.520897 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m00:58:56.520897 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m00:58:56.520897 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m00:58:56.520897 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:58:57.858172 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.335 seconds
[0m00:58:57.950391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f760f0a-554f-4e0d-8892-5ac3f1ce82ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D840F13CE0>]}
[0m00:58:57.952409 [info ] [Thread-1 (]: 1 of 6 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 1.55s]
[0m00:58:57.955463 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m00:58:57.957480 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_level_aggregates
[0m00:58:57.960786 [info ] [Thread-1 (]: 2 of 6 START sql table model LISTINGS_LISTINGS.city_level_aggregates ........... [RUN]
[0m00:58:57.960786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.city_level_aggregates)
[0m00:58:57.964720 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_level_aggregates
[0m00:58:57.983043 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:58:57.987820 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_level_aggregates
[0m00:58:58.073628 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_level_aggregates"
[0m00:58:58.076388 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_level_aggregates"
[0m00:58:58.077520 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_level_aggregates: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_level_aggregates"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates
    

    
    as (


WITH city_levels AS (
    SELECT CLEAN_CITY_NAME AS CITY_NAME,
    COUNT(PROP_ID) AS TOTAL_LISTINGS,
    AVG(PRICE) AS AVG_PRICE,
    MAX(TOTAL_FLOOR) AS MAX_FLOOR,
    AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT * FROM city_levels
    )
;
[0m00:58:59.193806 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.117 seconds
[0m00:58:59.197905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f760f0a-554f-4e0d-8892-5ac3f1ce82ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8548A4C50>]}
[0m00:58:59.197905 [info ] [Thread-1 (]: 2 of 6 OK created sql table model LISTINGS_LISTINGS.city_level_aggregates ...... [[32mSUCCESS 1[0m in 1.24s]
[0m00:58:59.197905 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_level_aggregates
[0m00:58:59.213794 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.price_growth_from_snapshot
[0m00:58:59.215148 [info ] [Thread-1 (]: 3 of 6 START sql view model LISTINGS.price_growth_from_snapshot ................ [RUN]
[0m00:58:59.217172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_level_aggregates, now model.real_estate_project_dbt.price_growth_from_snapshot)
[0m00:58:59.220638 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.price_growth_from_snapshot
[0m00:58:59.231890 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.price_growth_from_snapshot"
[0m00:58:59.237709 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.price_growth_from_snapshot
[0m00:58:59.251745 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.price_growth_from_snapshot"
[0m00:58:59.263222 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.price_growth_from_snapshot"
[0m00:58:59.264570 [debug] [Thread-1 (]: On model.real_estate_project_dbt.price_growth_from_snapshot: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.price_growth_from_snapshot"} */
create or replace   view REAL_ESTATE.LISTINGS.price_growth_from_snapshot
  
   as (
    WITH prices AS(
    SELECT 
        PROP_ID,
        PRICE,
        dbt_valid_from,
        dbt_valid_to,
        ROW_NUMBER() OVER( PARTITION BY PROP_ID ORDER BY dbt_valid_from) AS version
    FROM REAL_ESTATE.LISTNGS.listings_snapshots
)

SELECT
   a.PROP_ID,
   a.dbt_valid_from AS CURRENT_DATE,
   a.PRICE AS CURRENT_PRICE,
   b.PRICE AS PERVIOUS_PRICE,
   ROUND((a.PRICE -b.PRICE) /NULLIF(b.PRICE, 0),4) AS PRICE_CHANGE_PERCENT
FROM prices a
LEFT JOIN prices B 
  ON a.PROP_ID = b.PROP_ID AND a.version = b.version + 1
  );
[0m00:58:59.501021 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.233 seconds
[0m00:58:59.509124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f760f0a-554f-4e0d-8892-5ac3f1ce82ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8547DEF30>]}
[0m00:58:59.512600 [info ] [Thread-1 (]: 3 of 6 OK created sql view model LISTINGS.price_growth_from_snapshot ........... [[32mSUCCESS 1[0m in 0.29s]
[0m00:58:59.518523 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.price_growth_from_snapshot
[0m00:58:59.520542 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m00:58:59.520542 [info ] [Thread-1 (]: 4 of 6 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m00:58:59.526945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.price_growth_from_snapshot, now model.real_estate_project_dbt.property_distribution)
[0m00:58:59.529060 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m00:58:59.541697 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m00:58:59.547972 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m00:58:59.557413 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m00:58:59.569034 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m00:58:59.573165 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m00:59:00.528366 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.953 seconds
[0m00:59:00.536441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f760f0a-554f-4e0d-8892-5ac3f1ce82ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8548F1D00>]}
[0m00:59:00.540484 [info ] [Thread-1 (]: 4 of 6 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 1.01s]
[0m00:59:00.544298 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m00:59:00.544298 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:59:00.544298 [info ] [Thread-1 (]: 5 of 6 START sql table model LISTINGS_LISTINGS.property_type_price_comparison .. [RUN]
[0m00:59:00.553151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_type_price_comparison)
[0m00:59:00.555029 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_type_price_comparison
[0m00:59:00.570424 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:59:00.571833 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_type_price_comparison
[0m00:59:00.586751 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:59:00.600828 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_type_price_comparison"
[0m00:59:00.600828 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_type_price_comparison: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_type_price_comparison"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_type_price_comparison
    

    
    as (

-- Step 1: Get overall average price across all cities
WITH overall_avg_price_cte AS (
    SELECT AVG(PRICE) AS overall_avg_price
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

-- Step 2: City-level aggregates (do not use CASE here!)
city_level_aggregates_cte AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        COUNT(PROP_ID) AS TOTAL_LISTINGS,
        AVG(PRICE) AS AVG_PRICE,
        MAX(TOTAL_FLOOR) AS MAX_FLOOR,
        AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

-- Step 3: Add price category by comparing to overall average
SELECT
    city.*,
    CASE
        WHEN city.AVG_PRICE > overall.overall_avg_price * 1.2 THEN 'Overpriced'
        ELSE 'Fair'
    END AS PRICE_CATEGORY
FROM city_level_aggregates_cte city
CROSS JOIN overall_avg_price_cte overall
    )
;
[0m00:59:01.241742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m00:59:01.247781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f760f0a-554f-4e0d-8892-5ac3f1ce82ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8548FE1B0>]}
[0m00:59:01.247781 [info ] [Thread-1 (]: 5 of 6 OK created sql table model LISTINGS_LISTINGS.property_type_price_comparison  [[32mSUCCESS 1[0m in 0.70s]
[0m00:59:01.249803 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_type_price_comparison
[0m00:59:01.252208 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m00:59:01.252208 [info ] [Thread-1 (]: 6 of 6 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m00:59:01.252208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_type_price_comparison, now model.real_estate_project_dbt.property_value_index)
[0m00:59:01.257613 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m00:59:01.267024 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m00:59:01.269102 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m00:59:01.269102 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m00:59:01.283135 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m00:59:01.283135 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
        PROP_ID,
        CLEAN_CITY_NAME,
        PRICE,
        AGE,
        TOTAL_FLOOR,
        BEDROOM_NUM,

        -- Score calculations
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,
        1 - PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

scored AS (
    SELECT
        *,
        ROUND(
            0.4 * PRICE_SCORE +
            0.2 * AGE_SCORE +
            0.2 * FLOOR_SCORE +
            0.2 * BEDROOM_SCORE, 4
        ) AS FINAL_VALUE_SCORE
    FROM ranked
),

-- ✅ Only call NTILE(10) once and reuse it
luxury_tagged AS (
    SELECT
        *,
        NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY FINAL_VALUE_SCORE DESC) AS decile
    FROM scored
)

SELECT
    *,
    CASE
        WHEN decile = 1 THEN TRUE
        ELSE FALSE
    END AS IS_LUXURY
FROM luxury_tagged
ORDER BY CLEAN_CITY_NAME, FINAL_VALUE_SCORE DESC
  );
[0m00:59:01.538231 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.249 seconds
[0m00:59:01.544268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f760f0a-554f-4e0d-8892-5ac3f1ce82ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D854923EF0>]}
[0m00:59:01.545281 [info ] [Thread-1 (]: 6 of 6 OK created sql view model LISTINGS_LISTINGS.property_value_index ........ [[32mSUCCESS 1[0m in 0.29s]
[0m00:59:01.545281 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m00:59:01.551882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:59:01.551882 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m00:59:01.551882 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m00:59:01.751402 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS' was left open.
[0m00:59:01.751402 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS: Close
[0m00:59:01.954674 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.property_value_index' was left open.
[0m00:59:01.954674 [debug] [MainThread]: On model.real_estate_project_dbt.property_value_index: Close
[0m00:59:02.179817 [info ] [MainThread]: 
[0m00:59:02.185994 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 10.69 seconds (10.69s).
[0m00:59:02.185994 [debug] [MainThread]: Command end result
[0m00:59:02.281823 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m00:59:02.289859 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m00:59:02.306183 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m00:59:02.314209 [info ] [MainThread]: 
[0m00:59:02.315428 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:59:02.317347 [info ] [MainThread]: 
[0m00:59:02.317347 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m00:59:02.317347 [debug] [MainThread]: Command `dbt run` succeeded at 00:59:02.317347 after 15.76 seconds
[0m00:59:02.317347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D841763E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8407191F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D840719FD0>]}
[0m00:59:02.317347 [debug] [MainThread]: Flushing usage events
[0m00:59:04.212068 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:30:53.028337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D635D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D62EEF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D62EF290>]}


============================== 01:30:53.036523 | a81d56fb-e8c1-4909-8043-94472cf0ecd7 ==============================
[0m01:30:53.036523 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:30:53.036523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:30:55.843301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a81d56fb-e8c1-4909-8043-94472cf0ecd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E79D17C0>]}
[0m01:30:55.933533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a81d56fb-e8c1-4909-8043-94472cf0ecd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D635C350>]}
[0m01:30:55.949259 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:30:56.534529 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:30:57.100228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:57.100228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:57.141549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a81d56fb-e8c1-4909-8043-94472cf0ecd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E8B2A6C0>]}
[0m01:30:57.252001 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m01:30:57.265198 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m01:30:57.293222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a81d56fb-e8c1-4909-8043-94472cf0ecd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E8F67FB0>]}
[0m01:30:57.293222 [info ] [MainThread]: Found 6 models, 1 snapshot, 476 macros
[0m01:30:57.293222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a81d56fb-e8c1-4909-8043-94472cf0ecd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E8F89CA0>]}
[0m01:30:57.293222 [info ] [MainThread]: 
[0m01:30:57.293222 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:30:57.293222 [info ] [MainThread]: 
[0m01:30:57.299629 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:57.299629 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m01:30:58.116126 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m01:30:58.116126 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m01:30:58.116126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:59.508112 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.397 seconds
[0m01:30:59.527929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m01:30:59.540133 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:30:59.540133 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:30:59.540133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:00.627216 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.085 seconds
[0m01:31:00.641169 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:31:00.643167 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m01:31:00.852061 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.209 seconds
[0m01:31:00.852061 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:31:00.852061 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:31:00.976518 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.120 seconds
[0m01:31:00.976518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTNGS)
[0m01:31:00.976518 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m01:31:00.984955 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:31:01.210140 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.225 seconds
[0m01:31:01.214182 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m01:31:01.216197 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
show objects in REAL_ESTATE.LISTNGS
    limit 10000
    
;
[0m01:31:01.362592 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.155 seconds
[0m01:31:01.362592 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m01:31:01.378776 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:31:01.506683 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.140 seconds
[0m01:31:01.522808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTNGS, now list_REAL_ESTATE_LISTINGS)
[0m01:31:01.522808 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:31:01.522808 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:31:01.651937 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.125 seconds
[0m01:31:01.651937 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:31:01.651937 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m01:31:01.870802 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.215 seconds
[0m01:31:01.870802 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:31:01.870802 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:31:01.999563 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.132 seconds
[0m01:31:01.999563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a81d56fb-e8c1-4909-8043-94472cf0ecd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D3A64800>]}
[0m01:31:02.015575 [debug] [Thread-1 (]: Began running node snapshot.real_estate_project_dbt.listings_snapshots
[0m01:31:02.015575 [info ] [Thread-1 (]: 1 of 1 START snapshot LISTNGS.listings_snapshots ............................... [RUN]
[0m01:31:02.015575 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.real_estate_project_dbt.listings_snapshots'
[0m01:31:02.015575 [debug] [Thread-1 (]: Began compiling node snapshot.real_estate_project_dbt.listings_snapshots
[0m01:31:02.015575 [debug] [Thread-1 (]: Began executing node snapshot.real_estate_project_dbt.listings_snapshots
[0m01:31:02.087573 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:31:02.087573 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        select PRICE from (
                



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m01:31:02.088608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:31:03.481566 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.396 seconds
[0m01:31:03.481566 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:31:03.481566 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m01:31:03.626510 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.138 seconds
[0m01:31:03.640592 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:31:03.640592 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m01:31:03.769686 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.131 seconds
[0m01:31:03.821835 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:31:03.821835 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
create or replace temporary table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED


    ),

    snapshotted_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    

        from "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m01:31:05.165434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.333 seconds
[0m01:31:05.165434 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:31:05.165434 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m01:31:05.329498 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.155 seconds
[0m01:31:05.333025 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:31:05.335030 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m01:31:05.486262 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.152 seconds
[0m01:31:05.486262 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:31:05.486262 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m01:31:05.668023 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.187 seconds
[0m01:31:05.683912 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:31:05.683912 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m01:31:05.795294 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.113 seconds
[0m01:31:05.795294 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:31:05.795294 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m01:31:05.926572 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.119 seconds
[0m01:31:05.971696 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:31:05.971696 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED


    ),

    snapshotted_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    

        from "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m01:31:06.276509 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.311 seconds
[0m01:31:06.276509 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:31:06.276509 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:31:06.389824 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.112 seconds
[0m01:31:06.389824 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:31:06.405553 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:31:06.405553 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
BEGIN
[0m01:31:06.569739 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.161 seconds
[0m01:31:06.569739 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:31:06.569739 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
merge into "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS" as DBT_INTERNAL_DEST
    using "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("PROP_ID", "PROPERTY_TYPE", "CITY", "PRICE", "PRICE_PER_UNIT_AREA", "BEDROOM_NUM", "AGE", "TOTAL_FLOOR", "PRICE_SQFT", "CLEAN_CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("PROP_ID", "PROPERTY_TYPE", "CITY", "PRICE", "PRICE_PER_UNIT_AREA", "BEDROOM_NUM", "AGE", "TOTAL_FLOOR", "PRICE_SQFT", "CLEAN_CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:31:07.342203 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd34d1-3201-b7cb-000e-047200013696
[0m01:31:07.342203 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m01:31:07.357835 [debug] [Thread-1 (]: Database Error in snapshot listings_snapshots (snapshots\listings_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target\run\real_estate_project_dbt\snapshots\listings_snapshot.sql
[0m01:31:07.359841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a81d56fb-e8c1-4909-8043-94472cf0ecd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D5C3BB30>]}
[0m01:31:07.359841 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting LISTNGS.listings_snapshots ........................... [[31mERROR[0m in 5.34s]
[0m01:31:07.362506 [debug] [Thread-1 (]: Finished running node snapshot.real_estate_project_dbt.listings_snapshots
[0m01:31:07.362506 [debug] [Thread-4 (]: Marking all children of 'snapshot.real_estate_project_dbt.listings_snapshots' to be skipped because of status 'error'.  Reason: Database Error in snapshot listings_snapshots (snapshots\listings_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target\run\real_estate_project_dbt\snapshots\listings_snapshot.sql.
[0m01:31:07.362506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:07.362506 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m01:31:07.362506 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m01:31:07.669224 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS' was left open.
[0m01:31:07.669224 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS: Close
[0m01:31:07.870895 [debug] [MainThread]: Connection 'snapshot.real_estate_project_dbt.listings_snapshots' was left open.
[0m01:31:07.870895 [debug] [MainThread]: On snapshot.real_estate_project_dbt.listings_snapshots: Close
[0m01:31:08.077121 [info ] [MainThread]: 
[0m01:31:08.077121 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 10.78 seconds (10.78s).
[0m01:31:08.078379 [debug] [MainThread]: Command end result
[0m01:31:08.100452 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m01:31:08.100452 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m01:31:08.106638 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m01:31:08.106638 [info ] [MainThread]: 
[0m01:31:08.106638 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:31:08.106638 [info ] [MainThread]: 
[0m01:31:08.106638 [error] [MainThread]: [31mFailure in snapshot listings_snapshots (snapshots\listings_snapshot.sql)[0m
[0m01:31:08.106638 [error] [MainThread]:   Database Error in snapshot listings_snapshots (snapshots\listings_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target\run\real_estate_project_dbt\snapshots\listings_snapshot.sql
[0m01:31:08.106638 [info ] [MainThread]: 
[0m01:31:08.106638 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:31:08.106638 [debug] [MainThread]: Command `dbt snapshot` failed at 01:31:08.106638 after 15.31 seconds
[0m01:31:08.106638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192E78FFBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D53399D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192D64BFEF0>]}
[0m01:31:08.106638 [debug] [MainThread]: Flushing usage events
[0m01:31:09.385477 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:10.215063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155F046B8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155F03AC500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155F2F54410>]}


============================== 01:37:10.230784 | 77e3002c-7e1b-4193-8ed6-d70ca6f4d784 ==============================
[0m01:37:10.230784 [info ] [MainThread]: Running with dbt=1.10.1
[0m01:37:10.230784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m01:37:11.502372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77e3002c-7e1b-4193-8ed6-d70ca6f4d784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001558560BE90>]}
[0m01:37:11.613440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77e3002c-7e1b-4193-8ed6-d70ca6f4d784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015584321E50>]}
[0m01:37:11.613440 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m01:37:12.053322 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m01:37:12.243667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:37:12.243667 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:37:12.284367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77e3002c-7e1b-4193-8ed6-d70ca6f4d784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015585805A30>]}
[0m01:37:12.378973 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m01:37:12.394663 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m01:37:12.421807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77e3002c-7e1b-4193-8ed6-d70ca6f4d784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155857C7E60>]}
[0m01:37:12.421807 [info ] [MainThread]: Found 6 models, 1 snapshot, 476 macros
[0m01:37:12.421807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77e3002c-7e1b-4193-8ed6-d70ca6f4d784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015585755520>]}
[0m01:37:12.426320 [info ] [MainThread]: 
[0m01:37:12.426320 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:37:12.426320 [info ] [MainThread]: 
[0m01:37:12.426320 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:37:12.426320 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m01:37:12.511800 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m01:37:12.512800 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m01:37:12.512800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:14.050123 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.544 seconds
[0m01:37:14.066172 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS'
[0m01:37:14.081930 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:37:14.081930 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:37:14.081930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:15.273386 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.197 seconds
[0m01:37:15.273386 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:37:15.273386 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m01:37:15.535290 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.254 seconds
[0m01:37:15.535290 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m01:37:15.535290 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:37:15.947180 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.406 seconds
[0m01:37:15.955258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS, now list_REAL_ESTATE_LISTINGS_LISTINGS)
[0m01:37:15.964286 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:37:15.964286 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:37:16.099123 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.136 seconds
[0m01:37:16.099123 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:37:16.099123 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m01:37:16.259605 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.150 seconds
[0m01:37:16.259605 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m01:37:16.259605 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:37:16.374831 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m01:37:16.374831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTNGS)
[0m01:37:16.388065 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m01:37:16.388065 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m01:37:16.568754 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.180 seconds
[0m01:37:16.568754 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m01:37:16.568754 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
show objects in REAL_ESTATE.LISTNGS
    limit 10000
    
;
[0m01:37:16.713155 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.138 seconds
[0m01:37:16.713155 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m01:37:16.713155 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m01:37:16.859778 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.137 seconds
[0m01:37:16.859778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77e3002c-7e1b-4193-8ed6-d70ca6f4d784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155F0668530>]}
[0m01:37:16.868737 [debug] [Thread-1 (]: Began running node snapshot.real_estate_project_dbt.listings_snapshots
[0m01:37:16.868737 [info ] [Thread-1 (]: 1 of 1 START snapshot LISTNGS.listings_snapshots ............................... [RUN]
[0m01:37:16.868737 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.real_estate_project_dbt.listings_snapshots'
[0m01:37:16.868737 [debug] [Thread-1 (]: Began compiling node snapshot.real_estate_project_dbt.listings_snapshots
[0m01:37:16.874345 [debug] [Thread-1 (]: Began executing node snapshot.real_estate_project_dbt.listings_snapshots
[0m01:37:16.943330 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:37:16.944330 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        select PRICE from (
                



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m01:37:16.944330 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:37:18.402910 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.461 seconds
[0m01:37:18.426004 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:37:18.426004 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m01:37:18.919352 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.483 seconds
[0m01:37:18.939245 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:37:18.939245 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m01:37:19.068183 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.131 seconds
[0m01:37:19.122064 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:37:19.122064 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
create or replace temporary table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED


    ),

    snapshotted_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    

        from "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m01:37:19.903471 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m01:37:19.916944 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:37:19.918956 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m01:37:20.093009 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.176 seconds
[0m01:37:20.093009 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:37:20.093009 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m01:37:20.221767 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.121 seconds
[0m01:37:20.221767 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:37:20.221767 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m01:37:20.377175 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.151 seconds
[0m01:37:20.386767 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:37:20.386767 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m01:37:20.499483 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.118 seconds
[0m01:37:20.515416 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:37:20.515416 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m01:37:20.639383 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.113 seconds
[0m01:37:20.675604 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:37:20.675604 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED


    ),

    snapshotted_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    

        from "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m01:37:21.211463 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.539 seconds
[0m01:37:21.211463 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:37:21.211463 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:37:21.370931 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.150 seconds
[0m01:37:21.370931 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:37:21.370931 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:37:21.370931 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
BEGIN
[0m01:37:21.570674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m01:37:21.572689 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:37:21.572689 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
merge into "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS" as DBT_INTERNAL_DEST
    using "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("PROP_ID", "PROPERTY_TYPE", "CITY", "PRICE", "PRICE_PER_UNIT_AREA", "BEDROOM_NUM", "AGE", "TOTAL_FLOOR", "PRICE_SQFT", "CLEAN_CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("PROP_ID", "PROPERTY_TYPE", "CITY", "PRICE", "PRICE_PER_UNIT_AREA", "BEDROOM_NUM", "AGE", "TOTAL_FLOOR", "PRICE_SQFT", "CLEAN_CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:37:21.986574 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.416 seconds
[0m01:37:21.986574 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m01:37:21.986574 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
COMMIT
[0m01:37:22.140184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m01:37:22.180215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77e3002c-7e1b-4193-8ed6-d70ca6f4d784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155F2833DA0>]}
[0m01:37:22.180215 [info ] [Thread-1 (]: 1 of 1 OK snapshotted LISTNGS.listings_snapshots ............................... [[32mSUCCESS 0[0m in 5.31s]
[0m01:37:22.180215 [debug] [Thread-1 (]: Finished running node snapshot.real_estate_project_dbt.listings_snapshots
[0m01:37:22.180215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:37:22.180215 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m01:37:22.180215 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m01:37:22.387481 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTNGS' was left open.
[0m01:37:22.397806 [debug] [MainThread]: On list_REAL_ESTATE_LISTNGS: Close
[0m01:37:22.658529 [debug] [MainThread]: Connection 'snapshot.real_estate_project_dbt.listings_snapshots' was left open.
[0m01:37:22.658529 [debug] [MainThread]: On snapshot.real_estate_project_dbt.listings_snapshots: Close
[0m01:37:23.002158 [info ] [MainThread]: 
[0m01:37:23.002158 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 10.58 seconds (10.58s).
[0m01:37:23.018181 [debug] [MainThread]: Command end result
[0m01:37:23.042876 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m01:37:23.044888 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m01:37:23.045890 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m01:37:23.045890 [info ] [MainThread]: 
[0m01:37:23.045890 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:37:23.045890 [info ] [MainThread]: 
[0m01:37:23.045890 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:37:23.045890 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:37:23.045890 after 13.03 seconds
[0m01:37:23.055342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155F2AD0B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155F31E7EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155F2EDCFE0>]}
[0m01:37:23.055342 [debug] [MainThread]: Flushing usage events
[0m01:37:24.375864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:11.640029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF3EBBB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF68FC500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF3DFC6B0>]}


============================== 13:12:11.658803 | 103ab880-0852-4cfb-9148-fde476e5f5e5 ==============================
[0m13:12:11.658803 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:12:11.661667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:12:20.048456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '103ab880-0852-4cfb-9148-fde476e5f5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F8AA64470>]}
[0m13:12:20.167136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '103ab880-0852-4cfb-9148-fde476e5f5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F8821D2E0>]}
[0m13:12:20.167136 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m13:12:21.128130 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:12:23.910422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:23.910422 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:24.003545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '103ab880-0852-4cfb-9148-fde476e5f5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F8ACA24B0>]}
[0m13:12:24.257616 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m13:12:24.274753 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m13:12:24.338801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '103ab880-0852-4cfb-9148-fde476e5f5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F8AE405C0>]}
[0m13:12:24.338801 [info ] [MainThread]: Found 6 models, 1 snapshot, 476 macros
[0m13:12:24.338801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '103ab880-0852-4cfb-9148-fde476e5f5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F8AB9B320>]}
[0m13:12:24.349241 [info ] [MainThread]: 
[0m13:12:24.351761 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:12:24.351761 [info ] [MainThread]: 
[0m13:12:24.351761 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:12:24.355402 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m13:12:29.922374 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m13:12:29.922374 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m13:12:29.922374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:32.146186 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.223 seconds
[0m13:12:32.170294 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS'
[0m13:12:32.209732 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m13:12:32.209732 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:12:32.209732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:33.642418 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.427 seconds
[0m13:12:33.652283 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m13:12:33.652283 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m13:12:33.841229 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.184 seconds
[0m13:12:33.841229 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m13:12:33.854138 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:12:34.025675 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.172 seconds
[0m13:12:34.025675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS, now list_REAL_ESTATE_LISTINGS_LISTINGS)
[0m13:12:34.035767 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m13:12:34.035767 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:12:34.179587 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.134 seconds
[0m13:12:34.179587 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m13:12:34.179587 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m13:12:34.348435 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.162 seconds
[0m13:12:34.363138 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m13:12:34.363138 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:12:34.497674 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.133 seconds
[0m13:12:34.497674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTNGS)
[0m13:12:34.512695 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m13:12:34.512695 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:12:34.641061 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.132 seconds
[0m13:12:34.656986 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m13:12:34.656986 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
show objects in REAL_ESTATE.LISTNGS
    limit 10000
    
;
[0m13:12:34.801162 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.140 seconds
[0m13:12:34.805761 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m13:12:34.807196 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:12:34.936569 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.127 seconds
[0m13:12:34.942229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '103ab880-0852-4cfb-9148-fde476e5f5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF422ADE0>]}
[0m13:12:34.959751 [debug] [Thread-1 (]: Began running node snapshot.real_estate_project_dbt.listings_snapshots
[0m13:12:34.961759 [info ] [Thread-1 (]: 1 of 1 START snapshot LISTNGS.listings_snapshots ............................... [RUN]
[0m13:12:34.965329 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.real_estate_project_dbt.listings_snapshots'
[0m13:12:34.966729 [debug] [Thread-1 (]: Began compiling node snapshot.real_estate_project_dbt.listings_snapshots
[0m13:12:34.999220 [debug] [Thread-1 (]: Began executing node snapshot.real_estate_project_dbt.listings_snapshots
[0m13:12:35.168139 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:12:35.168139 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m13:12:35.168139 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:12:36.947993 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.786 seconds
[0m13:12:36.959631 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:12:36.959631 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m13:12:37.075723 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.110 seconds
[0m13:12:37.088342 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:12:37.088342 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:12:37.099258 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
create or replace transient table REAL_ESTATE.LISTNGS.listings_snapshots
    

    
    as (
    

    select *,
        md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED

    ) sbq



    )
;
[0m13:12:38.376113 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.275 seconds
[0m13:12:38.456158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '103ab880-0852-4cfb-9148-fde476e5f5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF629BB60>]}
[0m13:12:38.461663 [info ] [Thread-1 (]: 1 of 1 OK snapshotted LISTNGS.listings_snapshots ............................... [[32mSUCCESS 1[0m in 3.49s]
[0m13:12:38.466318 [debug] [Thread-1 (]: Finished running node snapshot.real_estate_project_dbt.listings_snapshots
[0m13:12:38.469675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:38.469675 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m13:12:38.469675 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m13:12:38.651519 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTNGS' was left open.
[0m13:12:38.651519 [debug] [MainThread]: On list_REAL_ESTATE_LISTNGS: Close
[0m13:12:38.884166 [debug] [MainThread]: Connection 'snapshot.real_estate_project_dbt.listings_snapshots' was left open.
[0m13:12:38.884166 [debug] [MainThread]: On snapshot.real_estate_project_dbt.listings_snapshots: Close
[0m13:12:39.076432 [info ] [MainThread]: 
[0m13:12:39.076432 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 14.72 seconds (14.72s).
[0m13:12:39.076432 [debug] [MainThread]: Command end result
[0m13:12:39.188669 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m13:12:39.197010 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m13:12:39.205234 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m13:12:39.205234 [info ] [MainThread]: 
[0m13:12:39.221231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:12:39.221231 [info ] [MainThread]: 
[0m13:12:39.221231 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:12:39.221231 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:12:39.221231 after 27.99 seconds
[0m13:12:39.227553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F898B6EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FF6BC3080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F88120EF0>]}
[0m13:12:39.227553 [debug] [MainThread]: Flushing usage events
[0m13:12:40.931590 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:51.940476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7E81C0470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7E7D05C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7E81C2E40>]}


============================== 13:18:51.951123 | 91518860-b7dd-420a-aeca-5ea879aafdde ==============================
[0m13:18:51.951123 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:18:51.951123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select price_growth_from_snapshots', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:18:54.171359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91518860-b7dd-420a-aeca-5ea879aafdde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7FA2CA630>]}
[0m13:18:54.282339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91518860-b7dd-420a-aeca-5ea879aafdde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7E8190F50>]}
[0m13:18:54.282339 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m13:18:54.861427 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:18:55.063696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:18:55.063696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:18:55.119231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91518860-b7dd-420a-aeca-5ea879aafdde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7FA2610D0>]}
[0m13:18:55.238751 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m13:18:55.238751 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m13:18:55.285659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91518860-b7dd-420a-aeca-5ea879aafdde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7FA782540>]}
[0m13:18:55.285659 [info ] [MainThread]: Found 6 models, 1 snapshot, 476 macros
[0m13:18:55.285659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91518860-b7dd-420a-aeca-5ea879aafdde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7FA624E60>]}
[0m13:18:55.297820 [warn ] [MainThread]: The selection criterion 'price_growth_from_snapshots' does not match any enabled nodes
[0m13:18:55.300097 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:18:55.304756 [debug] [MainThread]: Command end result
[0m13:18:55.348900 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m13:18:55.354969 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m13:18:55.361002 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m13:18:55.361002 [debug] [MainThread]: Command `dbt run` succeeded at 13:18:55.361002 after 3.86 seconds
[0m13:18:55.365690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7E7E968D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7FA747F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7FA735880>]}
[0m13:18:55.365690 [debug] [MainThread]: Flushing usage events
[0m13:18:57.066311 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:19:40.311696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E983C44EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98201C6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E984CE8920>]}


============================== 13:19:40.317449 | c3927451-8325-4941-8c5e-635759a29fed ==============================
[0m13:19:40.317449 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:19:40.317449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select price_growth_from_snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:19:42.106954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3927451-8325-4941-8c5e-635759a29fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9851BDD00>]}
[0m13:19:42.219004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3927451-8325-4941-8c5e-635759a29fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E985238B30>]}
[0m13:19:42.219004 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m13:19:42.782723 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:19:42.980954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:19:42.980954 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:19:43.029876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3927451-8325-4941-8c5e-635759a29fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9973C7C80>]}
[0m13:19:43.155240 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m13:19:43.155240 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m13:19:43.188164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3927451-8325-4941-8c5e-635759a29fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9977B2690>]}
[0m13:19:43.188164 [info ] [MainThread]: Found 6 models, 1 snapshot, 476 macros
[0m13:19:43.202739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3927451-8325-4941-8c5e-635759a29fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9973E5130>]}
[0m13:19:43.202739 [info ] [MainThread]: 
[0m13:19:43.202739 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:19:43.202739 [info ] [MainThread]: 
[0m13:19:43.202739 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:19:43.208768 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m13:19:43.315484 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m13:19:43.315484 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m13:19:43.315484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:45.608968 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.284 seconds
[0m13:19:45.634921 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m13:19:45.675554 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m13:19:45.675554 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:19:45.675554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:47.058393 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.385 seconds
[0m13:19:47.071632 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m13:19:47.071632 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m13:19:47.244105 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.163 seconds
[0m13:19:47.252189 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m13:19:47.253205 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:19:47.951248 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.707 seconds
[0m13:19:47.967021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTINGS)
[0m13:19:47.967021 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m13:19:47.967021 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:19:48.113902 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.131 seconds
[0m13:19:48.113902 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m13:19:48.113902 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m13:19:48.265582 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.145 seconds
[0m13:19:48.272963 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m13:19:48.272963 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:19:48.402403 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.122 seconds
[0m13:19:48.402403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS, now list_REAL_ESTATE_LISTNGS)
[0m13:19:48.418110 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m13:19:48.418110 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:19:48.572605 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.151 seconds
[0m13:19:48.572605 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m13:19:48.572605 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
show objects in REAL_ESTATE.LISTNGS
    limit 10000
    
;
[0m13:19:48.729902 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.147 seconds
[0m13:19:48.740004 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m13:19:48.743792 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:19:48.884139 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.137 seconds
[0m13:19:48.889001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3927451-8325-4941-8c5e-635759a29fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99720BAA0>]}
[0m13:19:48.889001 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.price_growth_from_snapshot
[0m13:19:48.905514 [info ] [Thread-1 (]: 1 of 1 START sql view model LISTINGS.price_growth_from_snapshot ................ [RUN]
[0m13:19:48.905514 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.price_growth_from_snapshot'
[0m13:19:48.909737 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.price_growth_from_snapshot
[0m13:19:48.940586 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.price_growth_from_snapshot"
[0m13:19:48.950202 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.price_growth_from_snapshot
[0m13:19:49.020276 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.price_growth_from_snapshot"
[0m13:19:49.020276 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.price_growth_from_snapshot"
[0m13:19:49.020276 [debug] [Thread-1 (]: On model.real_estate_project_dbt.price_growth_from_snapshot: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.price_growth_from_snapshot"} */
create or replace   view REAL_ESTATE.LISTINGS.price_growth_from_snapshot
  
   as (
    WITH prices AS(
    SELECT 
        PROP_ID,
        PRICE,
        dbt_valid_from,
        dbt_valid_to,
        ROW_NUMBER() OVER( PARTITION BY PROP_ID ORDER BY dbt_valid_from) AS version
    FROM REAL_ESTATE.LISTNGS.listings_snapshots
)

SELECT
   a.PROP_ID,
   a.dbt_valid_from AS CURRENT_DATE,
   a.PRICE AS CURRENT_PRICE,
   b.PRICE AS PERVIOUS_PRICE,
   ROUND((a.PRICE -b.PRICE) /NULLIF(b.PRICE, 0),4) AS PRICE_CHANGE_PERCENT
FROM prices a
LEFT JOIN prices B 
  ON a.PROP_ID = b.PROP_ID AND a.version = b.version + 1
  );
[0m13:19:49.020276 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:19:50.518320 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.493 seconds
[0m13:19:50.576189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3927451-8325-4941-8c5e-635759a29fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9821FA210>]}
[0m13:19:50.576189 [info ] [Thread-1 (]: 1 of 1 OK created sql view model LISTINGS.price_growth_from_snapshot ........... [[32mSUCCESS 1[0m in 1.66s]
[0m13:19:50.576189 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.price_growth_from_snapshot
[0m13:19:50.582333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:50.583536 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m13:19:50.583536 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m13:19:50.822724 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTNGS' was left open.
[0m13:19:50.822724 [debug] [MainThread]: On list_REAL_ESTATE_LISTNGS: Close
[0m13:19:51.028052 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.price_growth_from_snapshot' was left open.
[0m13:19:51.028052 [debug] [MainThread]: On model.real_estate_project_dbt.price_growth_from_snapshot: Close
[0m13:19:51.237747 [info ] [MainThread]: 
[0m13:19:51.237747 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.04 seconds (8.04s).
[0m13:19:51.237747 [debug] [MainThread]: Command end result
[0m13:19:51.348319 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m13:19:51.354970 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m13:19:51.371706 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m13:19:51.371706 [info ] [MainThread]: 
[0m13:19:51.371706 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:51.388308 [info ] [MainThread]: 
[0m13:19:51.389556 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:19:51.396337 [debug] [MainThread]: Command `dbt run` succeeded at 13:19:51.396016 after 11.32 seconds
[0m13:19:51.397249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E984DC4440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E994CD4800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E984CE9A00>]}
[0m13:19:51.400610 [debug] [MainThread]: Flushing usage events
[0m13:19:52.976886 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:24:12.409148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8DE034E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8DE7312B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8DB96C650>]}


============================== 13:24:12.419442 | 8c8ba653-2b4a-496f-a734-3a30fa745389 ==============================
[0m13:24:12.419442 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:24:12.419442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:24:14.227788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c8ba653-2b4a-496f-a734-3a30fa745389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8EFA6E960>]}
[0m13:24:14.338574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c8ba653-2b4a-496f-a734-3a30fa745389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8EEDFE930>]}
[0m13:24:14.338574 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m13:24:14.844114 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:24:15.059845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:24:15.059845 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:24:15.106942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c8ba653-2b4a-496f-a734-3a30fa745389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8F0DE5E80>]}
[0m13:24:15.218694 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m13:24:15.218694 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m13:24:15.267596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c8ba653-2b4a-496f-a734-3a30fa745389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8F1137800>]}
[0m13:24:15.267596 [info ] [MainThread]: Found 6 models, 1 snapshot, 476 macros
[0m13:24:15.267596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c8ba653-2b4a-496f-a734-3a30fa745389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8F0F86A20>]}
[0m13:24:15.267596 [info ] [MainThread]: 
[0m13:24:15.267596 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:24:15.267596 [info ] [MainThread]: 
[0m13:24:15.267596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:24:15.277677 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m13:24:15.422640 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m13:24:15.422640 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m13:24:15.422640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:17.277869 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.852 seconds
[0m13:24:17.293907 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m13:24:17.341816 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m13:24:17.341816 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:24:17.341816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:18.599758 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.252 seconds
[0m13:24:18.617305 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m13:24:18.617305 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m13:24:18.767287 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.159 seconds
[0m13:24:18.787386 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m13:24:18.789398 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:24:18.904836 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.124 seconds
[0m13:24:18.916867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTNGS)
[0m13:24:18.932883 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m13:24:18.932883 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:24:19.057246 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m13:24:19.060362 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m13:24:19.060362 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
show objects in REAL_ESTATE.LISTNGS
    limit 10000
    
;
[0m13:24:19.202810 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.144 seconds
[0m13:24:19.216016 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m13:24:19.216016 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:24:19.345253 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.124 seconds
[0m13:24:19.345253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTNGS, now list_REAL_ESTATE_LISTINGS)
[0m13:24:19.361133 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m13:24:19.361133 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:24:19.473947 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.120 seconds
[0m13:24:19.489891 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m13:24:19.489891 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m13:24:19.635492 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.155 seconds
[0m13:24:19.651191 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m13:24:19.651191 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:24:19.766614 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.119 seconds
[0m13:24:19.782417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c8ba653-2b4a-496f-a734-3a30fa745389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8DBC30770>]}
[0m13:24:19.798329 [debug] [Thread-1 (]: Began running node snapshot.real_estate_project_dbt.listings_snapshots
[0m13:24:19.803679 [info ] [Thread-1 (]: 1 of 1 START snapshot LISTNGS.listings_snapshots ............................... [RUN]
[0m13:24:19.803679 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.real_estate_project_dbt.listings_snapshots'
[0m13:24:19.809402 [debug] [Thread-1 (]: Began compiling node snapshot.real_estate_project_dbt.listings_snapshots
[0m13:24:19.839759 [debug] [Thread-1 (]: Began executing node snapshot.real_estate_project_dbt.listings_snapshots
[0m13:24:19.955570 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:24:19.955570 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        select PRICE from (
                



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m13:24:19.971542 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:24:21.575970 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.608 seconds
[0m13:24:21.603448 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:24:21.619228 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m13:24:21.763598 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.144 seconds
[0m13:24:21.798981 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:24:21.802363 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m13:24:21.925814 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.126 seconds
[0m13:24:22.051386 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:24:22.051386 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
create or replace temporary table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED


    ),

    snapshotted_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    

        from "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m13:24:23.210730 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.153 seconds
[0m13:24:23.210730 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:24:23.226565 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m13:24:23.353235 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.133 seconds
[0m13:24:23.368944 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:24:23.368944 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m13:24:23.483141 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.114 seconds
[0m13:24:23.483141 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:24:23.483141 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m13:24:23.616668 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.119 seconds
[0m13:24:23.626647 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:24:23.628220 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m13:24:23.756079 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.131 seconds
[0m13:24:23.788437 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:24:23.790646 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m13:24:23.931253 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.140 seconds
[0m13:24:24.007946 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:24:24.007946 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED


    ),

    snapshotted_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    

        from "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m13:24:24.238043 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.227 seconds
[0m13:24:24.254105 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:24:24.254105 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m13:24:24.371975 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.117 seconds
[0m13:24:24.371975 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:24:24.383713 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:24:24.383713 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
BEGIN
[0m13:24:24.533301 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.149 seconds
[0m13:24:24.533301 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:24:24.533301 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
merge into "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS" as DBT_INTERNAL_DEST
    using "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("PROP_ID", "PROPERTY_TYPE", "CITY", "PRICE", "PRICE_PER_UNIT_AREA", "BEDROOM_NUM", "AGE", "TOTAL_FLOOR", "PRICE_SQFT", "CLEAN_CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("PROP_ID", "PROPERTY_TYPE", "CITY", "PRICE", "PRICE_PER_UNIT_AREA", "BEDROOM_NUM", "AGE", "TOTAL_FLOOR", "PRICE_SQFT", "CLEAN_CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m13:24:24.951110 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.411 seconds
[0m13:24:24.957985 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:24:24.960004 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
COMMIT
[0m13:24:25.110946 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m13:24:25.207896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c8ba653-2b4a-496f-a734-3a30fa745389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8DDE03A70>]}
[0m13:24:25.209721 [info ] [Thread-1 (]: 1 of 1 OK snapshotted LISTNGS.listings_snapshots ............................... [[32mSUCCESS 0[0m in 5.39s]
[0m13:24:25.209721 [debug] [Thread-1 (]: Finished running node snapshot.real_estate_project_dbt.listings_snapshots
[0m13:24:25.220192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:25.220192 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m13:24:25.221791 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m13:24:25.418605 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS' was left open.
[0m13:24:25.418605 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS: Close
[0m13:24:25.625836 [debug] [MainThread]: Connection 'snapshot.real_estate_project_dbt.listings_snapshots' was left open.
[0m13:24:25.627854 [debug] [MainThread]: On snapshot.real_estate_project_dbt.listings_snapshots: Close
[0m13:24:25.841355 [info ] [MainThread]: 
[0m13:24:25.844399 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 10.57 seconds (10.57s).
[0m13:24:25.851156 [debug] [MainThread]: Command end result
[0m13:24:25.948331 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m13:24:25.948331 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m13:24:25.956528 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m13:24:25.956528 [info ] [MainThread]: 
[0m13:24:25.962181 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:24:25.963206 [info ] [MainThread]: 
[0m13:24:25.964489 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:24:25.964489 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:24:25.964489 after 13.97 seconds
[0m13:24:25.967227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8DE700200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8EE33D820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8EE262FC0>]}
[0m13:24:25.967227 [debug] [MainThread]: Flushing usage events
[0m13:24:27.308325 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:34.716133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295972E4500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295970EE270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295970EEC00>]}


============================== 13:36:34.729542 | 62a165ec-8394-46cf-8e15-04f40ee551d7 ==============================
[0m13:36:34.729542 [info ] [MainThread]: Running with dbt=1.10.1
[0m13:36:34.732675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m13:36:36.677824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62a165ec-8394-46cf-8e15-04f40ee551d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295A6E6FC20>]}
[0m13:36:36.836457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62a165ec-8394-46cf-8e15-04f40ee551d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295A836E6F0>]}
[0m13:36:36.836457 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m13:36:37.392687 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m13:36:37.598295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:36:37.598295 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:36:37.645393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62a165ec-8394-46cf-8e15-04f40ee551d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295A9C36DE0>]}
[0m13:36:37.772291 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m13:36:37.772291 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m13:36:37.832372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62a165ec-8394-46cf-8e15-04f40ee551d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295A96EDE50>]}
[0m13:36:37.835028 [info ] [MainThread]: Found 6 models, 1 snapshot, 476 macros
[0m13:36:37.838617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62a165ec-8394-46cf-8e15-04f40ee551d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295A9851CD0>]}
[0m13:36:37.839733 [info ] [MainThread]: 
[0m13:36:37.839733 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:36:37.848771 [info ] [MainThread]: 
[0m13:36:37.848771 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:36:37.854374 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m13:36:38.056876 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m13:36:38.056876 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m13:36:38.056876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:39.990493 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.924 seconds
[0m13:36:40.006557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS'
[0m13:36:40.054104 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m13:36:40.054104 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:36:40.054104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:41.261552 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.202 seconds
[0m13:36:41.264149 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m13:36:41.264149 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m13:36:41.440647 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.163 seconds
[0m13:36:41.440647 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m13:36:41.440647 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:36:41.574471 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.126 seconds
[0m13:36:41.574471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS, now list_REAL_ESTATE_LISTINGS_LISTINGS)
[0m13:36:41.589123 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m13:36:41.589123 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:36:41.719846 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.129 seconds
[0m13:36:41.734083 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m13:36:41.734083 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m13:36:41.916037 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.175 seconds
[0m13:36:41.916037 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m13:36:41.916037 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:36:42.057447 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.144 seconds
[0m13:36:42.075577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTNGS)
[0m13:36:42.089605 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m13:36:42.091620 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:36:42.231265 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.139 seconds
[0m13:36:42.237341 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m13:36:42.239357 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
show objects in REAL_ESTATE.LISTNGS
    limit 10000
    
;
[0m13:36:42.392596 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.157 seconds
[0m13:36:42.392596 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m13:36:42.392596 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:36:42.525474 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.123 seconds
[0m13:36:42.535906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62a165ec-8394-46cf-8e15-04f40ee551d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295A9877080>]}
[0m13:36:42.535906 [debug] [Thread-1 (]: Began running node snapshot.real_estate_project_dbt.listings_snapshots
[0m13:36:42.552078 [info ] [Thread-1 (]: 1 of 1 START snapshot LISTNGS.listings_snapshots ............................... [RUN]
[0m13:36:42.554096 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.real_estate_project_dbt.listings_snapshots'
[0m13:36:42.554096 [debug] [Thread-1 (]: Began compiling node snapshot.real_estate_project_dbt.listings_snapshots
[0m13:36:42.584398 [debug] [Thread-1 (]: Began executing node snapshot.real_estate_project_dbt.listings_snapshots
[0m13:36:42.704642 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:36:42.704642 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        select PRICE from (
                



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m13:36:42.704642 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:36:43.931093 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.218 seconds
[0m13:36:43.959873 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:36:43.972981 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m13:36:44.106237 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.133 seconds
[0m13:36:44.137913 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:36:44.137913 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m13:36:44.270769 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.129 seconds
[0m13:36:44.405678 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:36:44.405678 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
create or replace temporary table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED


    ),

    snapshotted_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    

        from "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m13:36:45.928700 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.521 seconds
[0m13:36:45.943355 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:36:45.943355 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m13:36:46.094574 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.162 seconds
[0m13:36:46.110522 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:36:46.126628 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m13:36:46.255620 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.133 seconds
[0m13:36:46.271768 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:36:46.271768 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m13:36:46.414164 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.146 seconds
[0m13:36:46.426309 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:36:46.426309 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m13:36:46.550517 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.111 seconds
[0m13:36:46.570430 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:36:46.570430 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m13:36:46.732236 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.165 seconds
[0m13:36:46.813006 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:36:46.813006 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED


    ),

    snapshotted_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    

        from "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m13:36:47.275274 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.452 seconds
[0m13:36:47.289137 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:36:47.291153 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m13:36:47.414832 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.122 seconds
[0m13:36:47.414832 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:36:47.424278 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:36:47.424278 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
BEGIN
[0m13:36:47.566144 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m13:36:47.567543 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:36:47.568972 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
merge into "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS" as DBT_INTERNAL_DEST
    using "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("PROP_ID", "PROPERTY_TYPE", "CITY", "PRICE", "PRICE_PER_UNIT_AREA", "BEDROOM_NUM", "AGE", "TOTAL_FLOOR", "PRICE_SQFT", "CLEAN_CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("PROP_ID", "PROPERTY_TYPE", "CITY", "PRICE", "PRICE_PER_UNIT_AREA", "BEDROOM_NUM", "AGE", "TOTAL_FLOOR", "PRICE_SQFT", "CLEAN_CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m13:36:48.488977 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 0.920 seconds
[0m13:36:48.488977 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m13:36:48.488977 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
COMMIT
[0m13:36:48.800477 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.303 seconds
[0m13:36:48.897576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a165ec-8394-46cf-8e15-04f40ee551d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295968EB8C0>]}
[0m13:36:48.901507 [info ] [Thread-1 (]: 1 of 1 OK snapshotted LISTNGS.listings_snapshots ............................... [[32mSUCCESS 2[0m in 6.33s]
[0m13:36:48.903991 [debug] [Thread-1 (]: Finished running node snapshot.real_estate_project_dbt.listings_snapshots
[0m13:36:48.909518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:48.909518 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m13:36:48.911326 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m13:36:49.129091 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTNGS' was left open.
[0m13:36:49.129091 [debug] [MainThread]: On list_REAL_ESTATE_LISTNGS: Close
[0m13:36:49.351958 [debug] [MainThread]: Connection 'snapshot.real_estate_project_dbt.listings_snapshots' was left open.
[0m13:36:49.351958 [debug] [MainThread]: On snapshot.real_estate_project_dbt.listings_snapshots: Close
[0m13:36:49.579375 [info ] [MainThread]: 
[0m13:36:49.587464 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 11.73 seconds (11.73s).
[0m13:36:49.590698 [debug] [MainThread]: Command end result
[0m13:36:49.690643 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m13:36:49.698975 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m13:36:49.723316 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m13:36:49.723316 [info ] [MainThread]: 
[0m13:36:49.723316 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:36:49.723316 [info ] [MainThread]: 
[0m13:36:49.739343 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:36:49.743404 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:36:49.743404 after 15.40 seconds
[0m13:36:49.745948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029596EA9C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295A81EEC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029590DA3350>]}
[0m13:36:49.745948 [debug] [MainThread]: Flushing usage events
[0m13:36:51.249901 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:38.719430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D12D92B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D0F1EF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D0AE1FA0>]}


============================== 15:19:38.719430 | c3f1faa1-097d-428a-87f2-9696415cf790 ==============================
[0m15:19:38.719430 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:19:38.719430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:19:42.091588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3f1faa1-097d-428a-87f2-9696415cf790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205E28071A0>]}
[0m15:19:42.198135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3f1faa1-097d-428a-87f2-9696415cf790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205E2687230>]}
[0m15:19:42.198135 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:19:42.810752 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:19:43.447648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:19:43.447648 [debug] [MainThread]: Partial parsing: added file: real_estate_project_dbt://models\example\Attribute_change_history.sql
[0m15:19:43.447648 [debug] [MainThread]: Partial parsing: added file: real_estate_project_dbt://snapshots\property_attribute_snapshot.sql
[0m15:19:44.173377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3f1faa1-097d-428a-87f2-9696415cf790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205E3E19910>]}
[0m15:19:44.277844 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m15:19:44.285501 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m15:19:44.322777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3f1faa1-097d-428a-87f2-9696415cf790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205E3BD1940>]}
[0m15:19:44.323777 [info ] [MainThread]: Found 7 models, 2 snapshots, 476 macros
[0m15:19:44.323777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f1faa1-097d-428a-87f2-9696415cf790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205E3BA4050>]}
[0m15:19:44.325813 [info ] [MainThread]: 
[0m15:19:44.326812 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:19:44.327777 [info ] [MainThread]: 
[0m15:19:44.327777 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:19:44.331777 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m15:19:45.619431 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m15:19:45.619431 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m15:19:45.619431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:47.228282 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.604 seconds
[0m15:19:47.228282 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m15:19:47.228282 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m15:19:47.422271 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.188 seconds
[0m15:19:47.422271 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTNGS'
[0m15:19:47.444217 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m15:19:47.444217 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:19:47.444217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:48.403396 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.962 seconds
[0m15:19:48.403396 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m15:19:48.403396 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
show objects in REAL_ESTATE.LISTNGS
    limit 10000
    
;
[0m15:19:48.570951 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.161 seconds
[0m15:19:48.570951 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m15:19:48.570951 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:19:48.679718 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.114 seconds
[0m15:19:48.695456 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTNGS, now list_REAL_ESTATE_LISTINGS_LISTINGS)
[0m15:19:48.695456 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m15:19:48.695456 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:19:48.848574 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.140 seconds
[0m15:19:48.857078 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m15:19:48.857078 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m15:19:49.018421 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.165 seconds
[0m15:19:49.018421 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m15:19:49.018421 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:19:49.150963 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.124 seconds
[0m15:19:49.150963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTINGS)
[0m15:19:49.165526 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m15:19:49.179388 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:19:49.300218 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.123 seconds
[0m15:19:49.308696 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m15:19:49.308696 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m15:19:49.460658 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.151 seconds
[0m15:19:49.460658 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m15:19:49.460658 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:19:49.583603 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m15:19:49.599043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f1faa1-097d-428a-87f2-9696415cf790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205E283B680>]}
[0m15:19:49.605053 [debug] [Thread-1 (]: Began running node snapshot.real_estate_project_dbt.listings_snapshots
[0m15:19:49.605053 [info ] [Thread-1 (]: 1 of 2 START snapshot LISTNGS.listings_snapshots ............................... [RUN]
[0m15:19:49.606077 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.real_estate_project_dbt.listings_snapshots'
[0m15:19:49.607051 [debug] [Thread-1 (]: Began compiling node snapshot.real_estate_project_dbt.listings_snapshots
[0m15:19:49.614053 [debug] [Thread-1 (]: Began executing node snapshot.real_estate_project_dbt.listings_snapshots
[0m15:19:49.677057 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:19:49.678058 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        select PRICE from (
                



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m15:19:49.678058 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:19:50.631622 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.964 seconds
[0m15:19:50.653354 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:19:50.655354 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m15:19:50.780344 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.136 seconds
[0m15:19:50.796363 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:19:50.796363 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m15:19:50.918788 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.114 seconds
[0m15:19:50.991809 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:19:50.991809 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
create or replace temporary table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED


    ),

    snapshotted_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    

        from "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m15:19:53.642847 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.657 seconds
[0m15:19:53.658685 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:19:53.658685 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m15:19:53.787994 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.124 seconds
[0m15:19:53.787994 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:19:53.787994 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m15:19:53.900416 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.114 seconds
[0m15:19:53.916389 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:19:53.916389 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m15:19:54.029240 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.112 seconds
[0m15:19:54.044972 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:19:54.044972 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m15:19:54.160374 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.112 seconds
[0m15:19:54.176471 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:19:54.176471 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m15:19:54.289035 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.107 seconds
[0m15:19:54.336615 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:19:54.336615 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED


    ),

    snapshotted_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    

        from "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m15:19:54.693807 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.355 seconds
[0m15:19:54.693807 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:19:54.693807 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:19:54.807478 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.105 seconds
[0m15:19:54.807478 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:19:54.807478 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:19:54.807478 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
BEGIN
[0m15:19:54.934116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m15:19:54.934116 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:19:54.934116 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
merge into "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS" as DBT_INTERNAL_DEST
    using "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("PROP_ID", "PROPERTY_TYPE", "CITY", "PRICE", "PRICE_PER_UNIT_AREA", "BEDROOM_NUM", "AGE", "TOTAL_FLOOR", "PRICE_SQFT", "CLEAN_CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("PROP_ID", "PROPERTY_TYPE", "CITY", "PRICE", "PRICE_PER_UNIT_AREA", "BEDROOM_NUM", "AGE", "TOTAL_FLOOR", "PRICE_SQFT", "CLEAN_CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m15:19:55.452026 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.524 seconds
[0m15:19:55.452026 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:19:55.467300 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
COMMIT
[0m15:19:55.668457 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.201 seconds
[0m15:19:55.709083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f1faa1-097d-428a-87f2-9696415cf790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205E444A180>]}
[0m15:19:55.709083 [info ] [Thread-1 (]: 1 of 2 OK snapshotted LISTNGS.listings_snapshots ............................... [[32mSUCCESS 0[0m in 6.10s]
[0m15:19:55.709083 [debug] [Thread-1 (]: Finished running node snapshot.real_estate_project_dbt.listings_snapshots
[0m15:19:55.709083 [debug] [Thread-1 (]: Began running node snapshot.real_estate_project_dbt.property_attribute_snapshots
[0m15:19:55.709083 [info ] [Thread-1 (]: 2 of 2 START snapshot LISTINGS.property_attribute_snapshots .................... [RUN]
[0m15:19:55.709083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.real_estate_project_dbt.listings_snapshots, now snapshot.real_estate_project_dbt.property_attribute_snapshots)
[0m15:19:55.709083 [debug] [Thread-1 (]: Began compiling node snapshot.real_estate_project_dbt.property_attribute_snapshots
[0m15:19:55.722983 [debug] [Thread-1 (]: Began executing node snapshot.real_estate_project_dbt.property_attribute_snapshots
[0m15:19:55.736020 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:19:55.736020 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



SELECT *
FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m15:19:55.879585 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.135 seconds
[0m15:19:55.879585 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:19:55.879585 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:19:55.983516 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.115 seconds
[0m15:19:55.983516 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:19:55.999329 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:19:55.999329 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
create or replace transient table REAL_ESTATE.LISTINGS.property_attribute_snapshots
    

    
    as (
    

    select *,
        md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



SELECT *
FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED

    ) sbq



    )
;
[0m15:19:56.732569 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.733 seconds
[0m15:19:56.748658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f1faa1-097d-428a-87f2-9696415cf790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205E45E7FE0>]}
[0m15:19:56.748658 [info ] [Thread-1 (]: 2 of 2 OK snapshotted LISTINGS.property_attribute_snapshots .................... [[32mSUCCESS 1[0m in 1.04s]
[0m15:19:56.748658 [debug] [Thread-1 (]: Finished running node snapshot.real_estate_project_dbt.property_attribute_snapshots
[0m15:19:56.748658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:56.761216 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m15:19:56.761216 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m15:19:56.930393 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS' was left open.
[0m15:19:56.930393 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS: Close
[0m15:19:57.150080 [debug] [MainThread]: Connection 'snapshot.real_estate_project_dbt.property_attribute_snapshots' was left open.
[0m15:19:57.152102 [debug] [MainThread]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: Close
[0m15:19:57.357794 [info ] [MainThread]: 
[0m15:19:57.360192 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 13.03 seconds (13.03s).
[0m15:19:57.360192 [debug] [MainThread]: Command end result
[0m15:19:57.387562 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m15:19:57.387562 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m15:19:57.403127 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m15:19:57.403127 [info ] [MainThread]: 
[0m15:19:57.403127 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:19:57.405846 [info ] [MainThread]: 
[0m15:19:57.405846 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m15:19:57.405846 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:19:57.405846 after 18.92 seconds
[0m15:19:57.405846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205E3D57F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D0547770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D122D040>]}
[0m15:19:57.405846 [debug] [MainThread]: Flushing usage events
[0m15:19:58.685310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:20:11.750126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258FFE1E2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258FFEC3560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002588004ACF0>]}


============================== 15:20:11.750126 | 521a2cd7-92ba-486a-b99c-11223ef7ec54 ==============================
[0m15:20:11.750126 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:20:11.750126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:20:12.970783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '521a2cd7-92ba-486a-b99c-11223ef7ec54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258925E96D0>]}
[0m15:20:13.065868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '521a2cd7-92ba-486a-b99c-11223ef7ec54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025890455B20>]}
[0m15:20:13.065868 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:20:13.473070 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:20:13.646921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:20:13.646921 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:20:13.694268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '521a2cd7-92ba-486a-b99c-11223ef7ec54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025892616600>]}
[0m15:20:13.804587 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m15:20:13.820293 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m15:20:13.849536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '521a2cd7-92ba-486a-b99c-11223ef7ec54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025892A7F410>]}
[0m15:20:13.851972 [info ] [MainThread]: Found 7 models, 2 snapshots, 476 macros
[0m15:20:13.851972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '521a2cd7-92ba-486a-b99c-11223ef7ec54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258926D7740>]}
[0m15:20:13.851972 [info ] [MainThread]: 
[0m15:20:13.851972 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:13.851972 [info ] [MainThread]: 
[0m15:20:13.851972 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:20:13.860125 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m15:20:13.942854 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m15:20:13.942854 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m15:20:13.943852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:15.072224 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.132 seconds
[0m15:20:15.081704 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m15:20:15.081704 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m15:20:15.188229 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.113 seconds
[0m15:20:15.204862 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS'
[0m15:20:15.287833 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m15:20:15.287833 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:20:15.287833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:16.192007 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.894 seconds
[0m15:20:16.200037 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m15:20:16.202044 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m15:20:16.352427 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.149 seconds
[0m15:20:16.356446 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m15:20:16.358455 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:20:16.470891 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.112 seconds
[0m15:20:16.474910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS, now list_REAL_ESTATE_LISTINGS_LISTINGS)
[0m15:20:16.484965 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m15:20:16.486719 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:20:16.603904 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m15:20:16.607927 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m15:20:16.609937 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m15:20:16.750772 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.149 seconds
[0m15:20:16.750772 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m15:20:16.750772 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:20:16.894841 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.132 seconds
[0m15:20:16.898855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTNGS)
[0m15:20:16.908506 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m15:20:16.908506 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:20:17.019434 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.112 seconds
[0m15:20:17.019434 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m15:20:17.019434 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
show objects in REAL_ESTATE.LISTNGS
    limit 10000
    
;
[0m15:20:17.162081 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.136 seconds
[0m15:20:17.162081 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m15:20:17.162081 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:20:17.269334 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.114 seconds
[0m15:20:17.269334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '521a2cd7-92ba-486a-b99c-11223ef7ec54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002589295A540>]}
[0m15:20:17.285036 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.Attribute_change_history
[0m15:20:17.285036 [info ] [Thread-1 (]: 1 of 7 START sql view model LISTINGS.Attribute_change_history .................. [RUN]
[0m15:20:17.285036 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.Attribute_change_history'
[0m15:20:17.285036 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.Attribute_change_history
[0m15:20:17.285036 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.Attribute_change_history"
[0m15:20:17.285036 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.Attribute_change_history
[0m15:20:17.332012 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.Attribute_change_history"
[0m15:20:17.334015 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.Attribute_change_history"
[0m15:20:17.335015 [debug] [Thread-1 (]: On model.real_estate_project_dbt.Attribute_change_history: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.Attribute_change_history"} */
create or replace   view REAL_ESTATE.LISTINGS.Attribute_change_history
  
   as (
    SELECT
  PROP_ID,
  dbt_valid_from,
  dbt_valid_to,
  PRICE,
  AGE,
  PRICE_PER_UNIT_AREA,
  PRICE_SQFT,
  AREA,
  ROW_NUMBER() OVER (PARTITION BY PROP_ID ORDER BY dbt_valid_from) AS version_number
FROM REAL_ESTATE.LISTINGS.property_attribute_snapshots
  );
[0m15:20:17.335015 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:20:18.477731 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd380e-3201-ba29-000e-04720001e492
[0m15:20:18.493721 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 2
invalid identifier 'AREA'
[0m15:20:18.509402 [debug] [Thread-1 (]: Database Error in model Attribute_change_history (models\example\Attribute_change_history.sql)
  000904 (42000): SQL compilation error: error line 12 at position 2
  invalid identifier 'AREA'
  compiled code at target\run\real_estate_project_dbt\models\example\Attribute_change_history.sql
[0m15:20:18.509402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '521a2cd7-92ba-486a-b99c-11223ef7ec54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258FFE55580>]}
[0m15:20:18.509402 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model LISTINGS.Attribute_change_history ......... [[31mERROR[0m in 1.22s]
[0m15:20:18.509402 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.Attribute_change_history
[0m15:20:18.509402 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m15:20:18.509402 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.Attribute_change_history' to be skipped because of status 'error'.  Reason: Database Error in model Attribute_change_history (models\example\Attribute_change_history.sql)
  000904 (42000): SQL compilation error: error line 12 at position 2
  invalid identifier 'AREA'
  compiled code at target\run\real_estate_project_dbt\models\example\Attribute_change_history.sql.
[0m15:20:18.509402 [info ] [Thread-1 (]: 2 of 7 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m15:20:18.509402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.Attribute_change_history, now model.real_estate_project_dbt.city_avaerage_price)
[0m15:20:18.509402 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m15:20:18.509402 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m15:20:18.509402 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m15:20:18.527186 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m15:20:18.529319 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m15:20:18.529319 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m15:20:18.735465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.210 seconds
[0m15:20:18.770245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '521a2cd7-92ba-486a-b99c-11223ef7ec54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025892F704D0>]}
[0m15:20:18.771300 [info ] [Thread-1 (]: 2 of 7 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 0.26s]
[0m15:20:18.773481 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m15:20:18.774455 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_level_aggregates
[0m15:20:18.775537 [info ] [Thread-1 (]: 3 of 7 START sql table model LISTINGS_LISTINGS.city_level_aggregates ........... [RUN]
[0m15:20:18.776653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.city_level_aggregates)
[0m15:20:18.777211 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_level_aggregates
[0m15:20:18.780612 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_level_aggregates"
[0m15:20:18.782228 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_level_aggregates
[0m15:20:18.808749 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_level_aggregates"
[0m15:20:18.808749 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_level_aggregates"
[0m15:20:18.808749 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_level_aggregates: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_level_aggregates"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates
    

    
    as (


WITH city_levels AS (
    SELECT CLEAN_CITY_NAME AS CITY_NAME,
    COUNT(PROP_ID) AS TOTAL_LISTINGS,
    AVG(PRICE) AS AVG_PRICE,
    MAX(TOTAL_FLOOR) AS MAX_FLOOR,
    AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT * FROM city_levels
    )
;
[0m15:20:19.402725 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m15:20:19.402725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '521a2cd7-92ba-486a-b99c-11223ef7ec54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025892F77800>]}
[0m15:20:19.402725 [info ] [Thread-1 (]: 3 of 7 OK created sql table model LISTINGS_LISTINGS.city_level_aggregates ...... [[32mSUCCESS 1[0m in 0.63s]
[0m15:20:19.402725 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_level_aggregates
[0m15:20:19.402725 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.price_growth_from_snapshot
[0m15:20:19.417394 [info ] [Thread-1 (]: 4 of 7 START sql view model LISTINGS.price_growth_from_snapshot ................ [RUN]
[0m15:20:19.417394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_level_aggregates, now model.real_estate_project_dbt.price_growth_from_snapshot)
[0m15:20:19.421308 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.price_growth_from_snapshot
[0m15:20:19.428061 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.price_growth_from_snapshot"
[0m15:20:19.429776 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.price_growth_from_snapshot
[0m15:20:19.431823 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.price_growth_from_snapshot"
[0m15:20:19.431823 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.price_growth_from_snapshot"
[0m15:20:19.431823 [debug] [Thread-1 (]: On model.real_estate_project_dbt.price_growth_from_snapshot: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.price_growth_from_snapshot"} */
create or replace   view REAL_ESTATE.LISTINGS.price_growth_from_snapshot
  
   as (
    WITH prices AS(
    SELECT 
        PROP_ID,
        PRICE,
        dbt_valid_from,
        dbt_valid_to,
        ROW_NUMBER() OVER( PARTITION BY PROP_ID ORDER BY dbt_valid_from) AS version
    FROM REAL_ESTATE.LISTNGS.listings_snapshots
)

SELECT
   a.PROP_ID,
   a.dbt_valid_from AS CURRENT_DATE,
   a.PRICE AS CURRENT_PRICE,
   b.PRICE AS PERVIOUS_PRICE,
   ROUND((a.PRICE -b.PRICE) /NULLIF(b.PRICE, 0),4) AS PRICE_CHANGE_PERCENT
FROM prices a
LEFT JOIN prices B 
  ON a.PROP_ID = b.PROP_ID AND a.version = b.version + 1
  );
[0m15:20:19.643914 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.206 seconds
[0m15:20:19.654384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '521a2cd7-92ba-486a-b99c-11223ef7ec54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025892EF46E0>]}
[0m15:20:19.656401 [info ] [Thread-1 (]: 4 of 7 OK created sql view model LISTINGS.price_growth_from_snapshot ........... [[32mSUCCESS 1[0m in 0.24s]
[0m15:20:19.658412 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.price_growth_from_snapshot
[0m15:20:19.658412 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m15:20:19.658412 [info ] [Thread-1 (]: 5 of 7 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m15:20:19.658412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.price_growth_from_snapshot, now model.real_estate_project_dbt.property_distribution)
[0m15:20:19.658412 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m15:20:19.658412 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m15:20:19.658412 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m15:20:19.658412 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m15:20:19.673206 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m15:20:19.673607 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m15:20:20.385210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.711 seconds
[0m15:20:20.393344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '521a2cd7-92ba-486a-b99c-11223ef7ec54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025893101EB0>]}
[0m15:20:20.396346 [info ] [Thread-1 (]: 5 of 7 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 0.73s]
[0m15:20:20.399285 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m15:20:20.401349 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_type_price_comparison
[0m15:20:20.404294 [info ] [Thread-1 (]: 6 of 7 START sql table model LISTINGS_LISTINGS.property_type_price_comparison .. [RUN]
[0m15:20:20.407184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_type_price_comparison)
[0m15:20:20.408326 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_type_price_comparison
[0m15:20:20.410899 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m15:20:20.410899 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_type_price_comparison
[0m15:20:20.424898 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m15:20:20.425396 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_type_price_comparison"
[0m15:20:20.425396 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_type_price_comparison: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_type_price_comparison"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_type_price_comparison
    

    
    as (

-- Step 1: Get overall average price across all cities
WITH overall_avg_price_cte AS (
    SELECT AVG(PRICE) AS overall_avg_price
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

-- Step 2: City-level aggregates (do not use CASE here!)
city_level_aggregates_cte AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        COUNT(PROP_ID) AS TOTAL_LISTINGS,
        AVG(PRICE) AS AVG_PRICE,
        MAX(TOTAL_FLOOR) AS MAX_FLOOR,
        AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

-- Step 3: Add price category by comparing to overall average
SELECT
    city.*,
    CASE
        WHEN city.AVG_PRICE > overall.overall_avg_price * 1.2 THEN 'Overpriced'
        ELSE 'Fair'
    END AS PRICE_CATEGORY
FROM city_level_aggregates_cte city
CROSS JOIN overall_avg_price_cte overall
    )
;
[0m15:20:20.958216 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.530 seconds
[0m15:20:20.958216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '521a2cd7-92ba-486a-b99c-11223ef7ec54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025893112AB0>]}
[0m15:20:20.958216 [info ] [Thread-1 (]: 6 of 7 OK created sql table model LISTINGS_LISTINGS.property_type_price_comparison  [[32mSUCCESS 1[0m in 0.55s]
[0m15:20:20.958216 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_type_price_comparison
[0m15:20:20.958216 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m15:20:20.958216 [info ] [Thread-1 (]: 7 of 7 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m15:20:20.958216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_type_price_comparison, now model.real_estate_project_dbt.property_value_index)
[0m15:20:20.958216 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m15:20:20.958216 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m15:20:20.958216 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m15:20:20.972335 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m15:20:20.975496 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m15:20:20.975496 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
        PROP_ID,
        CLEAN_CITY_NAME,
        PRICE,
        AGE,
        TOTAL_FLOOR,
        BEDROOM_NUM,

        -- Score calculations
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,
        1 - PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

scored AS (
    SELECT
        *,
        ROUND(
            0.4 * PRICE_SCORE +
            0.2 * AGE_SCORE +
            0.2 * FLOOR_SCORE +
            0.2 * BEDROOM_SCORE, 4
        ) AS FINAL_VALUE_SCORE
    FROM ranked
),

-- ✅ Only call NTILE(10) once and reuse it
luxury_tagged AS (
    SELECT
        *,
        NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY FINAL_VALUE_SCORE DESC) AS decile
    FROM scored
)

SELECT
    *,
    CASE
        WHEN decile = 1 THEN TRUE
        ELSE FALSE
    END AS IS_LUXURY
FROM luxury_tagged
ORDER BY CLEAN_CITY_NAME, FINAL_VALUE_SCORE DESC
  );
[0m15:20:21.187934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.224 seconds
[0m15:20:21.203791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '521a2cd7-92ba-486a-b99c-11223ef7ec54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025892A7F980>]}
[0m15:20:21.203791 [info ] [Thread-1 (]: 7 of 7 OK created sql view model LISTINGS_LISTINGS.property_value_index ........ [[32mSUCCESS 1[0m in 0.25s]
[0m15:20:21.203791 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m15:20:21.219568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:21.222106 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m15:20:21.223184 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m15:20:21.409173 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTNGS' was left open.
[0m15:20:21.409173 [debug] [MainThread]: On list_REAL_ESTATE_LISTNGS: Close
[0m15:20:21.597802 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.property_value_index' was left open.
[0m15:20:21.599810 [debug] [MainThread]: On model.real_estate_project_dbt.property_value_index: Close
[0m15:20:21.785379 [info ] [MainThread]: 
[0m15:20:21.785379 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 7.93 seconds (7.93s).
[0m15:20:21.785379 [debug] [MainThread]: Command end result
[0m15:20:21.811061 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m15:20:21.811061 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m15:20:21.826557 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m15:20:21.826557 [info ] [MainThread]: 
[0m15:20:21.826557 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:20:21.826557 [info ] [MainThread]: 
[0m15:20:21.826557 [error] [MainThread]: [31mFailure in model Attribute_change_history (models\example\Attribute_change_history.sql)[0m
[0m15:20:21.826557 [error] [MainThread]:   Database Error in model Attribute_change_history (models\example\Attribute_change_history.sql)
  000904 (42000): SQL compilation error: error line 12 at position 2
  invalid identifier 'AREA'
  compiled code at target\run\real_estate_project_dbt\models\example\Attribute_change_history.sql
[0m15:20:21.826557 [info ] [MainThread]: 
[0m15:20:21.826557 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\Attribute_change_history.sql
[0m15:20:21.826557 [info ] [MainThread]: 
[0m15:20:21.826557 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m15:20:21.826557 [debug] [MainThread]: Command `dbt run` failed at 15:20:21.826557 after 10.23 seconds
[0m15:20:21.826557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025892F71AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258FECC6C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025892F70BF0>]}
[0m15:20:21.826557 [debug] [MainThread]: Flushing usage events
[0m15:20:23.264503 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:07.014388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D83A1860C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D83A8D3830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D83A8D0050>]}


============================== 15:24:07.022793 | 7a2fe52e-4bf3-4afe-898e-62c238bde507 ==============================
[0m15:24:07.022793 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:24:07.022793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:24:08.231278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a2fe52e-4bf3-4afe-898e-62c238bde507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D839133FB0>]}
[0m15:24:08.331584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a2fe52e-4bf3-4afe-898e-62c238bde507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D83AAF59A0>]}
[0m15:24:08.333495 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:24:08.719267 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:24:08.899572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:24:08.899572 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://snapshots\property_attribute_snapshot.sql
[0m15:24:09.278957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a2fe52e-4bf3-4afe-898e-62c238bde507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D84D08BE90>]}
[0m15:24:09.433326 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m15:24:09.433326 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m15:24:09.468981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a2fe52e-4bf3-4afe-898e-62c238bde507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D84CFEB770>]}
[0m15:24:09.468981 [info ] [MainThread]: Found 7 models, 2 snapshots, 476 macros
[0m15:24:09.468981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a2fe52e-4bf3-4afe-898e-62c238bde507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D84D05E240>]}
[0m15:24:09.468981 [info ] [MainThread]: 
[0m15:24:09.468981 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:24:09.468981 [info ] [MainThread]: 
[0m15:24:09.468981 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:24:09.468981 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m15:24:09.560089 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m15:24:09.561089 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m15:24:09.561089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:10.923921 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.362 seconds
[0m15:24:10.937495 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m15:24:10.938497 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m15:24:11.055854 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.117 seconds
[0m15:24:11.065916 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS'
[0m15:24:11.083800 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m15:24:11.083800 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:24:11.083800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:12.119111 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.034 seconds
[0m15:24:12.123124 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m15:24:12.123124 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m15:24:12.276315 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.152 seconds
[0m15:24:12.276315 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m15:24:12.276315 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:24:12.404811 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.123 seconds
[0m15:24:12.404811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS, now list_REAL_ESTATE_LISTNGS)
[0m15:24:12.404811 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m15:24:12.404811 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:24:12.530657 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m15:24:12.533955 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m15:24:12.533955 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
show objects in REAL_ESTATE.LISTNGS
    limit 10000
    
;
[0m15:24:12.666802 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.127 seconds
[0m15:24:12.666802 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m15:24:12.666802 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:24:12.796212 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.122 seconds
[0m15:24:12.796212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTNGS, now list_REAL_ESTATE_LISTINGS_LISTINGS)
[0m15:24:12.796212 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m15:24:12.796212 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:24:12.918229 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.114 seconds
[0m15:24:12.922262 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m15:24:12.922262 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m15:24:13.078699 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.156 seconds
[0m15:24:13.086768 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m15:24:13.088834 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:24:13.197266 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m15:24:13.200746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a2fe52e-4bf3-4afe-898e-62c238bde507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D84CD477A0>]}
[0m15:24:13.200746 [debug] [Thread-1 (]: Began running node snapshot.real_estate_project_dbt.listings_snapshots
[0m15:24:13.200746 [info ] [Thread-1 (]: 1 of 2 START snapshot LISTNGS.listings_snapshots ............................... [RUN]
[0m15:24:13.200746 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.real_estate_project_dbt.listings_snapshots'
[0m15:24:13.200746 [debug] [Thread-1 (]: Began compiling node snapshot.real_estate_project_dbt.listings_snapshots
[0m15:24:13.216566 [debug] [Thread-1 (]: Began executing node snapshot.real_estate_project_dbt.listings_snapshots
[0m15:24:13.280025 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:24:13.281027 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        select PRICE from (
                



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:13.281027 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:24:14.205781 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.935 seconds
[0m15:24:14.219124 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:24:14.219124 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m15:24:14.331844 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.109 seconds
[0m15:24:14.347607 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:24:14.348116 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m15:24:14.477873 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.135 seconds
[0m15:24:14.523402 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:24:14.523402 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
create or replace temporary table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED


    ),

    snapshotted_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    

        from "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m15:24:15.675985 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.147 seconds
[0m15:24:15.675985 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:24:15.675985 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m15:24:15.802825 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.117 seconds
[0m15:24:15.802825 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:24:15.802825 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m15:24:15.915923 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.111 seconds
[0m15:24:15.931962 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:24:15.931962 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m15:24:16.050178 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.107 seconds
[0m15:24:16.061435 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:24:16.061435 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
[0m15:24:16.222972 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.160 seconds
[0m15:24:16.222972 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:24:16.222972 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
describe table "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp"
[0m15:24:16.335963 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.107 seconds
[0m15:24:16.367717 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:24:16.367717 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT * FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED


    ),

    snapshotted_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    

        from "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:16.901209 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.521 seconds
[0m15:24:16.901209 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:24:16.901209 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:17.016600 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.112 seconds
[0m15:24:17.016600 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:24:17.016600 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:24:17.016600 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
BEGIN
[0m15:24:17.149503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m15:24:17.149503 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:24:17.149503 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
merge into "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS" as DBT_INTERNAL_DEST
    using "REAL_ESTATE"."LISTNGS"."LISTINGS_SNAPSHOTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("PROP_ID", "PROPERTY_TYPE", "CITY", "PRICE", "PRICE_PER_UNIT_AREA", "BEDROOM_NUM", "AGE", "TOTAL_FLOOR", "PRICE_SQFT", "CLEAN_CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("PROP_ID", "PROPERTY_TYPE", "CITY", "PRICE", "PRICE_PER_UNIT_AREA", "BEDROOM_NUM", "AGE", "TOTAL_FLOOR", "PRICE_SQFT", "CLEAN_CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m15:24:17.565604 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.419 seconds
[0m15:24:17.565604 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.listings_snapshots"
[0m15:24:17.565604 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.listings_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.listings_snapshots"} */
COMMIT
[0m15:24:17.807282 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m15:24:17.839005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a2fe52e-4bf3-4afe-898e-62c238bde507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D839B1BAA0>]}
[0m15:24:17.839005 [info ] [Thread-1 (]: 1 of 2 OK snapshotted LISTNGS.listings_snapshots ............................... [[32mSUCCESS 0[0m in 4.64s]
[0m15:24:17.839005 [debug] [Thread-1 (]: Finished running node snapshot.real_estate_project_dbt.listings_snapshots
[0m15:24:17.839005 [debug] [Thread-1 (]: Began running node snapshot.real_estate_project_dbt.property_attribute_snapshots
[0m15:24:17.839005 [info ] [Thread-1 (]: 2 of 2 START snapshot LISTINGS.property_attribute_snapshots .................... [RUN]
[0m15:24:17.839005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.real_estate_project_dbt.listings_snapshots, now snapshot.real_estate_project_dbt.property_attribute_snapshots)
[0m15:24:17.839005 [debug] [Thread-1 (]: Began compiling node snapshot.real_estate_project_dbt.property_attribute_snapshots
[0m15:24:17.839005 [debug] [Thread-1 (]: Began executing node snapshot.real_estate_project_dbt.property_attribute_snapshots
[0m15:24:17.839005 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:24:17.855040 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
select * from (
        select PRICE, AGE, PRICE_PER_UNIT_AREA, PRICE_SQFT from (
                



SELECT *
FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:17.982313 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.128 seconds
[0m15:24:17.986969 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:24:17.986969 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
describe table "REAL_ESTATE"."LISTINGS"."PROPERTY_ATTRIBUTE_SNAPSHOTS"
[0m15:24:18.114546 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.120 seconds
[0m15:24:18.124351 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:24:18.126475 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
describe table "REAL_ESTATE"."LISTINGS"."PROPERTY_ATTRIBUTE_SNAPSHOTS"
[0m15:24:18.227556 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.101 seconds
[0m15:24:18.237769 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:24:18.237769 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
create or replace temporary table "REAL_ESTATE"."LISTINGS"."PROPERTY_ATTRIBUTE_SNAPSHOTS__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



SELECT *
FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED


    ),

    snapshotted_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    

        from "REAL_ESTATE"."LISTINGS"."PROPERTY_ATTRIBUTE_SNAPSHOTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ) or snapshotted_data."AGE" != source_data."AGE"
        or
        (
            ((snapshotted_data."AGE" is null) and not (source_data."AGE" is null))
            or
            ((not snapshotted_data."AGE" is null) and (source_data."AGE" is null))
        ) or snapshotted_data."PRICE_PER_UNIT_AREA" != source_data."PRICE_PER_UNIT_AREA"
        or
        (
            ((snapshotted_data."PRICE_PER_UNIT_AREA" is null) and not (source_data."PRICE_PER_UNIT_AREA" is null))
            or
            ((not snapshotted_data."PRICE_PER_UNIT_AREA" is null) and (source_data."PRICE_PER_UNIT_AREA" is null))
        ) or snapshotted_data."PRICE_SQFT" != source_data."PRICE_SQFT"
        or
        (
            ((snapshotted_data."PRICE_SQFT" is null) and not (source_data."PRICE_SQFT" is null))
            or
            ((not snapshotted_data."PRICE_SQFT" is null) and (source_data."PRICE_SQFT" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ) or snapshotted_data."AGE" != source_data."AGE"
        or
        (
            ((snapshotted_data."AGE" is null) and not (source_data."AGE" is null))
            or
            ((not snapshotted_data."AGE" is null) and (source_data."AGE" is null))
        ) or snapshotted_data."PRICE_PER_UNIT_AREA" != source_data."PRICE_PER_UNIT_AREA"
        or
        (
            ((snapshotted_data."PRICE_PER_UNIT_AREA" is null) and not (source_data."PRICE_PER_UNIT_AREA" is null))
            or
            ((not snapshotted_data."PRICE_PER_UNIT_AREA" is null) and (source_data."PRICE_PER_UNIT_AREA" is null))
        ) or snapshotted_data."PRICE_SQFT" != source_data."PRICE_SQFT"
        or
        (
            ((snapshotted_data."PRICE_SQFT" is null) and not (source_data."PRICE_SQFT" is null))
            or
            ((not snapshotted_data."PRICE_SQFT" is null) and (source_data."PRICE_SQFT" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m15:24:19.474183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.238 seconds
[0m15:24:19.474183 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:24:19.474183 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
describe table "REAL_ESTATE"."LISTINGS"."PROPERTY_ATTRIBUTE_SNAPSHOTS__dbt_tmp"
[0m15:24:19.604423 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.128 seconds
[0m15:24:19.604423 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:24:19.604423 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
describe table "REAL_ESTATE"."LISTINGS"."PROPERTY_ATTRIBUTE_SNAPSHOTS"
[0m15:24:19.721680 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.105 seconds
[0m15:24:19.721680 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:24:19.721680 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
describe table "REAL_ESTATE"."LISTINGS"."PROPERTY_ATTRIBUTE_SNAPSHOTS__dbt_tmp"
[0m15:24:19.830981 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.108 seconds
[0m15:24:19.846890 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:24:19.846890 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
describe table "REAL_ESTATE"."LISTINGS"."PROPERTY_ATTRIBUTE_SNAPSHOTS"
[0m15:24:19.963272 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.109 seconds
[0m15:24:19.976738 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:24:19.976738 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
describe table "REAL_ESTATE"."LISTINGS"."PROPERTY_ATTRIBUTE_SNAPSHOTS__dbt_tmp"
[0m15:24:20.085921 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.111 seconds
[0m15:24:20.101742 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:24:20.101742 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
select * from (
        
    
    with snapshot_query as (

        



SELECT *
FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED


    ),

    snapshotted_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    

        from "REAL_ESTATE"."LISTINGS"."PROPERTY_ATTRIBUTE_SNAPSHOTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(PROP_ID as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        PROP_ID as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ) or snapshotted_data."AGE" != source_data."AGE"
        or
        (
            ((snapshotted_data."AGE" is null) and not (source_data."AGE" is null))
            or
            ((not snapshotted_data."AGE" is null) and (source_data."AGE" is null))
        ) or snapshotted_data."PRICE_PER_UNIT_AREA" != source_data."PRICE_PER_UNIT_AREA"
        or
        (
            ((snapshotted_data."PRICE_PER_UNIT_AREA" is null) and not (source_data."PRICE_PER_UNIT_AREA" is null))
            or
            ((not snapshotted_data."PRICE_PER_UNIT_AREA" is null) and (source_data."PRICE_PER_UNIT_AREA" is null))
        ) or snapshotted_data."PRICE_SQFT" != source_data."PRICE_SQFT"
        or
        (
            ((snapshotted_data."PRICE_SQFT" is null) and not (source_data."PRICE_SQFT" is null))
            or
            ((not snapshotted_data."PRICE_SQFT" is null) and (source_data."PRICE_SQFT" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."PRICE" != source_data."PRICE"
        or
        (
            ((snapshotted_data."PRICE" is null) and not (source_data."PRICE" is null))
            or
            ((not snapshotted_data."PRICE" is null) and (source_data."PRICE" is null))
        ) or snapshotted_data."AGE" != source_data."AGE"
        or
        (
            ((snapshotted_data."AGE" is null) and not (source_data."AGE" is null))
            or
            ((not snapshotted_data."AGE" is null) and (source_data."AGE" is null))
        ) or snapshotted_data."PRICE_PER_UNIT_AREA" != source_data."PRICE_PER_UNIT_AREA"
        or
        (
            ((snapshotted_data."PRICE_PER_UNIT_AREA" is null) and not (source_data."PRICE_PER_UNIT_AREA" is null))
            or
            ((not snapshotted_data."PRICE_PER_UNIT_AREA" is null) and (source_data."PRICE_PER_UNIT_AREA" is null))
        ) or snapshotted_data."PRICE_SQFT" != source_data."PRICE_SQFT"
        or
        (
            ((snapshotted_data."PRICE_SQFT" is null) and not (source_data."PRICE_SQFT" is null))
            or
            ((not snapshotted_data."PRICE_SQFT" is null) and (source_data."PRICE_SQFT" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:20.328755 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.218 seconds
[0m15:24:20.328755 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:24:20.328755 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
/* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:20.458439 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.122 seconds
[0m15:24:20.458439 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:24:20.458439 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:24:20.458439 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
BEGIN
[0m15:24:20.619458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m15:24:20.621480 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:24:20.621480 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
merge into "REAL_ESTATE"."LISTINGS"."PROPERTY_ATTRIBUTE_SNAPSHOTS" as DBT_INTERNAL_DEST
    using "REAL_ESTATE"."LISTINGS"."PROPERTY_ATTRIBUTE_SNAPSHOTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("PROP_ID", "PROPERTY_TYPE", "CITY", "PRICE", "PRICE_PER_UNIT_AREA", "BEDROOM_NUM", "AGE", "TOTAL_FLOOR", "PRICE_SQFT", "CLEAN_CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("PROP_ID", "PROPERTY_TYPE", "CITY", "PRICE", "PRICE_PER_UNIT_AREA", "BEDROOM_NUM", "AGE", "TOTAL_FLOOR", "PRICE_SQFT", "CLEAN_CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m15:24:20.878227 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.255 seconds
[0m15:24:20.878227 [debug] [Thread-1 (]: Using snowflake connection "snapshot.real_estate_project_dbt.property_attribute_snapshots"
[0m15:24:20.878227 [debug] [Thread-1 (]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "snapshot.real_estate_project_dbt.property_attribute_snapshots"} */
COMMIT
[0m15:24:21.022686 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m15:24:21.022686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a2fe52e-4bf3-4afe-898e-62c238bde507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D84D468050>]}
[0m15:24:21.038384 [info ] [Thread-1 (]: 2 of 2 OK snapshotted LISTINGS.property_attribute_snapshots .................... [[32mSUCCESS 0[0m in 3.18s]
[0m15:24:21.038384 [debug] [Thread-1 (]: Finished running node snapshot.real_estate_project_dbt.property_attribute_snapshots
[0m15:24:21.038384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:21.038384 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m15:24:21.038384 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m15:24:21.237181 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTINGS_LISTINGS' was left open.
[0m15:24:21.237181 [debug] [MainThread]: On list_REAL_ESTATE_LISTINGS_LISTINGS: Close
[0m15:24:21.451995 [debug] [MainThread]: Connection 'snapshot.real_estate_project_dbt.property_attribute_snapshots' was left open.
[0m15:24:21.454014 [debug] [MainThread]: On snapshot.real_estate_project_dbt.property_attribute_snapshots: Close
[0m15:24:21.653276 [info ] [MainThread]: 
[0m15:24:21.655291 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 12.18 seconds (12.18s).
[0m15:24:21.655291 [debug] [MainThread]: Command end result
[0m15:24:21.693646 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m15:24:21.693646 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m15:24:21.693646 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m15:24:21.693646 [info ] [MainThread]: 
[0m15:24:21.705257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:24:21.706094 [info ] [MainThread]: 
[0m15:24:21.706094 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m15:24:21.706094 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:24:21.706094 after 14.87 seconds
[0m15:24:21.706094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D849FB2E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D839B4C5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D839B4CF80>]}
[0m15:24:21.706094 [debug] [MainThread]: Flushing usage events
[0m15:24:22.804756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:28.241039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220E17C8C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220DEA7C5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220E163C4A0>]}


============================== 15:24:28.241039 | c5dfcb90-1076-4add-af4e-24344ce12e69 ==============================
[0m15:24:28.241039 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:24:28.251198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:24:29.540814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5dfcb90-1076-4add-af4e-24344ce12e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F27CF800>]}
[0m15:24:29.650689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5dfcb90-1076-4add-af4e-24344ce12e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F1D4F230>]}
[0m15:24:29.650689 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:24:30.074293 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:24:30.263228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:24:30.263228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:24:30.311129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5dfcb90-1076-4add-af4e-24344ce12e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F2AF56A0>]}
[0m15:24:30.437554 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m15:24:30.437554 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m15:24:30.468865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5dfcb90-1076-4add-af4e-24344ce12e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F428F1A0>]}
[0m15:24:30.468865 [info ] [MainThread]: Found 7 models, 2 snapshots, 476 macros
[0m15:24:30.468865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5dfcb90-1076-4add-af4e-24344ce12e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F4263E90>]}
[0m15:24:30.468865 [info ] [MainThread]: 
[0m15:24:30.468865 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:24:30.468865 [info ] [MainThread]: 
[0m15:24:30.468865 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:24:30.483531 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m15:24:30.564851 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m15:24:30.564851 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m15:24:30.565851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:31.707864 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.142 seconds
[0m15:24:31.713889 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m15:24:31.713889 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m15:24:31.827372 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.120 seconds
[0m15:24:31.843322 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m15:24:31.917880 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m15:24:31.917880 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:24:31.917880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:32.892211 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.971 seconds
[0m15:24:32.892211 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m15:24:32.892211 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m15:24:33.038300 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.142 seconds
[0m15:24:33.049500 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m15:24:33.051523 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:24:33.162281 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.116 seconds
[0m15:24:33.162281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTINGS)
[0m15:24:33.178386 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m15:24:33.178386 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:24:33.306819 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.123 seconds
[0m15:24:33.306819 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m15:24:33.306819 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m15:24:33.439013 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.122 seconds
[0m15:24:33.439013 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m15:24:33.439013 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:24:33.554883 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m15:24:33.554883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS, now list_REAL_ESTATE_LISTNGS)
[0m15:24:33.554883 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m15:24:33.554883 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:24:33.664882 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.107 seconds
[0m15:24:33.664882 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m15:24:33.680601 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
show objects in REAL_ESTATE.LISTNGS
    limit 10000
    
;
[0m15:24:33.811431 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.130 seconds
[0m15:24:33.817431 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m15:24:33.818430 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:24:33.929116 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.115 seconds
[0m15:24:33.940725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5dfcb90-1076-4add-af4e-24344ce12e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F41398E0>]}
[0m15:24:33.956880 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.Attribute_change_history
[0m15:24:33.956880 [info ] [Thread-1 (]: 1 of 7 START sql view model LISTINGS.Attribute_change_history .................. [RUN]
[0m15:24:33.956880 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.Attribute_change_history'
[0m15:24:33.956880 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.Attribute_change_history
[0m15:24:33.956880 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.Attribute_change_history"
[0m15:24:33.973584 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.Attribute_change_history
[0m15:24:33.992389 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.Attribute_change_history"
[0m15:24:33.992389 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.Attribute_change_history"
[0m15:24:33.992389 [debug] [Thread-1 (]: On model.real_estate_project_dbt.Attribute_change_history: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.Attribute_change_history"} */
create or replace   view REAL_ESTATE.LISTINGS.Attribute_change_history
  
   as (
    SELECT
  PROP_ID,
  dbt_valid_from,
  dbt_valid_to,
  PRICE,
  AGE,
  PRICE_PER_UNIT_AREA,
  PRICE_SQFT,
  AREA,
  ROW_NUMBER() OVER (PARTITION BY PROP_ID ORDER BY dbt_valid_from) AS version_number
FROM REAL_ESTATE.LISTINGS.property_attribute_snapshots
  );
[0m15:24:33.992389 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:24:34.891680 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd3812-3201-ba29-000e-04720001e61e
[0m15:24:34.891680 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 2
invalid identifier 'AREA'
[0m15:24:34.891680 [debug] [Thread-1 (]: Database Error in model Attribute_change_history (models\example\Attribute_change_history.sql)
  000904 (42000): SQL compilation error: error line 12 at position 2
  invalid identifier 'AREA'
  compiled code at target\run\real_estate_project_dbt\models\example\Attribute_change_history.sql
[0m15:24:34.891680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5dfcb90-1076-4add-af4e-24344ce12e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F3E26C30>]}
[0m15:24:34.906658 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model LISTINGS.Attribute_change_history ......... [[31mERROR[0m in 0.93s]
[0m15:24:34.906658 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.Attribute_change_history
[0m15:24:34.906658 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m15:24:34.906658 [debug] [Thread-4 (]: Marking all children of 'model.real_estate_project_dbt.Attribute_change_history' to be skipped because of status 'error'.  Reason: Database Error in model Attribute_change_history (models\example\Attribute_change_history.sql)
  000904 (42000): SQL compilation error: error line 12 at position 2
  invalid identifier 'AREA'
  compiled code at target\run\real_estate_project_dbt\models\example\Attribute_change_history.sql.
[0m15:24:34.906658 [info ] [Thread-1 (]: 2 of 7 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m15:24:34.906658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.Attribute_change_history, now model.real_estate_project_dbt.city_avaerage_price)
[0m15:24:34.906658 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m15:24:34.906658 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m15:24:34.906658 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m15:24:34.906658 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m15:24:34.906658 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m15:24:34.906658 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m15:24:35.107258 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m15:24:35.131839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5dfcb90-1076-4add-af4e-24344ce12e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F478B260>]}
[0m15:24:35.139091 [info ] [Thread-1 (]: 2 of 7 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 0.23s]
[0m15:24:35.139091 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m15:24:35.139091 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_level_aggregates
[0m15:24:35.139091 [info ] [Thread-1 (]: 3 of 7 START sql table model LISTINGS_LISTINGS.city_level_aggregates ........... [RUN]
[0m15:24:35.139091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.city_level_aggregates)
[0m15:24:35.139091 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_level_aggregates
[0m15:24:35.139091 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_level_aggregates"
[0m15:24:35.139091 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_level_aggregates
[0m15:24:35.160249 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_level_aggregates"
[0m15:24:35.160249 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_level_aggregates"
[0m15:24:35.160249 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_level_aggregates: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_level_aggregates"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates
    

    
    as (


WITH city_levels AS (
    SELECT CLEAN_CITY_NAME AS CITY_NAME,
    COUNT(PROP_ID) AS TOTAL_LISTINGS,
    AVG(PRICE) AS AVG_PRICE,
    MAX(TOTAL_FLOOR) AS MAX_FLOOR,
    AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT * FROM city_levels
    )
;
[0m15:24:35.750793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.582 seconds
[0m15:24:35.761256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5dfcb90-1076-4add-af4e-24344ce12e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F3EA3800>]}
[0m15:24:35.761256 [info ] [Thread-1 (]: 3 of 7 OK created sql table model LISTINGS_LISTINGS.city_level_aggregates ...... [[32mSUCCESS 1[0m in 0.62s]
[0m15:24:35.761256 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_level_aggregates
[0m15:24:35.761256 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.price_growth_from_snapshot
[0m15:24:35.777337 [info ] [Thread-1 (]: 4 of 7 START sql view model LISTINGS.price_growth_from_snapshot ................ [RUN]
[0m15:24:35.779368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_level_aggregates, now model.real_estate_project_dbt.price_growth_from_snapshot)
[0m15:24:35.780430 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.price_growth_from_snapshot
[0m15:24:35.785166 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.price_growth_from_snapshot"
[0m15:24:35.786526 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.price_growth_from_snapshot
[0m15:24:35.786526 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.price_growth_from_snapshot"
[0m15:24:35.792763 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.price_growth_from_snapshot"
[0m15:24:35.793775 [debug] [Thread-1 (]: On model.real_estate_project_dbt.price_growth_from_snapshot: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.price_growth_from_snapshot"} */
create or replace   view REAL_ESTATE.LISTINGS.price_growth_from_snapshot
  
   as (
    WITH prices AS(
    SELECT 
        PROP_ID,
        PRICE,
        dbt_valid_from,
        dbt_valid_to,
        ROW_NUMBER() OVER( PARTITION BY PROP_ID ORDER BY dbt_valid_from) AS version
    FROM REAL_ESTATE.LISTNGS.listings_snapshots
)

SELECT
   a.PROP_ID,
   a.dbt_valid_from AS CURRENT_DATE,
   a.PRICE AS CURRENT_PRICE,
   b.PRICE AS PERVIOUS_PRICE,
   ROUND((a.PRICE -b.PRICE) /NULLIF(b.PRICE, 0),4) AS PRICE_CHANGE_PERCENT
FROM prices a
LEFT JOIN prices B 
  ON a.PROP_ID = b.PROP_ID AND a.version = b.version + 1
  );
[0m15:24:36.058402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.273 seconds
[0m15:24:36.058402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5dfcb90-1076-4add-af4e-24344ce12e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F42B1FD0>]}
[0m15:24:36.058402 [info ] [Thread-1 (]: 4 of 7 OK created sql view model LISTINGS.price_growth_from_snapshot ........... [[32mSUCCESS 1[0m in 0.28s]
[0m15:24:36.058402 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.price_growth_from_snapshot
[0m15:24:36.058402 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m15:24:36.058402 [info ] [Thread-1 (]: 5 of 7 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m15:24:36.074872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.price_growth_from_snapshot, now model.real_estate_project_dbt.property_distribution)
[0m15:24:36.074872 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m15:24:36.074872 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m15:24:36.074872 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m15:24:36.074872 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m15:24:36.074872 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m15:24:36.074872 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m15:24:36.806592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.723 seconds
[0m15:24:36.817723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5dfcb90-1076-4add-af4e-24344ce12e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F490DB20>]}
[0m15:24:36.819745 [info ] [Thread-1 (]: 5 of 7 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 0.74s]
[0m15:24:36.821765 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m15:24:36.821765 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_type_price_comparison
[0m15:24:36.821765 [info ] [Thread-1 (]: 6 of 7 START sql table model LISTINGS_LISTINGS.property_type_price_comparison .. [RUN]
[0m15:24:36.821765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_type_price_comparison)
[0m15:24:36.821765 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_type_price_comparison
[0m15:24:36.830395 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m15:24:36.831439 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_type_price_comparison
[0m15:24:36.832878 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m15:24:36.832878 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_type_price_comparison"
[0m15:24:36.832878 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_type_price_comparison: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_type_price_comparison"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_type_price_comparison
    

    
    as (

-- Step 1: Get overall average price across all cities
WITH overall_avg_price_cte AS (
    SELECT AVG(PRICE) AS overall_avg_price
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

-- Step 2: City-level aggregates (do not use CASE here!)
city_level_aggregates_cte AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        COUNT(PROP_ID) AS TOTAL_LISTINGS,
        AVG(PRICE) AS AVG_PRICE,
        MAX(TOTAL_FLOOR) AS MAX_FLOOR,
        AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

-- Step 3: Add price category by comparing to overall average
SELECT
    city.*,
    CASE
        WHEN city.AVG_PRICE > overall.overall_avg_price * 1.2 THEN 'Overpriced'
        ELSE 'Fair'
    END AS PRICE_CATEGORY
FROM city_level_aggregates_cte city
CROSS JOIN overall_avg_price_cte overall
    )
;
[0m15:24:37.397127 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.564 seconds
[0m15:24:37.397127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5dfcb90-1076-4add-af4e-24344ce12e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F491E240>]}
[0m15:24:37.397127 [info ] [Thread-1 (]: 6 of 7 OK created sql table model LISTINGS_LISTINGS.property_type_price_comparison  [[32mSUCCESS 1[0m in 0.58s]
[0m15:24:37.397127 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_type_price_comparison
[0m15:24:37.397127 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m15:24:37.397127 [info ] [Thread-1 (]: 7 of 7 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m15:24:37.397127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_type_price_comparison, now model.real_estate_project_dbt.property_value_index)
[0m15:24:37.397127 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m15:24:37.413190 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m15:24:37.413190 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m15:24:37.413190 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m15:24:37.413190 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m15:24:37.413190 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
        PROP_ID,
        CLEAN_CITY_NAME,
        PRICE,
        AGE,
        TOTAL_FLOOR,
        BEDROOM_NUM,

        -- Score calculations
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,
        1 - PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

scored AS (
    SELECT
        *,
        ROUND(
            0.4 * PRICE_SCORE +
            0.2 * AGE_SCORE +
            0.2 * FLOOR_SCORE +
            0.2 * BEDROOM_SCORE, 4
        ) AS FINAL_VALUE_SCORE
    FROM ranked
),

-- ✅ Only call NTILE(10) once and reuse it
luxury_tagged AS (
    SELECT
        *,
        NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY FINAL_VALUE_SCORE DESC) AS decile
    FROM scored
)

SELECT
    *,
    CASE
        WHEN decile = 1 THEN TRUE
        ELSE FALSE
    END AS IS_LUXURY
FROM luxury_tagged
ORDER BY CLEAN_CITY_NAME, FINAL_VALUE_SCORE DESC
  );
[0m15:24:37.675818 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.256 seconds
[0m15:24:37.675818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5dfcb90-1076-4add-af4e-24344ce12e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F491F950>]}
[0m15:24:37.675818 [info ] [Thread-1 (]: 7 of 7 OK created sql view model LISTINGS_LISTINGS.property_value_index ........ [[32mSUCCESS 1[0m in 0.28s]
[0m15:24:37.675818 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m15:24:37.675818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:37.675818 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m15:24:37.675818 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m15:24:37.868202 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTNGS' was left open.
[0m15:24:37.868202 [debug] [MainThread]: On list_REAL_ESTATE_LISTNGS: Close
[0m15:24:38.041995 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.property_value_index' was left open.
[0m15:24:38.048057 [debug] [MainThread]: On model.real_estate_project_dbt.property_value_index: Close
[0m15:24:38.216098 [info ] [MainThread]: 
[0m15:24:38.231744 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m15:24:38.233753 [debug] [MainThread]: Command end result
[0m15:24:38.270930 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m15:24:38.274943 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m15:24:38.284821 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m15:24:38.284821 [info ] [MainThread]: 
[0m15:24:38.284821 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:24:38.286828 [info ] [MainThread]: 
[0m15:24:38.286828 [error] [MainThread]: [31mFailure in model Attribute_change_history (models\example\Attribute_change_history.sql)[0m
[0m15:24:38.286828 [error] [MainThread]:   Database Error in model Attribute_change_history (models\example\Attribute_change_history.sql)
  000904 (42000): SQL compilation error: error line 12 at position 2
  invalid identifier 'AREA'
  compiled code at target\run\real_estate_project_dbt\models\example\Attribute_change_history.sql
[0m15:24:38.286828 [info ] [MainThread]: 
[0m15:24:38.286828 [info ] [MainThread]:   compiled code at target\compiled\real_estate_project_dbt\models\example\Attribute_change_history.sql
[0m15:24:38.286828 [info ] [MainThread]: 
[0m15:24:38.286828 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m15:24:38.293986 [debug] [MainThread]: Command `dbt run` failed at 15:24:38.293986 after 10.21 seconds
[0m15:24:38.294979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220DED40080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220E12ABA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220E12A9C70>]}
[0m15:24:38.295981 [debug] [MainThread]: Flushing usage events
[0m15:24:39.701326 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:59.264507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B362BA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B6404500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B64047D0>]}


============================== 15:24:59.264507 | 85d1a43b-99d1-4b62-9bb6-b596cbee89ab ==============================
[0m15:24:59.264507 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:24:59.264507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\nikhi\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:25:00.472250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85d1a43b-99d1-4b62-9bb6-b596cbee89ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B69E5B50>]}
[0m15:25:00.567552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85d1a43b-99d1-4b62-9bb6-b596cbee89ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B5A3F620>]}
[0m15:25:00.567552 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:25:00.989597 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:25:01.195776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:25:01.195776 [debug] [MainThread]: Partial parsing: updated file: real_estate_project_dbt://models\example\Attribute_change_history.sql
[0m15:25:01.602012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85d1a43b-99d1-4b62-9bb6-b596cbee89ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C8F86C60>]}
[0m15:25:01.760722 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m15:25:01.760722 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m15:25:01.798785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85d1a43b-99d1-4b62-9bb6-b596cbee89ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C7105940>]}
[0m15:25:01.798785 [info ] [MainThread]: Found 7 models, 2 snapshots, 476 macros
[0m15:25:01.798785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85d1a43b-99d1-4b62-9bb6-b596cbee89ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B374AE10>]}
[0m15:25:01.798785 [info ] [MainThread]: 
[0m15:25:01.798785 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:01.798785 [info ] [MainThread]: 
[0m15:25:01.798785 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:25:01.811510 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE'
[0m15:25:01.891563 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m15:25:01.891563 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m15:25:01.892564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:03.062605 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.170 seconds
[0m15:25:03.068625 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE"
[0m15:25:03.070632 [debug] [ThreadPool]: On list_REAL_ESTATE: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE"} */
show terse schemas in database REAL_ESTATE
    limit 10000
[0m15:25:03.186971 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.116 seconds
[0m15:25:03.186971 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_REAL_ESTATE_LISTINGS_LISTINGS'
[0m15:25:03.222661 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m15:25:03.224667 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:25:03.224667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:04.178644 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.961 seconds
[0m15:25:04.178644 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m15:25:04.178644 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS_LISTINGS
    limit 10000
    
;
[0m15:25:04.344445 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.157 seconds
[0m15:25:04.356074 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS_LISTINGS"
[0m15:25:04.356074 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:25:04.468375 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.120 seconds
[0m15:25:04.468375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS_LISTINGS, now list_REAL_ESTATE_LISTINGS)
[0m15:25:04.484306 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m15:25:04.484306 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:25:04.597965 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.112 seconds
[0m15:25:04.597965 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m15:25:04.597965 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
show objects in REAL_ESTATE.LISTINGS
    limit 10000
    
;
[0m15:25:04.759451 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.156 seconds
[0m15:25:04.759451 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTINGS"
[0m15:25:04.759451 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTINGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTINGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:25:04.887157 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.114 seconds
[0m15:25:04.887157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_REAL_ESTATE_LISTINGS, now list_REAL_ESTATE_LISTNGS)
[0m15:25:04.893988 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m15:25:04.893988 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:25:05.031010 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.136 seconds
[0m15:25:05.031010 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m15:25:05.031010 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
show objects in REAL_ESTATE.LISTNGS
    limit 10000
    
;
[0m15:25:05.151146 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.123 seconds
[0m15:25:05.163846 [debug] [ThreadPool]: Using snowflake connection "list_REAL_ESTATE_LISTNGS"
[0m15:25:05.163846 [debug] [ThreadPool]: On list_REAL_ESTATE_LISTNGS: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "connection_name": "list_REAL_ESTATE_LISTNGS"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:25:05.292918 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.126 seconds
[0m15:25:05.292918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85d1a43b-99d1-4b62-9bb6-b596cbee89ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B365D3A0>]}
[0m15:25:05.308751 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.Attribute_change_history
[0m15:25:05.308751 [info ] [Thread-1 (]: 1 of 7 START sql view model LISTINGS.Attribute_change_history .................. [RUN]
[0m15:25:05.308751 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.real_estate_project_dbt.Attribute_change_history'
[0m15:25:05.308751 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.Attribute_change_history
[0m15:25:05.319244 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.Attribute_change_history"
[0m15:25:05.319244 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.Attribute_change_history
[0m15:25:05.350123 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.Attribute_change_history"
[0m15:25:05.352133 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.Attribute_change_history"
[0m15:25:05.353130 [debug] [Thread-1 (]: On model.real_estate_project_dbt.Attribute_change_history: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.Attribute_change_history"} */
create or replace   view REAL_ESTATE.LISTINGS.Attribute_change_history
  
   as (
    SELECT
  PROP_ID,
  dbt_valid_from,
  dbt_valid_to,
  PRICE,
  AGE,
  PRICE_PER_UNIT_AREA,
  PRICE_SQFT,
  ROW_NUMBER() OVER (PARTITION BY PROP_ID ORDER BY dbt_valid_from) AS version_number
FROM REAL_ESTATE.LISTINGS.property_attribute_snapshots
  );
[0m15:25:05.353130 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:25:06.311335 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.967 seconds
[0m15:25:06.327472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85d1a43b-99d1-4b62-9bb6-b596cbee89ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B5A03A10>]}
[0m15:25:06.343293 [info ] [Thread-1 (]: 1 of 7 OK created sql view model LISTINGS.Attribute_change_history ............. [[32mSUCCESS 1[0m in 1.02s]
[0m15:25:06.343293 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.Attribute_change_history
[0m15:25:06.343293 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_avaerage_price
[0m15:25:06.343293 [info ] [Thread-1 (]: 2 of 7 START sql view model LISTINGS_LISTINGS.city_avaerage_price .............. [RUN]
[0m15:25:06.343293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.Attribute_change_history, now model.real_estate_project_dbt.city_avaerage_price)
[0m15:25:06.343293 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_avaerage_price
[0m15:25:06.348026 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_avaerage_price"
[0m15:25:06.350031 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_avaerage_price
[0m15:25:06.352036 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_avaerage_price"
[0m15:25:06.354041 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_avaerage_price"
[0m15:25:06.354041 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_avaerage_price: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_avaerage_price"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price
  
   as (
    

WITH avg_price AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        PROPERTY_TYPE AS PROPERTY_TYPE,
        AVG(PRICE) AS TOTAL_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE
)

SELECT * FROM avg_price
  );
[0m15:25:06.536260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.190 seconds
[0m15:25:06.563808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85d1a43b-99d1-4b62-9bb6-b596cbee89ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C921FC50>]}
[0m15:25:06.563808 [info ] [Thread-1 (]: 2 of 7 OK created sql view model LISTINGS_LISTINGS.city_avaerage_price ......... [[32mSUCCESS 1[0m in 0.20s]
[0m15:25:06.563808 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_avaerage_price
[0m15:25:06.568600 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.city_level_aggregates
[0m15:25:06.568600 [info ] [Thread-1 (]: 3 of 7 START sql table model LISTINGS_LISTINGS.city_level_aggregates ........... [RUN]
[0m15:25:06.568600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_avaerage_price, now model.real_estate_project_dbt.city_level_aggregates)
[0m15:25:06.573172 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.city_level_aggregates
[0m15:25:06.577526 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.city_level_aggregates"
[0m15:25:06.578835 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.city_level_aggregates
[0m15:25:06.605089 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.city_level_aggregates"
[0m15:25:06.605089 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.city_level_aggregates"
[0m15:25:06.605089 [debug] [Thread-1 (]: On model.real_estate_project_dbt.city_level_aggregates: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.city_level_aggregates"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates
    

    
    as (


WITH city_levels AS (
    SELECT CLEAN_CITY_NAME AS CITY_NAME,
    COUNT(PROP_ID) AS TOTAL_LISTINGS,
    AVG(PRICE) AS AVG_PRICE,
    MAX(TOTAL_FLOOR) AS MAX_FLOOR,
    AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

SELECT * FROM city_levels
    )
;
[0m15:25:07.202356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m15:25:07.202356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85d1a43b-99d1-4b62-9bb6-b596cbee89ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C92C8CE0>]}
[0m15:25:07.202356 [info ] [Thread-1 (]: 3 of 7 OK created sql table model LISTINGS_LISTINGS.city_level_aggregates ...... [[32mSUCCESS 1[0m in 0.63s]
[0m15:25:07.202356 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.city_level_aggregates
[0m15:25:07.202356 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.price_growth_from_snapshot
[0m15:25:07.202356 [info ] [Thread-1 (]: 4 of 7 START sql view model LISTINGS.price_growth_from_snapshot ................ [RUN]
[0m15:25:07.202356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.city_level_aggregates, now model.real_estate_project_dbt.price_growth_from_snapshot)
[0m15:25:07.202356 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.price_growth_from_snapshot
[0m15:25:07.218068 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.price_growth_from_snapshot"
[0m15:25:07.218068 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.price_growth_from_snapshot
[0m15:25:07.218068 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.price_growth_from_snapshot"
[0m15:25:07.218068 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.price_growth_from_snapshot"
[0m15:25:07.218068 [debug] [Thread-1 (]: On model.real_estate_project_dbt.price_growth_from_snapshot: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.price_growth_from_snapshot"} */
create or replace   view REAL_ESTATE.LISTINGS.price_growth_from_snapshot
  
   as (
    WITH prices AS(
    SELECT 
        PROP_ID,
        PRICE,
        dbt_valid_from,
        dbt_valid_to,
        ROW_NUMBER() OVER( PARTITION BY PROP_ID ORDER BY dbt_valid_from) AS version
    FROM REAL_ESTATE.LISTNGS.listings_snapshots
)

SELECT
   a.PROP_ID,
   a.dbt_valid_from AS CURRENT_DATE,
   a.PRICE AS CURRENT_PRICE,
   b.PRICE AS PERVIOUS_PRICE,
   ROUND((a.PRICE -b.PRICE) /NULLIF(b.PRICE, 0),4) AS PRICE_CHANGE_PERCENT
FROM prices a
LEFT JOIN prices B 
  ON a.PROP_ID = b.PROP_ID AND a.version = b.version + 1
  );
[0m15:25:07.446762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m15:25:07.446762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85d1a43b-99d1-4b62-9bb6-b596cbee89ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C9221610>]}
[0m15:25:07.446762 [info ] [Thread-1 (]: 4 of 7 OK created sql view model LISTINGS.price_growth_from_snapshot ........... [[32mSUCCESS 1[0m in 0.24s]
[0m15:25:07.446762 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.price_growth_from_snapshot
[0m15:25:07.446762 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_distribution
[0m15:25:07.446762 [info ] [Thread-1 (]: 5 of 7 START sql table model LISTINGS_LISTINGS.property_distribution ........... [RUN]
[0m15:25:07.446762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.price_growth_from_snapshot, now model.real_estate_project_dbt.property_distribution)
[0m15:25:07.446762 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_distribution
[0m15:25:07.462562 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_distribution"
[0m15:25:07.462562 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_distribution
[0m15:25:07.462562 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_distribution"
[0m15:25:07.462562 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_distribution"
[0m15:25:07.462562 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_distribution: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_distribution"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_distribution
    

    
    as (

WITH city_percentiles AS (
    SELECT
        CLEAN_CITY_NAME,
        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
),

flagged_listings AS (
    SELECT
        l.*,
        c.P90_PRICE,
        CASE
            WHEN l.PRICE > c.P90_PRICE THEN TRUE
            ELSE FALSE
        END AS IS_LUXURY
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l
    JOIN city_percentiles AS c 
        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME
)

SELECT * FROM flagged_listings
    )
;
[0m15:25:08.237130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.766 seconds
[0m15:25:08.240105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85d1a43b-99d1-4b62-9bb6-b596cbee89ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C9415550>]}
[0m15:25:08.241104 [info ] [Thread-1 (]: 5 of 7 OK created sql table model LISTINGS_LISTINGS.property_distribution ...... [[32mSUCCESS 1[0m in 0.79s]
[0m15:25:08.241879 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_distribution
[0m15:25:08.242921 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_type_price_comparison
[0m15:25:08.242921 [info ] [Thread-1 (]: 6 of 7 START sql table model LISTINGS_LISTINGS.property_type_price_comparison .. [RUN]
[0m15:25:08.244071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_distribution, now model.real_estate_project_dbt.property_type_price_comparison)
[0m15:25:08.244071 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_type_price_comparison
[0m15:25:08.249115 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m15:25:08.249915 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_type_price_comparison
[0m15:25:08.252116 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_type_price_comparison"
[0m15:25:08.252116 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_type_price_comparison"
[0m15:25:08.252116 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_type_price_comparison: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_type_price_comparison"} */
create or replace transient table REAL_ESTATE.LISTINGS_LISTINGS.property_type_price_comparison
    

    
    as (

-- Step 1: Get overall average price across all cities
WITH overall_avg_price_cte AS (
    SELECT AVG(PRICE) AS overall_avg_price
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

-- Step 2: City-level aggregates (do not use CASE here!)
city_level_aggregates_cte AS (
    SELECT
        CLEAN_CITY_NAME AS CITY_NAME,
        COUNT(PROP_ID) AS TOTAL_LISTINGS,
        AVG(PRICE) AS AVG_PRICE,
        MAX(TOTAL_FLOOR) AS MAX_FLOOR,
        AVG(AGE) AS AVG_AGE
    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
    GROUP BY CLEAN_CITY_NAME
)

-- Step 3: Add price category by comparing to overall average
SELECT
    city.*,
    CASE
        WHEN city.AVG_PRICE > overall.overall_avg_price * 1.2 THEN 'Overpriced'
        ELSE 'Fair'
    END AS PRICE_CATEGORY
FROM city_level_aggregates_cte city
CROSS JOIN overall_avg_price_cte overall
    )
;
[0m15:25:08.980709 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.727 seconds
[0m15:25:08.980709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85d1a43b-99d1-4b62-9bb6-b596cbee89ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C93F4EC0>]}
[0m15:25:08.980709 [info ] [Thread-1 (]: 6 of 7 OK created sql table model LISTINGS_LISTINGS.property_type_price_comparison  [[32mSUCCESS 1[0m in 0.74s]
[0m15:25:08.980709 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_type_price_comparison
[0m15:25:08.980709 [debug] [Thread-1 (]: Began running node model.real_estate_project_dbt.property_value_index
[0m15:25:08.980709 [info ] [Thread-1 (]: 7 of 7 START sql view model LISTINGS_LISTINGS.property_value_index ............. [RUN]
[0m15:25:08.980709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate_project_dbt.property_type_price_comparison, now model.real_estate_project_dbt.property_value_index)
[0m15:25:08.980709 [debug] [Thread-1 (]: Began compiling node model.real_estate_project_dbt.property_value_index
[0m15:25:08.994728 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate_project_dbt.property_value_index"
[0m15:25:08.997133 [debug] [Thread-1 (]: Began executing node model.real_estate_project_dbt.property_value_index
[0m15:25:08.997133 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate_project_dbt.property_value_index"
[0m15:25:09.002258 [debug] [Thread-1 (]: Using snowflake connection "model.real_estate_project_dbt.property_value_index"
[0m15:25:09.002258 [debug] [Thread-1 (]: On model.real_estate_project_dbt.property_value_index: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "real_estate_project_dbt", "target_name": "dev", "node_id": "model.real_estate_project_dbt.property_value_index"} */
create or replace   view REAL_ESTATE.LISTINGS_LISTINGS.property_value_index
  
   as (
    

WITH ranked AS (
    SELECT
        PROP_ID,
        CLEAN_CITY_NAME,
        PRICE,
        AGE,
        TOTAL_FLOOR,
        BEDROOM_NUM,

        -- Score calculations
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,
        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,
        1 - PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE

    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED
),

scored AS (
    SELECT
        *,
        ROUND(
            0.4 * PRICE_SCORE +
            0.2 * AGE_SCORE +
            0.2 * FLOOR_SCORE +
            0.2 * BEDROOM_SCORE, 4
        ) AS FINAL_VALUE_SCORE
    FROM ranked
),

-- ✅ Only call NTILE(10) once and reuse it
luxury_tagged AS (
    SELECT
        *,
        NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY FINAL_VALUE_SCORE DESC) AS decile
    FROM scored
)

SELECT
    *,
    CASE
        WHEN decile = 1 THEN TRUE
        ELSE FALSE
    END AS IS_LUXURY
FROM luxury_tagged
ORDER BY CLEAN_CITY_NAME, FINAL_VALUE_SCORE DESC
  );
[0m15:25:09.289984 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.285 seconds
[0m15:25:09.292647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85d1a43b-99d1-4b62-9bb6-b596cbee89ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C93BDDC0>]}
[0m15:25:09.293634 [info ] [Thread-1 (]: 7 of 7 OK created sql view model LISTINGS_LISTINGS.property_value_index ........ [[32mSUCCESS 1[0m in 0.31s]
[0m15:25:09.294729 [debug] [Thread-1 (]: Finished running node model.real_estate_project_dbt.property_value_index
[0m15:25:09.296879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:09.297400 [debug] [MainThread]: Connection 'list_REAL_ESTATE' was left open.
[0m15:25:09.297400 [debug] [MainThread]: On list_REAL_ESTATE: Close
[0m15:25:09.485350 [debug] [MainThread]: Connection 'list_REAL_ESTATE_LISTNGS' was left open.
[0m15:25:09.485350 [debug] [MainThread]: On list_REAL_ESTATE_LISTNGS: Close
[0m15:25:09.662422 [debug] [MainThread]: Connection 'model.real_estate_project_dbt.property_value_index' was left open.
[0m15:25:09.676618 [debug] [MainThread]: On model.real_estate_project_dbt.property_value_index: Close
[0m15:25:09.867339 [info ] [MainThread]: 
[0m15:25:09.867339 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 8.07 seconds (8.07s).
[0m15:25:09.873928 [debug] [MainThread]: Command end result
[0m15:25:09.918990 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\manifest.json
[0m15:25:09.918990 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\semantic_manifest.json
[0m15:25:09.918990 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\nikhi\Desktop\real-estate-data-project\real_estate_project_dbt\target\run_results.json
[0m15:25:09.918990 [info ] [MainThread]: 
[0m15:25:09.918990 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:09.918990 [info ] [MainThread]: 
[0m15:25:09.918990 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m15:25:09.918990 [debug] [MainThread]: Command `dbt run` succeeded at 15:25:09.918990 after 10.82 seconds
[0m15:25:09.918990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C5F4E750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B694C6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B63C3530>]}
[0m15:25:09.918990 [debug] [MainThread]: Flushing usage events
[0m15:25:11.536078 [debug] [MainThread]: An error was encountered while trying to flush usage events
