{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.1", "generated_at": "2025-06-23T09:55:09.873928Z", "invocation_id": "85d1a43b-99d1-4b62-9bb6-b596cbee89ab", "invocation_started_at": "2025-06-23T09:54:59.190393Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T09:55:05.308751Z", "completed_at": "2025-06-23T09:55:05.319244Z"}, {"name": "execute", "started_at": "2025-06-23T09:55:05.319244Z", "completed_at": "2025-06-23T09:55:06.327472Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.018721103668213, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bd3813-3201-b7cb-000e-04720001f04a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.real_estate_project_dbt.Attribute_change_history", "compiled": true, "compiled_code": "SELECT\n  PROP_ID,\n  dbt_valid_from,\n  dbt_valid_to,\n  PRICE,\n  AGE,\n  PRICE_PER_UNIT_AREA,\n  PRICE_SQFT,\n  ROW_NUMBER() OVER (PARTITION BY PROP_ID ORDER BY dbt_valid_from) AS version_number\nFROM REAL_ESTATE.LISTINGS.property_attribute_snapshots", "relation_name": "REAL_ESTATE.LISTINGS.Attribute_change_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T09:55:06.343293Z", "completed_at": "2025-06-23T09:55:06.350031Z"}, {"name": "execute", "started_at": "2025-06-23T09:55:06.350031Z", "completed_at": "2025-06-23T09:55:06.547907Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.20461440086364746, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bd3813-3201-b7cb-000e-04720001f04e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.real_estate_project_dbt.city_avaerage_price", "compiled": true, "compiled_code": "\n\nWITH avg_price AS (\n    SELECT\n        CLEAN_CITY_NAME AS CITY_NAME,\n        PROPERTY_TYPE AS PROPERTY_TYPE,\n        AVG(PRICE) AS TOTAL_PRICE\n    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED\n    GROUP BY CLEAN_CITY_NAME,PROPERTY_TYPE\n)\n\nSELECT * FROM avg_price", "relation_name": "REAL_ESTATE.LISTINGS_LISTINGS.city_avaerage_price", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T09:55:06.573172Z", "completed_at": "2025-06-23T09:55:06.578835Z"}, {"name": "execute", "started_at": "2025-06-23T09:55:06.578835Z", "completed_at": "2025-06-23T09:55:07.202356Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.633756160736084, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bd3813-3201-ba29-000e-04720001e64a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.real_estate_project_dbt.city_level_aggregates", "compiled": true, "compiled_code": "\n\n\nWITH city_levels AS (\n    SELECT CLEAN_CITY_NAME AS CITY_NAME,\n    COUNT(PROP_ID) AS TOTAL_LISTINGS,\n    AVG(PRICE) AS AVG_PRICE,\n    MAX(TOTAL_FLOOR) AS MAX_FLOOR,\n    AVG(AGE) AS AVG_AGE\n    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED\n    GROUP BY CLEAN_CITY_NAME\n)\n\nSELECT * FROM city_levels", "relation_name": "REAL_ESTATE.LISTINGS_LISTINGS.city_level_aggregates", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T09:55:07.202356Z", "completed_at": "2025-06-23T09:55:07.218068Z"}, {"name": "execute", "started_at": "2025-06-23T09:55:07.218068Z", "completed_at": "2025-06-23T09:55:07.446762Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.24440622329711914, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bd3813-3201-ba29-000e-04720001e64e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.real_estate_project_dbt.price_growth_from_snapshot", "compiled": true, "compiled_code": "WITH prices AS(\n    SELECT \n        PROP_ID,\n        PRICE,\n        dbt_valid_from,\n        dbt_valid_to,\n        ROW_NUMBER() OVER( PARTITION BY PROP_ID ORDER BY dbt_valid_from) AS version\n    FROM REAL_ESTATE.LISTNGS.listings_snapshots\n)\n\nSELECT\n   a.PROP_ID,\n   a.dbt_valid_from AS CURRENT_DATE,\n   a.PRICE AS CURRENT_PRICE,\n   b.PRICE AS PERVIOUS_PRICE,\n   ROUND((a.PRICE -b.PRICE) /NULLIF(b.PRICE, 0),4) AS PRICE_CHANGE_PERCENT\nFROM prices a\nLEFT JOIN prices B \n  ON a.PROP_ID = b.PROP_ID AND a.version = b.version + 1", "relation_name": "REAL_ESTATE.LISTINGS.price_growth_from_snapshot", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T09:55:07.446762Z", "completed_at": "2025-06-23T09:55:07.462562Z"}, {"name": "execute", "started_at": "2025-06-23T09:55:07.462562Z", "completed_at": "2025-06-23T09:55:08.240105Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7933423519134521, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bd3813-3201-ba29-000e-04720001e652"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.real_estate_project_dbt.property_distribution", "compiled": true, "compiled_code": "\n\nWITH city_percentiles AS (\n    SELECT\n        CLEAN_CITY_NAME,\n        PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY PRICE) AS P90_PRICE\n    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED\n    GROUP BY CLEAN_CITY_NAME\n),\n\nflagged_listings AS (\n    SELECT\n        l.*,\n        c.P90_PRICE,\n        CASE\n            WHEN l.PRICE > c.P90_PRICE THEN TRUE\n            ELSE FALSE\n        END AS IS_LUXURY\n    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED AS l\n    JOIN city_percentiles AS c \n        ON l.CLEAN_CITY_NAME = c.CLEAN_CITY_NAME\n)\n\nSELECT * FROM flagged_listings", "relation_name": "REAL_ESTATE.LISTINGS_LISTINGS.property_distribution", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T09:55:08.245113Z", "completed_at": "2025-06-23T09:55:08.249915Z"}, {"name": "execute", "started_at": "2025-06-23T09:55:08.250906Z", "completed_at": "2025-06-23T09:55:08.980709Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7366378307342529, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bd3813-3201-b7cb-000e-04720001f052"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.real_estate_project_dbt.property_type_price_comparison", "compiled": true, "compiled_code": "\n\n-- Step 1: Get overall average price across all cities\nWITH overall_avg_price_cte AS (\n    SELECT AVG(PRICE) AS overall_avg_price\n    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED\n),\n\n-- Step 2: City-level aggregates (do not use CASE here!)\ncity_level_aggregates_cte AS (\n    SELECT\n        CLEAN_CITY_NAME AS CITY_NAME,\n        COUNT(PROP_ID) AS TOTAL_LISTINGS,\n        AVG(PRICE) AS AVG_PRICE,\n        MAX(TOTAL_FLOOR) AS MAX_FLOOR,\n        AVG(AGE) AS AVG_AGE\n    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED\n    GROUP BY CLEAN_CITY_NAME\n)\n\n-- Step 3: Add price category by comparing to overall average\nSELECT\n    city.*,\n    CASE\n        WHEN city.AVG_PRICE > overall.overall_avg_price * 1.2 THEN 'Overpriced'\n        ELSE 'Fair'\n    END AS PRICE_CATEGORY\nFROM city_level_aggregates_cte city\nCROSS JOIN overall_avg_price_cte overall", "relation_name": "REAL_ESTATE.LISTINGS_LISTINGS.property_type_price_comparison", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T09:55:08.980709Z", "completed_at": "2025-06-23T09:55:08.996510Z"}, {"name": "execute", "started_at": "2025-06-23T09:55:08.997133Z", "completed_at": "2025-06-23T09:55:09.292647Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3119380474090576, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bd3813-3201-ba29-000e-04720001e656"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.real_estate_project_dbt.property_value_index", "compiled": true, "compiled_code": "\n\nWITH ranked AS (\n    SELECT\n        PROP_ID,\n        CLEAN_CITY_NAME,\n        PRICE,\n        AGE,\n        TOTAL_FLOOR,\n        BEDROOM_NUM,\n\n        -- Score calculations\n        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY PRICE) AS PRICE_SCORE,\n        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY TOTAL_FLOOR) AS FLOOR_SCORE,\n        PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY BEDROOM_NUM) AS BEDROOM_SCORE,\n        1 - PERCENT_RANK() OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY AGE) AS AGE_SCORE\n\n    FROM REAL_ESTATE.LISTINGS.LISTINGS_CLEANED\n),\n\nscored AS (\n    SELECT\n        *,\n        ROUND(\n            0.4 * PRICE_SCORE +\n            0.2 * AGE_SCORE +\n            0.2 * FLOOR_SCORE +\n            0.2 * BEDROOM_SCORE, 4\n        ) AS FINAL_VALUE_SCORE\n    FROM ranked\n),\n\n-- \u2705 Only call NTILE(10) once and reuse it\nluxury_tagged AS (\n    SELECT\n        *,\n        NTILE(10) OVER (PARTITION BY CLEAN_CITY_NAME ORDER BY FINAL_VALUE_SCORE DESC) AS decile\n    FROM scored\n)\n\nSELECT\n    *,\n    CASE\n        WHEN decile = 1 THEN TRUE\n        ELSE FALSE\n    END AS IS_LUXURY\nFROM luxury_tagged\nORDER BY CLEAN_CITY_NAME, FINAL_VALUE_SCORE DESC", "relation_name": "REAL_ESTATE.LISTINGS_LISTINGS.property_value_index", "batch_results": null}], "elapsed_time": 8.068554401397705, "args": {"warn_error_options": {"error": [], "warn": [], "silence": []}, "require_yaml_configuration_for_mf_time_spines": false, "indirect_selection": "eager", "require_explicit_package_overrides_for_builtin_materializations": true, "defer": false, "validate_macro_args": false, "cache_selected_only": false, "send_anonymous_usage_stats": true, "use_colors": true, "favor_state": false, "project_dir": "C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt", "strict_mode": false, "quiet": false, "upload_to_artifacts_ingest_api": false, "state_modified_compare_vars": false, "require_batched_execution_for_custom_microbatch_strategy": false, "populate_cache": true, "printer_width": 80, "macro_debugging": false, "show_resource_report": false, "log_level_file": "debug", "version_check": true, "exclude": [], "partial_parse_file_diff": true, "introspect": true, "source_freshness_run_project_hooks": true, "require_all_warnings_handled_by_warn_error": false, "print": true, "log_format": "default", "require_resource_names_without_spaces": true, "static_parser": true, "select": [], "log_format_file": "debug", "log_level": "info", "partial_parse": true, "which": "run", "log_file_max_bytes": 10485760, "log_path": "C:\\Users\\nikhi\\Desktop\\real-estate-data-project\\real_estate_project_dbt\\logs", "skip_nodes_if_on_run_start_fails": false, "use_fast_test_edges": false, "show_all_deprecations": false, "invocation_command": "dbt run", "write_json": true, "empty": false, "state_modified_compare_more_unrendered_values": false, "require_nested_cumulative_type_params": false, "vars": {}, "profiles_dir": "C:\\Users\\nikhi\\.dbt", "use_colors_file": true}}